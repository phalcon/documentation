<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Phalcon Framework. A full-stack PHP framework delivered as a PHP extension, offering lower resource consumption and high performance."><meta name=author content="Phalcon Team"><link href=https://docs.phalcon.io/5.6/db-models/ rel=canonical><link href=../db-odm/ rel=prev><link href=../db-models-behaviors/ rel=next><link rel=icon href=../assets/images/favicon.ico><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.7"><title>Models - Phalcon Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.f2e4d321.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Titillium+Web:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Titillium Web";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../assets/css/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-JR4REKBKH3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-JR4REKBKH3",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-JR4REKBKH3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Fanart --><!--

Phalcon Framework

A full-stack PHP framework delivered as a PHP extension,
offering lower resource consumption and high performance.

<3 Phalcon Team

                         ..
                         ....
   %                  ,   ......
     %%%               ,,  .......
      %%%%%%           ,,,,.........
       %%%%%%%%&        ,,,,,.........,
    /    %%%%%%%%%%      ,,,,,,..........
      //  %%%%%%%%%%%%%    ,,,,,,..........
       //// %%%%%%%%%%%%%%%  ,,,,,,..........,
         ////%%%%%%%%%%%%%%%%%%,,,,,,...........
          ///////%%%%%%%%%%%%%%%%%%,,,,...........
            ////////%%%%%%%%%%%%%%%%%%/,,...........
          %%%%/////////(%%%%%%%%%%%%%%%%%%,..........
            %%%%%//////////%%%%%%%%%%%%%%%%%%........(
               %%%%///////////(%%%%%%%%%%%%%%%%.......(
                 %%%%%////////////%%%%%%%%%%%%%%%.....//
                ....%%%%%////////////#%%%%%%%%%%%%%....//
                   .......(%/////////////%%%%%%%%%%%%..  /
                      ...........///////********/%%%%%..
                     ,,,,.............,/***************.
                         ,,,,,.............************......,/(
                               ,,,,,,..........********.....//////////
                              ((((((((**((((((((((((((*.....///////////
                                  %*********.../(((((((..........///(/#/
                               **********..........#%%%           ..*%%%
                            *********(..........%%%                  %%%
                         *********/..........%%%                     %%
                   %    *******%%.........%%%%
                  %   ******%%%%...../.*((((((   %%%%
                     ****%%%%%%.....///* (((((((%%%%%
                    ***&%%%%%%.....////* ((((((((%%  %
                    *  &%%%%%#..../////*  (((     %
                       &%%%%%....//////*           %
                        %%%% ....//////***   %%%
                     (  %%%   ...*/////*****%%%%
                     (   %     ...  //(*****/%%
                      (  &      ..   // ***  %%
                                 .     /      %
--><!-- Fanart --></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#models class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Phalcon Documentation" class="md-header__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-white-105x40.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Phalcon Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Models </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../introduction/ class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../application/ class=md-tabs__link> Core </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../db-layer/ class=md-tabs__link> Database </a> </li> <li class=md-tabs__item> <a href=../assets/ class=md-tabs__link> Front End </a> </li> <li class=md-tabs__item> <a href=../acl/ class=md-tabs__link> Business Logic </a> </li> <li class=md-tabs__item> <a href=../cache/ class=md-tabs__link> Services </a> </li> <li class=md-tabs__item> <a href=../api/ class=md-tabs__link> API </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Phalcon Documentation" class="md-nav__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-white-105x40.svg alt=logo> </a> Phalcon Documentation </label> <div class=md-nav__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex> <span class=md-ellipsis> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/phalcon/cphalcon/blob/5.0.x/CHANGELOG-5.0.md class=md-nav__link> <span class=md-ellipsis> Current Version </span> </a> </li> <li class=md-nav__item> <a href=../releases/ class=md-nav__link> <span class=md-ellipsis> Releases </span> </a> </li> <li class=md-nav__item> <a href=../upgrade/ class=md-nav__link> <span class=md-ellipsis> How to upgrade </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_3> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../contributions/ class=md-nav__link> <span class=md-ellipsis> Contributions </span> </a> </li> <li class=md-nav__item> <a href=https://phalcon.io/discussions class=md-nav__link> <span class=md-ellipsis> Asking a question </span> </a> </li> <li class=md-nav__item> <a href=../new-feature-request/ class=md-nav__link> <span class=md-ellipsis> Requesting a change </span> </a> </li> <li class=md-nav__item> <a href=../new-pull-request/ class=md-nav__link> <span class=md-ellipsis> Issuing a Pull Request </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../generating-backtrace/ class=md-nav__link> <span class=md-ellipsis> Backtrace Generation </span> </a> </li> <li class=md-nav__item> <a href=../reproducible-tests/ class=md-nav__link> <span class=md-ellipsis> Reproducible Tests </span> </a> </li> <li class=md-nav__item> <a href=../testing-environment/ class=md-nav__link> <span class=md-ellipsis> Testing environment </span> </a> </li> <li class=md-nav__item> <a href=../coding-standard/ class=md-nav__link> <span class=md-ellipsis> Coding Standard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sponsors/ class=md-nav__link> <span class=md-ellipsis> Sponsoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../webserver-setup/ class=md-nav__link> <span class=md-ellipsis> Webserver Setup </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Environments </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Environments </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../environments-devilbox/ class=md-nav__link> <span class=md-ellipsis> Devilbox </span> </a> </li> <li class=md-nav__item> <a href=../environments-nanobox/ class=md-nav__link> <span class=md-ellipsis> Nanobox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex> <span class=md-ellipsis> Development Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Development Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../devtools/ class=md-nav__link> <span class=md-ellipsis> Devtools </span> </a> </li> <li class=md-nav__item> <a href=../support-debug/ class=md-nav__link> <span class=md-ellipsis> Debug </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> <li class=md-nav__item> <a href=../unit-testing/ class=md-nav__link> <span class=md-ellipsis> Unit Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorial-basic/ class=md-nav__link> <span class=md-ellipsis> Basic </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-invo/ class=md-nav__link> <span class=md-ellipsis> Invo </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-rest/ class=md-nav__link> <span class=md-ellipsis> REST </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-vokuro/ class=md-nav__link> <span class=md-ellipsis> Vokuro </span> </a> </li> <li class=md-nav__item> <a href=../use-case/ class=md-nav__link> <span class=md-ellipsis> Use case </span> </a> </li> <li class=md-nav__item> <a href=../performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../application/ class=md-nav__link> <span class=md-ellipsis> Application </span> </a> </li> <li class=md-nav__item> <a href=../application-micro/ class=md-nav__link> <span class=md-ellipsis> Micro </span> </a> </li> <li class=md-nav__item> <a href=../application-cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../di/ class=md-nav__link> <span class=md-ellipsis> DI Container </span> </a> </li> <li class=md-nav__item> <a href=../mvc/ class=md-nav__link> <span class=md-ellipsis> MVC </span> </a> </li> <li class=md-nav__item> <a href=../namespaces/ class=md-nav__link> <span class=md-ellipsis> Namespaces </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../db-layer/ class=md-nav__link> <span class=md-ellipsis> Layer </span> </a> </li> <li class=md-nav__item> <a href=../db-phql/ class=md-nav__link> <span class=md-ellipsis> PHQL </span> </a> </li> <li class=md-nav__item> <a href=../db-odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Models </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Models </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#constants class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class=md-nav__item> <a href=#methods class=md-nav__link> <span class=md-ellipsis> Methods </span> </a> </li> <li class=md-nav__item> <a href=#creating-models class=md-nav__link> <span class=md-ellipsis> Creating Models </span> </a> </li> <li class=md-nav__item> <a href=#records-to-objects class=md-nav__link> <span class=md-ellipsis> Records To Objects </span> </a> </li> <li class=md-nav__item> <a href=#finding-records class=md-nav__link> <span class=md-ellipsis> Finding Records </span> </a> <nav class=md-nav aria-label="Finding Records"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#find class=md-nav__link> <span class=md-ellipsis> find </span> </a> </li> <li class=md-nav__item> <a href=#findfirst class=md-nav__link> <span class=md-ellipsis> findFirst </span> </a> </li> <li class=md-nav__item> <a href=#parameters class=md-nav__link> <span class=md-ellipsis> Parameters </span> </a> </li> <li class=md-nav__item> <a href=#query class=md-nav__link> <span class=md-ellipsis> query </span> </a> </li> <li class=md-nav__item> <a href=#findby class=md-nav__link> <span class=md-ellipsis> findBy* </span> </a> </li> <li class=md-nav__item> <a href=#findfirstby class=md-nav__link> <span class=md-ellipsis> findFirstBy* </span> </a> </li> <li class=md-nav__item> <a href=#model-resultsets class=md-nav__link> <span class=md-ellipsis> Model Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#custom-resultsets class=md-nav__link> <span class=md-ellipsis> Custom Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#filtering-resultsets class=md-nav__link> <span class=md-ellipsis> Filtering Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#binding-parameters class=md-nav__link> <span class=md-ellipsis> Binding Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#beforeafter-fetching class=md-nav__link> <span class=md-ellipsis> Before/After Fetching </span> </a> </li> <li class=md-nav__item> <a href=#calculations class=md-nav__link> <span class=md-ellipsis> Calculations </span> </a> </li> <li class=md-nav__item> <a href=#creating-updating class=md-nav__link> <span class=md-ellipsis> Creating - Updating </span> </a> </li> <li class=md-nav__item> <a href=#deleting class=md-nav__link> <span class=md-ellipsis> Deleting </span> </a> </li> <li class=md-nav__item> <a href=#hydration-modes class=md-nav__link> <span class=md-ellipsis> Hydration Modes </span> </a> </li> <li class=md-nav__item> <a href=#table-prefixes class=md-nav__link> <span class=md-ellipsis> Table Prefixes </span> </a> </li> <li class=md-nav__item> <a href=#identity-columns class=md-nav__link> <span class=md-ellipsis> Identity Columns </span> </a> </li> <li class=md-nav__item> <a href=#skipping-columns class=md-nav__link> <span class=md-ellipsis> Skipping Columns </span> </a> </li> <li class=md-nav__item> <a href=#dynamic-updates class=md-nav__link> <span class=md-ellipsis> Dynamic Updates </span> </a> </li> <li class=md-nav__item> <a href=#column-mapping class=md-nav__link> <span class=md-ellipsis> Column Mapping </span> </a> </li> <li class=md-nav__item> <a href=#record-snapshots class=md-nav__link> <span class=md-ellipsis> Record Snapshots </span> </a> </li> <li class=md-nav__item> <a href=#events class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=#transactions class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=#changing-schema class=md-nav__link> <span class=md-ellipsis> Changing Schema </span> </a> </li> <li class=md-nav__item> <a href=#multiple-databases class=md-nav__link> <span class=md-ellipsis> Multiple Databases </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#model-features class=md-nav__link> <span class=md-ellipsis> Model Features </span> </a> </li> <li class=md-nav__item> <a href=#integers-vs-strings class=md-nav__link> <span class=md-ellipsis> Integers vs. Strings </span> </a> </li> <li class=md-nav__item> <a href=#invalid-parameter-number class=md-nav__link> <span class=md-ellipsis> Invalid parameter number </span> </a> </li> <li class=md-nav__item> <a href=#stand-alone-component class=md-nav__link> <span class=md-ellipsis> Stand-Alone Component </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../db-models-behaviors/ class=md-nav__link> <span class=md-ellipsis> Behaviors </span> </a> </li> <li class=md-nav__item> <a href=../db-models-cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../db-models-events/ class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=../db-models-metadata/ class=md-nav__link> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../db-models-relationships/ class=md-nav__link> <span class=md-ellipsis> Relationships </span> </a> </li> <li class=md-nav__item> <a href=../db-models-transactions/ class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=../db-models-validation/ class=md-nav__link> <span class=md-ellipsis> Validators </span> </a> </li> <li class=md-nav__item> <a href=../db-pagination/ class=md-nav__link> <span class=md-ellipsis> Pagination </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> <li class=md-nav__item> <a href=../datamapper/ class=md-nav__link> <span class=md-ellipsis> DataMapper </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Front End </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Front End </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../assets/ class=md-nav__link> <span class=md-ellipsis> Assets </span> </a> </li> <li class=md-nav__item> <a href=../flash/ class=md-nav__link> <span class=md-ellipsis> Flash Messenger </span> </a> </li> <li class=md-nav__item> <a href=../forms/ class=md-nav__link> <span class=md-ellipsis> Forms </span> </a> </li> <li class=md-nav__item> <a href=../image/ class=md-nav__link> <span class=md-ellipsis> Image </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex> <span class=md-ellipsis> HTML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> HTML </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../html-attributes/ class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> </li> <li class=md-nav__item> <a href=../html-breadcrumbs/ class=md-nav__link> <span class=md-ellipsis> Breadcrumbs </span> </a> </li> <li class=md-nav__item> <a href=../html-escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../html-link/ class=md-nav__link> <span class=md-ellipsis> Link </span> </a> </li> <li class=md-nav__item> <a href=../html-tagfactory/ class=md-nav__link> <span class=md-ellipsis> Tag Factory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tag/ class=md-nav__link> <span class=md-ellipsis> Tag (legacy) </span> </a> </li> <li class=md-nav__item> <a href=../views/ class=md-nav__link> <span class=md-ellipsis> View </span> </a> </li> <li class=md-nav__item> <a href=../volt/ class=md-nav__link> <span class=md-ellipsis> Volt </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Business Logic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Business Logic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../acl/ class=md-nav__link> <span class=md-ellipsis> Access Control Lists </span> </a> </li> <li class=md-nav__item> <a href=../annotations/ class=md-nav__link> <span class=md-ellipsis> Annotations </span> </a> </li> <li class=md-nav__item> <a href=../controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../dispatcher/ class=md-nav__link> <span class=md-ellipsis> Dispatcher </span> </a> </li> <li class=md-nav__item> <a href=../events/ class=md-nav__link> <span class=md-ellipsis> Event Manager </span> </a> </li> <li class=md-nav__item> <a href=../filter-filter/ class=md-nav__link> <span class=md-ellipsis> Filters </span> </a> </li> <li class=md-nav__item> <a href=../routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../session/ class=md-nav__link> <span class=md-ellipsis> Sessions </span> </a> </li> <li class=md-nav__item> <a href=../mvc-url/ class=md-nav__link> <span class=md-ellipsis> Url </span> </a> </li> <li class=md-nav__item> <a href=../filter-validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../config/ class=md-nav__link> <span class=md-ellipsis> Config </span> </a> </li> <li class=md-nav__item> <a href=../html-escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../autoload/ class=md-nav__link> <span class=md-ellipsis> Loader </span> </a> </li> <li class=md-nav__item> <a href=../logger/ class=md-nav__link> <span class=md-ellipsis> Logger </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_6> <label class=md-nav__link for=__nav_7_6 id=__nav_7_6_label tabindex> <span class=md-ellipsis> HTTP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_6> <span class="md-nav__icon md-icon"></span> HTTP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../response/#cookies class=md-nav__link> <span class=md-ellipsis> Cookies </span> </a> </li> <li class=md-nav__item> <a href=../request/ class=md-nav__link> <span class=md-ellipsis> Request </span> </a> </li> <li class=md-nav__item> <a href=../response/ class=md-nav__link> <span class=md-ellipsis> Response </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_7> <label class=md-nav__link for=__nav_7_7 id=__nav_7_7_label tabindex> <span class=md-ellipsis> i18n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_7> <span class="md-nav__icon md-icon"></span> i18n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../i18n/ class=md-nav__link> <span class=md-ellipsis> Internationalization </span> </a> </li> <li class=md-nav__item> <a href=../translate/ class=md-nav__link> <span class=md-ellipsis> Translate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../queue/ class=md-nav__link> <span class=md-ellipsis> Queue </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_9> <label class=md-nav__link for=__nav_7_9 id=__nav_7_9_label tabindex> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_9> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../encryption-crypt/ class=md-nav__link> <span class=md-ellipsis> Cryptography </span> </a> </li> <li class=md-nav__item> <a href=../encryption-security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../encryption-security-jwt/ class=md-nav__link> <span class=md-ellipsis> JWT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../storage/ class=md-nav__link> <span class=md-ellipsis> Storage </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_11> <label class=md-nav__link for=__nav_7_11 id=__nav_7_11_label tabindex> <span class=md-ellipsis> Utility </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_11_label aria-expanded=false> <label class=md-nav__title for=__nav_7_11> <span class="md-nav__icon md-icon"></span> Utility </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../support-collection/ class=md-nav__link> <span class=md-ellipsis> Collection </span> </a> </li> <li class=md-nav__item> <a href=../domain/ class=md-nav__link> <span class=md-ellipsis> Domain </span> </a> </li> <li class=md-nav__item> <a href=../support-helper/ class=md-nav__link> <span class=md-ellipsis> Helper </span> </a> </li> <li class=md-nav__item> <a href=../support-registry/ class=md-nav__link> <span class=md-ellipsis> Registry </span> </a> </li> <li class=md-nav__item> <a href=../support-version/ class=md-nav__link> <span class=md-ellipsis> Version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../api/ class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#constants class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class=md-nav__item> <a href=#methods class=md-nav__link> <span class=md-ellipsis> Methods </span> </a> </li> <li class=md-nav__item> <a href=#creating-models class=md-nav__link> <span class=md-ellipsis> Creating Models </span> </a> </li> <li class=md-nav__item> <a href=#records-to-objects class=md-nav__link> <span class=md-ellipsis> Records To Objects </span> </a> </li> <li class=md-nav__item> <a href=#finding-records class=md-nav__link> <span class=md-ellipsis> Finding Records </span> </a> <nav class=md-nav aria-label="Finding Records"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#find class=md-nav__link> <span class=md-ellipsis> find </span> </a> </li> <li class=md-nav__item> <a href=#findfirst class=md-nav__link> <span class=md-ellipsis> findFirst </span> </a> </li> <li class=md-nav__item> <a href=#parameters class=md-nav__link> <span class=md-ellipsis> Parameters </span> </a> </li> <li class=md-nav__item> <a href=#query class=md-nav__link> <span class=md-ellipsis> query </span> </a> </li> <li class=md-nav__item> <a href=#findby class=md-nav__link> <span class=md-ellipsis> findBy* </span> </a> </li> <li class=md-nav__item> <a href=#findfirstby class=md-nav__link> <span class=md-ellipsis> findFirstBy* </span> </a> </li> <li class=md-nav__item> <a href=#model-resultsets class=md-nav__link> <span class=md-ellipsis> Model Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#custom-resultsets class=md-nav__link> <span class=md-ellipsis> Custom Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#filtering-resultsets class=md-nav__link> <span class=md-ellipsis> Filtering Resultsets </span> </a> </li> <li class=md-nav__item> <a href=#binding-parameters class=md-nav__link> <span class=md-ellipsis> Binding Parameters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#beforeafter-fetching class=md-nav__link> <span class=md-ellipsis> Before/After Fetching </span> </a> </li> <li class=md-nav__item> <a href=#calculations class=md-nav__link> <span class=md-ellipsis> Calculations </span> </a> </li> <li class=md-nav__item> <a href=#creating-updating class=md-nav__link> <span class=md-ellipsis> Creating - Updating </span> </a> </li> <li class=md-nav__item> <a href=#deleting class=md-nav__link> <span class=md-ellipsis> Deleting </span> </a> </li> <li class=md-nav__item> <a href=#hydration-modes class=md-nav__link> <span class=md-ellipsis> Hydration Modes </span> </a> </li> <li class=md-nav__item> <a href=#table-prefixes class=md-nav__link> <span class=md-ellipsis> Table Prefixes </span> </a> </li> <li class=md-nav__item> <a href=#identity-columns class=md-nav__link> <span class=md-ellipsis> Identity Columns </span> </a> </li> <li class=md-nav__item> <a href=#skipping-columns class=md-nav__link> <span class=md-ellipsis> Skipping Columns </span> </a> </li> <li class=md-nav__item> <a href=#dynamic-updates class=md-nav__link> <span class=md-ellipsis> Dynamic Updates </span> </a> </li> <li class=md-nav__item> <a href=#column-mapping class=md-nav__link> <span class=md-ellipsis> Column Mapping </span> </a> </li> <li class=md-nav__item> <a href=#record-snapshots class=md-nav__link> <span class=md-ellipsis> Record Snapshots </span> </a> </li> <li class=md-nav__item> <a href=#events class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=#transactions class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=#changing-schema class=md-nav__link> <span class=md-ellipsis> Changing Schema </span> </a> </li> <li class=md-nav__item> <a href=#multiple-databases class=md-nav__link> <span class=md-ellipsis> Multiple Databases </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#model-features class=md-nav__link> <span class=md-ellipsis> Model Features </span> </a> </li> <li class=md-nav__item> <a href=#integers-vs-strings class=md-nav__link> <span class=md-ellipsis> Integers vs. Strings </span> </a> </li> <li class=md-nav__item> <a href=#invalid-parameter-number class=md-nav__link> <span class=md-ellipsis> Invalid parameter number </span> </a> </li> <li class=md-nav__item> <a href=#stand-alone-component class=md-nav__link> <span class=md-ellipsis> Stand-Alone Component </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/phalcon/documentation/edit/master/docs/db-models.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/phalcon/documentation/raw/master/docs/db-models.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=models>Models<a class=headerlink href=#models title="Permanent link">&para;</a></h1> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>The <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> is the <code>M</code> in MVC. It is a class that connects business objects and database tables, to create a persistent domain model, where logic and data are wrapped into one. It is an implementation of the object-relational mapping (ORM).</p> <p>A model represents the information (data) of the application and the rules to manipulate that data. Models are primarily used for managing the rules of interaction with a corresponding database table. In most cases, each table in your database will correspond to one model in your application. The bulk of your application's business logic will be concentrated in the models.</p> <p>The <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> is the first ORM written in Zephir/C languages for PHP, giving developers high performance when interacting with databases while is also easy to use.</p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>Models are intended to work with the database on a high layer of abstraction. If you need to work with databases at a lower level check out the <a href=../db-layer/ >Phalcon\Db\Db</a> component documentation.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=p>{</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=sd>/**</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=sd> * Create an invoice </span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=sd> */</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$result</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>    <span class=k>echo</span> <span class=s1>&#39;Error saving Invoice: &#39;</span><span class=p>;</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>        <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>    <span class=p>}</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>    <span class=k>echo</span> <span class=s1>&#39;Record Saved&#39;</span><span class=p>;</span>
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>
<a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=p>}</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>For information on how to create a model please check the <a href=#creating-models>Creating Models</a> section</p> </div> <h2 id=constants>Constants<a class=headerlink href=#constants title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Constant</th> <th style="text-align: center;">Value</th> </tr> </thead> <tbody> <tr> <td>DIRTY_STATE_DETACHED</td> <td style="text-align: center;">2</td> </tr> <tr> <td>DIRTY_STATE_PERSISTENT</td> <td style="text-align: center;">0</td> </tr> <tr> <td>DIRTY_STATE_TRANSIENT</td> <td style="text-align: center;">1</td> </tr> <tr> <td>OP_CREATE</td> <td style="text-align: center;">1</td> </tr> <tr> <td>OP_DELETE</td> <td style="text-align: center;">3</td> </tr> <tr> <td>OP_NONE</td> <td style="text-align: center;">0</td> </tr> <tr> <td>OP_UPDATE</td> <td style="text-align: center;">2</td> </tr> <tr> <td>TRANSACTION_INDEX</td> <td style="text-align: center;">'transaction'</td> </tr> </tbody> </table> <h2 id=methods>Methods<a class=headerlink href=#methods title="Permanent link">&para;</a></h2> <p><div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=nx>mixed</span> <span class=nv>$data</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> 
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>    <span class=nx>DiInterface</span> <span class=nv>$container</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=nx>ManagerInterface</span> <span class=nv>$modelsManager</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=p>)</span>
</code></pre></div> Constructs the model object. The method accepts an array of data that are used to populate the object by internally using <code>assign</code>. Optionally you can pass a DI container and a Models Manager object. If they are not passed, the defaults will be used.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>public</span> <span class=k>function</span> <span class=fm>__call</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$method</span><span class=p>,</span> <span class=k>array</span> <span class=nv>$arguments</span><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span>
</code></pre></div> Handles method calls when a method is not implemented. Throws <a href=../api/phalcon_mvc/#mvcmodelexception->Phalcon\Mvc\Model\Exception</a> if the method doesn't exist</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=fm>__callStatic</span><span class=p>(</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>    <span class=nx>string</span> <span class=nv>$method</span><span class=p>,</span> 
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>    <span class=k>array</span> <span class=nv>$arguments</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span>
</code></pre></div> Handles method calls when a static method is not implemented. Throws <a href=../api/phalcon_mvc/#mvcmodelexception->Phalcon\Mvc\Model\Exception</a> if the method doesn't exist</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>public</span> <span class=k>function</span> <span class=fm>__get</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$property</span><span class=p>)</span>
</code></pre></div> Magic method to get related records using the relation alias as a property</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>public</span> <span class=k>function</span> <span class=fm>__isset</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$property</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Magic method to check if a property is a valid relation</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>public</span> <span class=k>function</span> <span class=fm>__set</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$property</span><span class=p>,</span> <span class=nx>mixed</span> <span class=nv>$value</span><span class=p>)</span>
</code></pre></div> Magic method to assign values to the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>addBehavior</span><span class=p>(</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>    <span class=nx>BehaviorInterface</span> <span class=nv>$behavior</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Setup a behavior in a model</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Behavior\Timestampable</span><span class=p>;</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=p>{</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=p>{</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>addBehavior</span><span class=p>(</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>            <span class=k>new</span> <span class=nx>Timestampable</span><span class=p>(</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>                <span class=p>[</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>                    <span class=s1>&#39;onCreate&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>                        <span class=s1>&#39;field&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>                        <span class=s1>&#39;format&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Y-m-d H:i:s&#39;</span><span class=p>,</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>                    <span class=p>],</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>                <span class=p>]</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>            <span class=p>)</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>        <span class=p>);</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>    <span class=p>}</span>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>appendMessage</span><span class=p>(</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=nx>MessageInterface</span> <span class=nv>$message</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Appends a customized message on the validation process</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=k>use</span> <span class=nx>Phalcon\Messages\Message</span> <span class=k>as</span> <span class=nx>Message</span><span class=p>;</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=p>{</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeSave</span><span class=p>()</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>    <span class=p>{</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>        <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>===</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>            <span class=nv>$message</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Message</span><span class=p>(</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>                <span class=s1>&#39;Sorry, an invoice cannot be unpaid&#39;</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>            <span class=p>);</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>appendMessage</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>        <span class=p>}</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=p>}</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>assign</span><span class=p>(</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=nx>mixed</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=k>array</span> <span class=nv>$whiteList</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> 
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=k>array</span> <span class=nv>$dataColumnMap</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Assign data to the model. The <code>data</code> parameter can be an array or a database row. The <code>whitelist</code> is an array of model properties that will be updated during the assignment process. Omitted properties will NOT be accepted even if they are included in the array or database row; nevertheless, if one of them is required by the model, the data will not be saved and the model will produce an error. The <code>dataColumnMap</code> is an array that maps columns from the <code>data</code> to the actual model. This helps when you want to map input from an array such as <code>$_POST</code> to fields in the database.</p> <p>Assign values to a model from an array <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>    <span class=p>[</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>        <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>        <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>        <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>,</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>        <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>        <span class=s1>&#39;inv_created_at&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>,</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>    <span class=p>]</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=p>);</span>
</code></pre></div></p> <p><code>assign</code> with a database row. - Requires a Column Map <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=nv>$row</span><span class=p>,</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=p>[</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>        <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;customerId&#39;</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>        <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;status&#39;</span><span class=p>,</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>        <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;title&#39;</span><span class=p>,</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>        <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;total&#39;</span><span class=p>,</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>    <span class=p>]</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=p>);</span>
</code></pre></div></p> <p>Update only the <code>inv_status_flag</code>, <code>inv_title</code>, <code>inv_total</code> fields. <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=nv>$_POST</span><span class=p>,</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=p>[</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>        <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>        <span class=s1>&#39;inv_title&#39;</span><span class=p>,</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>        <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>    <span class=p>]</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=p>);</span>
</code></pre></div></p> <p>By default <code>assign</code> will use setters if they exist, you can disable it by using <code>ini_set</code> to directly use properties</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nb>ini_set</span><span class=p>(</span><span class=s1>&#39;phalcon.orm.disable_assign_setters&#39;</span><span class=p>,</span> <span class=k>true</span><span class=p>);</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=nv>$_POST</span><span class=p>,</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=p>[</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>        <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>        <span class=s1>&#39;inv_title&#39;</span><span class=p>,</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>        <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>    <span class=p>]</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>average</span><span class=p>(</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>    <span class=nx>mixed</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>float</span>
</code></pre></div> Returns the average value on a column for a result-set of rows matching the specified conditions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>average</span><span class=p>(</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=p>[</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=p>]</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=p>);</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=k>echo</span> <span class=s1>&#39;AVG: &#39;</span><span class=p>,</span> <span class=nv>$average</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>average</span><span class=p>(</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>    <span class=p>[</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>        <span class=s1>&#39;inv_cst_id = 1&#39;</span><span class=p>,</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a>    <span class=p>]</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=p>);</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=k>echo</span> <span class=s1>&#39;AVG [Customer: 1] &#39;</span><span class=p>,</span> <span class=nv>$average</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>cloneResult</span><span class=p>(</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=nx>ModelInterface</span> <span class=nv>$base</span><span class=p>,</span> 
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>    <span class=k>array</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>    <span class=nx>int</span> <span class=nv>$dirtyState</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Assigns values to a model from an array returning a new model</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>cloneResult</span><span class=p>(</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>     <span class=k>new</span> <span class=nx>Invoices</span><span class=p>(),</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=p>[</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>        <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>        <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>        <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;Invoice for ACME Inc. #2&#39;</span><span class=p>,</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>        <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=mi>400</span><span class=p>,</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>        <span class=s1>&#39;inv_created_at&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>,</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>    <span class=p>]</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a> <span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>cloneResultMap</span><span class=p>(</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=nx>mixed</span> <span class=nv>$base</span><span class=p>,</span> 
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>    <span class=k>array</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>    <span class=k>array</span> <span class=nv>$columnMap</span><span class=p>,</span> 
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=nx>int</span> <span class=nv>$dirtyState</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> 
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=nx>bool</span> <span class=nv>$keepSnapshots</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Assign values to a model from an array, returning a new model, using the column map.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>cloneResultMap</span><span class=p>(</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>     <span class=k>new</span> <span class=nx>Invoices</span><span class=p>(),</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>     <span class=p>[</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>        <span class=s1>&#39;customerId&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>        <span class=s1>&#39;status&#39;</span>     <span class=o>=&gt;</span> <span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>        <span class=s1>&#39;title&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;Invoice for ACME Inc. #2&#39;</span><span class=p>,</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>        <span class=s1>&#39;total&#39;</span>      <span class=o>=&gt;</span> <span class=mi>400</span><span class=p>,</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>        <span class=s1>&#39;created&#39;</span>    <span class=o>=&gt;</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>,</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>     <span class=p>]</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>cloneResultMapHydrate</span><span class=p>(</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>    <span class=k>array</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>    <span class=k>array</span> <span class=nv>$columnMap</span><span class=p>,</span> 
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>    <span class=nx>int</span> <span class=nv>$hydrationMode</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span>
</code></pre></div> Returns a hydrated result based on the data and the column map</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>count</span><span class=p>(</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>    <span class=nx>mixed</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>int</span>
</code></pre></div> Returns a count of how many records match the specified conditions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>();</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=k>echo</span> <span class=s1>&#39;COUNT: &#39;</span><span class=p>,</span> <span class=nv>$average</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>(</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>    <span class=s1>&#39;inv_cst_id = 1&#39;</span>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=p>);</span>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=k>echo</span> <span class=s1>&#39;COUNT [Customer: 1] &#39;</span><span class=p>,</span> <span class=nv>$average</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>create</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Inserts a model in the database. If the record exists in the database, <code>create()</code> will throw an exception. It will return <code>true</code> on success, <code>false</code> otherwise.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=p>[</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>        <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>        <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>        <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>,</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>        <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>        <span class=s1>&#39;inv_created_at&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>,</span>
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>    <span class=p>]</span>
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=p>);</span>
<a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>
<a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>delete</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Deletes a model instance. Returning true on success or false otherwise.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 4&#39;</span><span class=p>);</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=nv>$result</span>  <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>delete</span><span class=p>();</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>    <span class=p>[</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>        <span class=p>]</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>    <span class=p>]</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=p>);</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>delete</span><span class=p>();</span>
<a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>dump</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns a simple representation of the object that can be used with <code>var_dump()</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 4&#39;</span><span class=p>);</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=nb>var_dump</span><span class=p>(</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>dump</span><span class=p>()</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>find</span><span class=p>(</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>    <span class=nx>mixed</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ResultsetInterface</span>
</code></pre></div> Query for a set of records that match the specified conditions. <code>find()</code> is flexible enough to accept a variety of parameters to find the data required. You can check the <a href=#finding-records>Finding Records</a> section for more information.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>findFirst</span><span class=p>(</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>    <span class=nx>mixed</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span> <span class=o>|</span> <span class=k>null</span>
</code></pre></div> Query the first record that matches the specified conditions. It will return a resultset or <code>null</code> if the record was not found.</p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p><code>findFirst()</code> no longer returns <code>false</code> if records were not found.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>fireEvent</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$eventName</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Fires an event, implicitly calls behaviors, and listeners in the events manager are notified</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>fireEventCancel</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$eventName</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Fires an event, implicitly calls behaviors, and listeners in the events manager are notified. This method stops if one of the callbacks/listeners returns <code>false</code></p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getChangedFields</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns a list of changed values.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=p>);</span> 
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=c1>// []</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;;</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>();</span>
<a id=__codelineno-40-15 name=__codelineno-40-15 href=#__codelineno-40-15></a>
<a id=__codelineno-40-16 name=__codelineno-40-16 href=#__codelineno-40-16></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-40-17 name=__codelineno-40-17 href=#__codelineno-40-17></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span>
<a id=__codelineno-40-18 name=__codelineno-40-18 href=#__codelineno-40-18></a><span class=p>);</span>
<a id=__codelineno-40-19 name=__codelineno-40-19 href=#__codelineno-40-19></a><span class=c1>// [&#39;inv_total&#39;]</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getDirtyState</span><span class=p>()</span><span class=o>:</span> <span class=nx>int</span>
</code></pre></div> Returns one of the <code>DIRTY_STATE_*</code> constants telling if the record exists in the database or not</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getMessages</span><span class=p>(</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>    <span class=nx>mixed</span> <span class=nv>$filter</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>MessageInterface</span><span class=p>[]</span>
</code></pre></div> Returns an array of validation messages</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a>
<a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$result</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a>
<a id=__codelineno-43-17 name=__codelineno-43-17 href=#__codelineno-43-17></a>    <span class=k>echo</span> <span class=s1>&#39;Error saving Invoice: &#39;</span><span class=p>;</span>
<a id=__codelineno-43-18 name=__codelineno-43-18 href=#__codelineno-43-18></a>
<a id=__codelineno-43-19 name=__codelineno-43-19 href=#__codelineno-43-19></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-43-20 name=__codelineno-43-20 href=#__codelineno-43-20></a>
<a id=__codelineno-43-21 name=__codelineno-43-21 href=#__codelineno-43-21></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-43-22 name=__codelineno-43-22 href=#__codelineno-43-22></a>        <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-43-23 name=__codelineno-43-23 href=#__codelineno-43-23></a>    <span class=p>}</span>
<a id=__codelineno-43-24 name=__codelineno-43-24 href=#__codelineno-43-24></a><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-43-25 name=__codelineno-43-25 href=#__codelineno-43-25></a>
<a id=__codelineno-43-26 name=__codelineno-43-26 href=#__codelineno-43-26></a>    <span class=k>echo</span> <span class=s1>&#39;Record Saved&#39;</span><span class=p>;</span>
<a id=__codelineno-43-27 name=__codelineno-43-27 href=#__codelineno-43-27></a>
<a id=__codelineno-43-28 name=__codelineno-43-28 href=#__codelineno-43-28></a><span class=p>}</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p><code>save()</code> no longer accepts parameters to set data. You can use <code>assign</code> instead.</p> </div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getModelsManager</span><span class=p>()</span><span class=o>:</span> <span class=nx>ManagerInterface</span>
</code></pre></div> Returns the models manager related to the entity instance</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getModelsMetaData</span><span class=p>()</span><span class=o>:</span> <span class=nx>MetaDataInterface</span>
</code></pre></div> Returns the model's meta-data service related to the entity instance</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getOperationMade</span><span class=p>()</span><span class=o>:</span> <span class=nx>int</span>
</code></pre></div> Returns the type of the latest operation performed by the ORM. Returns one of the <code>OP_*</code> class constants</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getOldSnapshotData</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns the internal old snapshot data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getReadConnection</span><span class=p>()</span><span class=o>:</span> <span class=nx>AdapterInterface</span>
</code></pre></div> Gets the connection used to read data for the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getReadConnectionService</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</code></pre></div> Returns the DependencyInjection connection service name used to read data related to the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getRelated</span><span class=p>(</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a>    <span class=nx>string</span> <span class=nv>$alias</span><span class=p>,</span> 
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>    <span class=nx>mixed</span> <span class=nv>$arguments</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>Phalcon\Mvc\Model\Resultset\Simple</span> <span class=o>|</span> <span class=k>null</span>
</code></pre></div> Returns related records based on defined relations. If the relationship is one to one and no records have been found, it will return <code>null</code></p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p><code>getRelated()</code> no longer returns <code>false</code> if a record was not found on a one-to-one relationship.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a>
<a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a><span class=nv>$customer</span> <span class=o>=</span> <span class=nx>Customers</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;cst_id = 1&#39;</span><span class=p>);</span>
<a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>getRelated</span><span class=p>(</span><span class=s1>&#39;invoices&#39;</span><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>isRelationshipLoaded</span><span class=p>(</span>
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>    <span class=nx>string</span> <span class=nv>$relationshipAlias</span>
<a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Checks if saved related records have already been loaded. Only returns <code>true</code> if the records were previously fetched through the model without any additional parameters.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a>
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>
<a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=nv>$customer</span> <span class=o>=</span> <span class=nx>Customers</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;cst_id = 1&#39;</span><span class=p>);</span>
<a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>isRelationshipLoaded</span><span class=p>(</span><span class=s1>&#39;invoices&#39;</span><span class=p>);</span> <span class=c1>// false</span>
<a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a>
<a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>getRelated</span><span class=p>(</span><span class=s1>&#39;invoices&#39;</span><span class=p>);</span>
<a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>isRelationshipLoaded</span><span class=p>(</span><span class=s1>&#39;invoices&#39;</span><span class=p>);</span> <span class=c1>// true</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getSchema</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</code></pre></div> Returns schema name where the mapped table is located</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getSnapshotData</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns the internal snapshot data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getSource</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</code></pre></div> Returns the table name mapped in the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>getUpdatedFields</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns a list of updated values.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
<a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a>
<a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
<a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a>
<a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span>
<a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a><span class=p>);</span> 
<a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a><span class=c1>// []</span>
<a id=__codelineno-58-11 name=__codelineno-58-11 href=#__codelineno-58-11></a>
<a id=__codelineno-58-12 name=__codelineno-58-12 href=#__codelineno-58-12></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;;</span>
<a id=__codelineno-58-13 name=__codelineno-58-13 href=#__codelineno-58-13></a>
<a id=__codelineno-58-14 name=__codelineno-58-14 href=#__codelineno-58-14></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>();</span>
<a id=__codelineno-58-15 name=__codelineno-58-15 href=#__codelineno-58-15></a>
<a id=__codelineno-58-16 name=__codelineno-58-16 href=#__codelineno-58-16></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-58-17 name=__codelineno-58-17 href=#__codelineno-58-17></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span>
<a id=__codelineno-58-18 name=__codelineno-58-18 href=#__codelineno-58-18></a><span class=p>);</span>
<a id=__codelineno-58-19 name=__codelineno-58-19 href=#__codelineno-58-19></a><span class=c1>// [&#39;inv_total&#39;]</span>
<a id=__codelineno-58-20 name=__codelineno-58-20 href=#__codelineno-58-20></a>
<a id=__codelineno-58-21 name=__codelineno-58-21 href=#__codelineno-58-21></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-58-22 name=__codelineno-58-22 href=#__codelineno-58-22></a>
<a id=__codelineno-58-23 name=__codelineno-58-23 href=#__codelineno-58-23></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-58-24 name=__codelineno-58-24 href=#__codelineno-58-24></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span>
<a id=__codelineno-58-25 name=__codelineno-58-25 href=#__codelineno-58-25></a><span class=p>);</span>
<a id=__codelineno-58-26 name=__codelineno-58-26 href=#__codelineno-58-26></a><span class=c1>// []</span>
<a id=__codelineno-58-27 name=__codelineno-58-27 href=#__codelineno-58-27></a>
<a id=__codelineno-58-28 name=__codelineno-58-28 href=#__codelineno-58-28></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-58-29 name=__codelineno-58-29 href=#__codelineno-58-29></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getUpdatedFields</span><span class=p>()</span>
<a id=__codelineno-58-30 name=__codelineno-58-30 href=#__codelineno-58-30></a><span class=p>);</span>
<a id=__codelineno-58-31 name=__codelineno-58-31 href=#__codelineno-58-31></a><span class=c1>// [&#39;inv_total&#39;]</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getWriteConnection</span><span class=p>()</span><span class=o>:</span> <span class=nx>AdapterInterface</span>
</code></pre></div> Gets the connection used to write data to the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>getWriteConnectionService</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</code></pre></div> Returns the DependencyInjection connection service name used to write data related to the model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>hasChanged</span><span class=p>(</span>
<a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fieldName</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> 
<a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a>    <span class=nx>bool</span> <span class=nv>$allFields</span> <span class=o>=</span> <span class=k>false</span>
<a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Check if a specific attribute has changed. This only works if the model is keeping data snapshots</p> <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a>
<a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a>
<a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a>
<a id=__codelineno-62-7 name=__codelineno-62-7 href=#__codelineno-62-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-62-8 name=__codelineno-62-8 href=#__codelineno-62-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-62-9 name=__codelineno-62-9 href=#__codelineno-62-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-62-10 name=__codelineno-62-10 href=#__codelineno-62-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-62-11 name=__codelineno-62-11 href=#__codelineno-62-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-62-12 name=__codelineno-62-12 href=#__codelineno-62-12></a>
<a id=__codelineno-62-13 name=__codelineno-62-13 href=#__codelineno-62-13></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
<a id=__codelineno-62-14 name=__codelineno-62-14 href=#__codelineno-62-14></a>
<a id=__codelineno-62-15 name=__codelineno-62-15 href=#__codelineno-62-15></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
<a id=__codelineno-62-16 name=__codelineno-62-16 href=#__codelineno-62-16></a>
<a id=__codelineno-62-17 name=__codelineno-62-17 href=#__codelineno-62-17></a><span class=nv>$hasChanged</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>hasChanged</span><span class=p>(</span><span class=s1>&#39;inv_title&#39;</span><span class=p>);</span>
<a id=__codelineno-62-18 name=__codelineno-62-18 href=#__codelineno-62-18></a><span class=c1>// false</span>
<a id=__codelineno-62-19 name=__codelineno-62-19 href=#__codelineno-62-19></a><span class=nv>$hasChanged</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>hasChanged</span><span class=p>(</span>
<a id=__codelineno-62-20 name=__codelineno-62-20 href=#__codelineno-62-20></a>    <span class=p>[</span>
<a id=__codelineno-62-21 name=__codelineno-62-21 href=#__codelineno-62-21></a>        <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-62-22 name=__codelineno-62-22 href=#__codelineno-62-22></a>    <span class=p>]</span>
<a id=__codelineno-62-23 name=__codelineno-62-23 href=#__codelineno-62-23></a><span class=p>);</span>
<a id=__codelineno-62-24 name=__codelineno-62-24 href=#__codelineno-62-24></a><span class=c1>// true</span>
<a id=__codelineno-62-25 name=__codelineno-62-25 href=#__codelineno-62-25></a><span class=nv>$hasChanged</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>hasChanged</span><span class=p>(</span>
<a id=__codelineno-62-26 name=__codelineno-62-26 href=#__codelineno-62-26></a>    <span class=p>[</span>
<a id=__codelineno-62-27 name=__codelineno-62-27 href=#__codelineno-62-27></a>        <span class=s1>&#39;inv_title&#39;</span><span class=p>,</span> 
<a id=__codelineno-62-28 name=__codelineno-62-28 href=#__codelineno-62-28></a>        <span class=s1>&#39;inv_total&#39;</span>
<a id=__codelineno-62-29 name=__codelineno-62-29 href=#__codelineno-62-29></a>    <span class=p>],</span> 
<a id=__codelineno-62-30 name=__codelineno-62-30 href=#__codelineno-62-30></a>    <span class=k>true</span>
<a id=__codelineno-62-31 name=__codelineno-62-31 href=#__codelineno-62-31></a><span class=p>);</span>
<a id=__codelineno-62-32 name=__codelineno-62-32 href=#__codelineno-62-32></a><span class=c1>// false</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>hasSnapshotData</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Check if the object has internal snapshot data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>hasUpdated</span><span class=p>(</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fieldName</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> 
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a>    <span class=nx>bool</span> <span class=nv>$allFields</span> <span class=o>=</span> <span class=k>false</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Check if a specific attribute was updated. This only works if the model is keeping data snapshots.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>jsonSerialize</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Serializes the object for json_encode</p> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=k>echo</span> <span class=nb>json_encode</span><span class=p>(</span><span class=nv>$invoice</span><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>maximum</span><span class=p>(</span>
<a id=__codelineno-67-2 name=__codelineno-67-2 href=#__codelineno-67-2></a>    <span class=nx>mixed</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-67-3 name=__codelineno-67-3 href=#__codelineno-67-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span>
</code></pre></div> Returns the maximum value of a column for a result-set of rows that match the specified conditions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-68-2 name=__codelineno-68-2 href=#__codelineno-68-2></a>
<a id=__codelineno-68-3 name=__codelineno-68-3 href=#__codelineno-68-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-68-4 name=__codelineno-68-4 href=#__codelineno-68-4></a>
<a id=__codelineno-68-5 name=__codelineno-68-5 href=#__codelineno-68-5></a><span class=nv>$id</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>maximum</span><span class=p>(</span>
<a id=__codelineno-68-6 name=__codelineno-68-6 href=#__codelineno-68-6></a>    <span class=p>[</span>
<a id=__codelineno-68-7 name=__codelineno-68-7 href=#__codelineno-68-7></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-68-8 name=__codelineno-68-8 href=#__codelineno-68-8></a>    <span class=p>]</span>
<a id=__codelineno-68-9 name=__codelineno-68-9 href=#__codelineno-68-9></a><span class=p>);</span>
<a id=__codelineno-68-10 name=__codelineno-68-10 href=#__codelineno-68-10></a>
<a id=__codelineno-68-11 name=__codelineno-68-11 href=#__codelineno-68-11></a><span class=k>echo</span> <span class=s1>&#39;MAX: &#39;</span><span class=p>,</span> <span class=nv>$id</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-68-12 name=__codelineno-68-12 href=#__codelineno-68-12></a>
<a id=__codelineno-68-13 name=__codelineno-68-13 href=#__codelineno-68-13></a><span class=nv>$max</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>maximum</span><span class=p>(</span>
<a id=__codelineno-68-14 name=__codelineno-68-14 href=#__codelineno-68-14></a>    <span class=p>[</span>
<a id=__codelineno-68-15 name=__codelineno-68-15 href=#__codelineno-68-15></a>        <span class=s1>&#39;inv_cst_id = 1&#39;</span><span class=p>,</span>
<a id=__codelineno-68-16 name=__codelineno-68-16 href=#__codelineno-68-16></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-68-17 name=__codelineno-68-17 href=#__codelineno-68-17></a>    <span class=p>]</span>
<a id=__codelineno-68-18 name=__codelineno-68-18 href=#__codelineno-68-18></a><span class=p>);</span>
<a id=__codelineno-68-19 name=__codelineno-68-19 href=#__codelineno-68-19></a>
<a id=__codelineno-68-20 name=__codelineno-68-20 href=#__codelineno-68-20></a><span class=k>echo</span> <span class=s1>&#39;MAX [Customer: 1] &#39;</span><span class=p>,</span> <span class=nv>$max</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>minimum</span><span class=p>(</span>
<a id=__codelineno-69-2 name=__codelineno-69-2 href=#__codelineno-69-2></a>    <span class=nx>mixed</span> <span class=nx>parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-69-3 name=__codelineno-69-3 href=#__codelineno-69-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span> 
</code></pre></div> Returns the minimum value of a column for a result-set of rows that match the specified conditions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-70-2 name=__codelineno-70-2 href=#__codelineno-70-2></a>
<a id=__codelineno-70-3 name=__codelineno-70-3 href=#__codelineno-70-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-70-4 name=__codelineno-70-4 href=#__codelineno-70-4></a>
<a id=__codelineno-70-5 name=__codelineno-70-5 href=#__codelineno-70-5></a><span class=nv>$id</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>minimum</span><span class=p>(</span>
<a id=__codelineno-70-6 name=__codelineno-70-6 href=#__codelineno-70-6></a>    <span class=p>[</span>
<a id=__codelineno-70-7 name=__codelineno-70-7 href=#__codelineno-70-7></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-70-8 name=__codelineno-70-8 href=#__codelineno-70-8></a>    <span class=p>]</span>
<a id=__codelineno-70-9 name=__codelineno-70-9 href=#__codelineno-70-9></a><span class=p>);</span>
<a id=__codelineno-70-10 name=__codelineno-70-10 href=#__codelineno-70-10></a>
<a id=__codelineno-70-11 name=__codelineno-70-11 href=#__codelineno-70-11></a><span class=k>echo</span> <span class=s1>&#39;MIN: &#39;</span><span class=p>,</span> <span class=nv>$id</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-70-12 name=__codelineno-70-12 href=#__codelineno-70-12></a>
<a id=__codelineno-70-13 name=__codelineno-70-13 href=#__codelineno-70-13></a><span class=nv>$max</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>minimum</span><span class=p>(</span>
<a id=__codelineno-70-14 name=__codelineno-70-14 href=#__codelineno-70-14></a>    <span class=p>[</span>
<a id=__codelineno-70-15 name=__codelineno-70-15 href=#__codelineno-70-15></a>        <span class=s1>&#39;inv_cst_id = 1&#39;</span><span class=p>,</span>
<a id=__codelineno-70-16 name=__codelineno-70-16 href=#__codelineno-70-16></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-70-17 name=__codelineno-70-17 href=#__codelineno-70-17></a>    <span class=p>]</span>
<a id=__codelineno-70-18 name=__codelineno-70-18 href=#__codelineno-70-18></a><span class=p>);</span>
<a id=__codelineno-70-19 name=__codelineno-70-19 href=#__codelineno-70-19></a>
<a id=__codelineno-70-20 name=__codelineno-70-20 href=#__codelineno-70-20></a><span class=k>echo</span> <span class=s1>&#39;MIN [Customer: 1] &#39;</span><span class=p>,</span> <span class=nv>$max</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>query</span><span class=p>(</span>
<a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a>    <span class=nx>DiInterface</span> <span class=nv>$container</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-71-3 name=__codelineno-71-3 href=#__codelineno-71-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>CriteriaInterface</span>
</code></pre></div> Create criteria for a specific model</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>readAttribute</span><span class=p>(</span>
<a id=__codelineno-72-2 name=__codelineno-72-2 href=#__codelineno-72-2></a>    <span class=nx>string</span> <span class=nv>$attribute</span>
<a id=__codelineno-72-3 name=__codelineno-72-3 href=#__codelineno-72-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>mixed</span> <span class=o>|</span> <span class=k>null</span>
</code></pre></div> Reads an attribute value by its name</p> <div class=highlight><pre><span></span><code><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a><span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>readAttribute</span><span class=p>(</span><span class=s1>&#39;inv_title&#39;</span><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>refresh</span><span class=p>()</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Refreshes the model attributes re-querying the record from the database</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>save</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Inserts or updates a model instance. Returning <code>true</code> on success or <code>false</code> otherwise.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-76-2 name=__codelineno-76-2 href=#__codelineno-76-2></a>
<a id=__codelineno-76-3 name=__codelineno-76-3 href=#__codelineno-76-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-76-4 name=__codelineno-76-4 href=#__codelineno-76-4></a>
<a id=__codelineno-76-5 name=__codelineno-76-5 href=#__codelineno-76-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-76-6 name=__codelineno-76-6 href=#__codelineno-76-6></a>
<a id=__codelineno-76-7 name=__codelineno-76-7 href=#__codelineno-76-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-76-8 name=__codelineno-76-8 href=#__codelineno-76-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-76-9 name=__codelineno-76-9 href=#__codelineno-76-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-76-10 name=__codelineno-76-10 href=#__codelineno-76-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-76-11 name=__codelineno-76-11 href=#__codelineno-76-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-76-12 name=__codelineno-76-12 href=#__codelineno-76-12></a>
<a id=__codelineno-76-13 name=__codelineno-76-13 href=#__codelineno-76-13></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-76-14 name=__codelineno-76-14 href=#__codelineno-76-14></a>
<a id=__codelineno-76-15 name=__codelineno-76-15 href=#__codelineno-76-15></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 100&#39;</span><span class=p>);</span>
<a id=__codelineno-76-16 name=__codelineno-76-16 href=#__codelineno-76-16></a>
<a id=__codelineno-76-17 name=__codelineno-76-17 href=#__codelineno-76-17></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
<a id=__codelineno-76-18 name=__codelineno-76-18 href=#__codelineno-76-18></a>
<a id=__codelineno-76-19 name=__codelineno-76-19 href=#__codelineno-76-19></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p><code>save()</code> no longer accepts parameters to set data. You can use <code>assign</code> instead.</p> </div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>serialize</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
</code></pre></div> Serializes the object ignoring connections, services, related objects or static properties</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>unserialize</span><span class=p>(</span><span class=nx>mixed</span> <span class=nv>$data</span><span class=p>)</span>
</code></pre></div> Unserializes the object from a serialized string</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-79-1 name=__codelineno-79-1 href=#__codelineno-79-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>setConnectionService</span><span class=p>(</span>
<a id=__codelineno-79-2 name=__codelineno-79-2 href=#__codelineno-79-2></a>    <span class=nx>string</span> <span class=nv>$connectionService</span>
<a id=__codelineno-79-3 name=__codelineno-79-3 href=#__codelineno-79-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets the DependencyInjection connection service name</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-80-1 name=__codelineno-80-1 href=#__codelineno-80-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>setDirtyState</span><span class=p>(</span>
<a id=__codelineno-80-2 name=__codelineno-80-2 href=#__codelineno-80-2></a>    <span class=nx>int</span> <span class=nv>$dirtyState</span>
<a id=__codelineno-80-3 name=__codelineno-80-3 href=#__codelineno-80-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span> <span class=o>|</span> <span class=nx>bool</span>
</code></pre></div> Sets the dirty state of the object using one of the <code>DIRTY_STATE_*</code> constants</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-81-1 name=__codelineno-81-1 href=#__codelineno-81-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>setEventsManager</span><span class=p>(</span>
<a id=__codelineno-81-2 name=__codelineno-81-2 href=#__codelineno-81-2></a>    <span class=nx>EventsManagerInterface</span> <span class=nv>$eventsManager</span>
<a id=__codelineno-81-3 name=__codelineno-81-3 href=#__codelineno-81-3></a><span class=p>)</span>
</code></pre></div> Sets a custom events manager</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-82-1 name=__codelineno-82-1 href=#__codelineno-82-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>setReadConnectionService</span><span class=p>(</span>
<a id=__codelineno-82-2 name=__codelineno-82-2 href=#__codelineno-82-2></a>    <span class=nx>string</span> <span class=nv>$connectionService</span>
<a id=__codelineno-82-3 name=__codelineno-82-3 href=#__codelineno-82-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets the DependencyInjection connection service name used to read data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-83-1 name=__codelineno-83-1 href=#__codelineno-83-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>setOldSnapshotData</span><span class=p>(</span>
<a id=__codelineno-83-2 name=__codelineno-83-2 href=#__codelineno-83-2></a>    <span class=k>array</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-83-3 name=__codelineno-83-3 href=#__codelineno-83-3></a>    <span class=k>array</span> <span class=nv>$columnMap</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-83-4 name=__codelineno-83-4 href=#__codelineno-83-4></a><span class=p>)</span>
</code></pre></div> Sets the record's old snapshot data. This method is used internally to set old snapshot data when the model was set up to keep snapshot data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-84-1 name=__codelineno-84-1 href=#__codelineno-84-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>setSnapshotData</span><span class=p>(</span>
<a id=__codelineno-84-2 name=__codelineno-84-2 href=#__codelineno-84-2></a>    <span class=k>array</span> <span class=nv>$data</span><span class=p>,</span> 
<a id=__codelineno-84-3 name=__codelineno-84-3 href=#__codelineno-84-3></a>    <span class=k>array</span> <span class=nv>$columnMap</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-84-4 name=__codelineno-84-4 href=#__codelineno-84-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets the record's snapshot data. This method is used internally to set snapshot data when the model was set up to keep snapshot data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-85-1 name=__codelineno-85-1 href=#__codelineno-85-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>setTransaction</span><span class=p>(</span>
<a id=__codelineno-85-2 name=__codelineno-85-2 href=#__codelineno-85-2></a>    <span class=nx>TransactionInterface</span> <span class=nv>$transaction</span>
<a id=__codelineno-85-3 name=__codelineno-85-3 href=#__codelineno-85-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Sets a transaction related to the Model instance</p> <div class=highlight><pre><span></span><code><a id=__codelineno-86-1 name=__codelineno-86-1 href=#__codelineno-86-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-86-2 name=__codelineno-86-2 href=#__codelineno-86-2></a>
<a id=__codelineno-86-3 name=__codelineno-86-3 href=#__codelineno-86-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-86-4 name=__codelineno-86-4 href=#__codelineno-86-4></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-86-5 name=__codelineno-86-5 href=#__codelineno-86-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Manager</span><span class=p>;</span>
<a id=__codelineno-86-6 name=__codelineno-86-6 href=#__codelineno-86-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Failed</span><span class=p>;</span>
<a id=__codelineno-86-7 name=__codelineno-86-7 href=#__codelineno-86-7></a>
<a id=__codelineno-86-8 name=__codelineno-86-8 href=#__codelineno-86-8></a><span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-86-9 name=__codelineno-86-9 href=#__codelineno-86-9></a>    <span class=nv>$txManager</span>   <span class=o>=</span> <span class=k>new</span> <span class=nx>Manager</span><span class=p>();</span>
<a id=__codelineno-86-10 name=__codelineno-86-10 href=#__codelineno-86-10></a>    <span class=nv>$transaction</span> <span class=o>=</span> <span class=nv>$txManager</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
<a id=__codelineno-86-11 name=__codelineno-86-11 href=#__codelineno-86-11></a>
<a id=__codelineno-86-12 name=__codelineno-86-12 href=#__codelineno-86-12></a>    <span class=nv>$customer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Customers</span><span class=p>();</span>
<a id=__codelineno-86-13 name=__codelineno-86-13 href=#__codelineno-86-13></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-86-14 name=__codelineno-86-14 href=#__codelineno-86-14></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_last</span>  <span class=o>=</span> <span class=s1>&#39;Vader&#39;</span><span class=p>;</span>
<a id=__codelineno-86-15 name=__codelineno-86-15 href=#__codelineno-86-15></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_first</span> <span class=o>=</span> <span class=s1>&#39;Darth&#39;</span><span class=p>;</span>
<a id=__codelineno-86-16 name=__codelineno-86-16 href=#__codelineno-86-16></a>
<a id=__codelineno-86-17 name=__codelineno-86-17 href=#__codelineno-86-17></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-86-18 name=__codelineno-86-18 href=#__codelineno-86-18></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save Customer&#39;</span><span class=p>);</span>
<a id=__codelineno-86-19 name=__codelineno-86-19 href=#__codelineno-86-19></a>    <span class=p>}</span>
<a id=__codelineno-86-20 name=__codelineno-86-20 href=#__codelineno-86-20></a>
<a id=__codelineno-86-21 name=__codelineno-86-21 href=#__codelineno-86-21></a>    <span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-86-22 name=__codelineno-86-22 href=#__codelineno-86-22></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-86-23 name=__codelineno-86-23 href=#__codelineno-86-23></a>
<a id=__codelineno-86-24 name=__codelineno-86-24 href=#__codelineno-86-24></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_id</span><span class=p>;</span>
<a id=__codelineno-86-25 name=__codelineno-86-25 href=#__codelineno-86-25></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-86-26 name=__codelineno-86-26 href=#__codelineno-86-26></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-86-27 name=__codelineno-86-27 href=#__codelineno-86-27></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-86-28 name=__codelineno-86-28 href=#__codelineno-86-28></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-86-29 name=__codelineno-86-29 href=#__codelineno-86-29></a>
<a id=__codelineno-86-30 name=__codelineno-86-30 href=#__codelineno-86-30></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-86-31 name=__codelineno-86-31 href=#__codelineno-86-31></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save record&#39;</span><span class=p>);</span>
<a id=__codelineno-86-32 name=__codelineno-86-32 href=#__codelineno-86-32></a>    <span class=p>}</span>
<a id=__codelineno-86-33 name=__codelineno-86-33 href=#__codelineno-86-33></a>
<a id=__codelineno-86-34 name=__codelineno-86-34 href=#__codelineno-86-34></a>    <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-86-35 name=__codelineno-86-35 href=#__codelineno-86-35></a><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Failed</span> <span class=nv>$ex</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-86-36 name=__codelineno-86-36 href=#__codelineno-86-36></a>    <span class=k>echo</span> <span class=s1>&#39;ERROR: &#39;</span><span class=p>,</span> <span class=nv>$ex</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>();</span>
<a id=__codelineno-86-37 name=__codelineno-86-37 href=#__codelineno-86-37></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-87-1 name=__codelineno-87-1 href=#__codelineno-87-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>setup</span><span class=p>(</span>
<a id=__codelineno-87-2 name=__codelineno-87-2 href=#__codelineno-87-2></a>    <span class=k>array</span> <span class=nv>$options</span>
<a id=__codelineno-87-3 name=__codelineno-87-3 href=#__codelineno-87-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Enables/disables options in the ORM such as events, column renaming, etc.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-88-1 name=__codelineno-88-1 href=#__codelineno-88-1></a><span class=k>final</span> <span class=k>public</span> <span class=k>function</span> <span class=nf>setWriteConnectionService</span><span class=p>(</span>
<a id=__codelineno-88-2 name=__codelineno-88-2 href=#__codelineno-88-2></a>    <span class=nx>string</span> <span class=nv>$connectionService</span>
<a id=__codelineno-88-3 name=__codelineno-88-3 href=#__codelineno-88-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets the DependencyInjection connection service name used to write data</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-89-1 name=__codelineno-89-1 href=#__codelineno-89-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>skipOperation</span><span class=p>(</span><span class=nx>bool</span> <span class=nv>$skip</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Skips the current operation forcing a success state</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-90-1 name=__codelineno-90-1 href=#__codelineno-90-1></a><span class=k>public</span> <span class=k>static</span> <span class=k>function</span> <span class=nf>sum</span><span class=p>(</span>
<a id=__codelineno-90-2 name=__codelineno-90-2 href=#__codelineno-90-2></a>    <span class=k>array</span> <span class=nv>$parameters</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-90-3 name=__codelineno-90-3 href=#__codelineno-90-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>float</span>
</code></pre></div> Calculates the sum on a column for a result-set of rows that match the specified conditions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-91-1 name=__codelineno-91-1 href=#__codelineno-91-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-91-2 name=__codelineno-91-2 href=#__codelineno-91-2></a>
<a id=__codelineno-91-3 name=__codelineno-91-3 href=#__codelineno-91-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-91-4 name=__codelineno-91-4 href=#__codelineno-91-4></a>
<a id=__codelineno-91-5 name=__codelineno-91-5 href=#__codelineno-91-5></a><span class=nv>$total</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-91-6 name=__codelineno-91-6 href=#__codelineno-91-6></a>    <span class=p>[</span>
<a id=__codelineno-91-7 name=__codelineno-91-7 href=#__codelineno-91-7></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-91-8 name=__codelineno-91-8 href=#__codelineno-91-8></a>    <span class=p>]</span>
<a id=__codelineno-91-9 name=__codelineno-91-9 href=#__codelineno-91-9></a><span class=p>);</span>
<a id=__codelineno-91-10 name=__codelineno-91-10 href=#__codelineno-91-10></a>
<a id=__codelineno-91-11 name=__codelineno-91-11 href=#__codelineno-91-11></a><span class=k>echo</span> <span class=s1>&#39;SUM: &#39;</span><span class=p>,</span> <span class=nv>$total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-91-12 name=__codelineno-91-12 href=#__codelineno-91-12></a>
<a id=__codelineno-91-13 name=__codelineno-91-13 href=#__codelineno-91-13></a><span class=nv>$total</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-91-14 name=__codelineno-91-14 href=#__codelineno-91-14></a>    <span class=p>[</span>
<a id=__codelineno-91-15 name=__codelineno-91-15 href=#__codelineno-91-15></a>        <span class=s1>&#39;inv_cst_id = 1&#39;</span><span class=p>,</span>
<a id=__codelineno-91-16 name=__codelineno-91-16 href=#__codelineno-91-16></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-91-17 name=__codelineno-91-17 href=#__codelineno-91-17></a>    <span class=p>]</span>
<a id=__codelineno-91-18 name=__codelineno-91-18 href=#__codelineno-91-18></a><span class=p>);</span>
<a id=__codelineno-91-19 name=__codelineno-91-19 href=#__codelineno-91-19></a>
<a id=__codelineno-91-20 name=__codelineno-91-20 href=#__codelineno-91-20></a><span class=k>echo</span> <span class=s1>&#39;SUM [Customer: 1] &#39;</span><span class=p>,</span> <span class=nv>$total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-92-1 name=__codelineno-92-1 href=#__codelineno-92-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>toArray</span><span class=p>(</span>
<a id=__codelineno-92-2 name=__codelineno-92-2 href=#__codelineno-92-2></a>    <span class=k>array</span> <span class=nv>$columns</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-92-3 name=__codelineno-92-3 href=#__codelineno-92-3></a>    <span class=nx>bool</span> <span class=nv>$useGetters</span> <span class=o>=</span> <span class=k>true</span>
<a id=__codelineno-92-4 name=__codelineno-92-4 href=#__codelineno-92-4></a><span class=p>)</span><span class=o>:</span> <span class=k>array</span>
</code></pre></div> Returns the instance as an array representation. Accepts an array with column names to include in the result, it will use getters by default.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-93-1 name=__codelineno-93-1 href=#__codelineno-93-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-93-2 name=__codelineno-93-2 href=#__codelineno-93-2></a>
<a id=__codelineno-93-3 name=__codelineno-93-3 href=#__codelineno-93-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-93-4 name=__codelineno-93-4 href=#__codelineno-93-4></a>
<a id=__codelineno-93-5 name=__codelineno-93-5 href=#__codelineno-93-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 4&#39;</span><span class=p>);</span>
<a id=__codelineno-93-6 name=__codelineno-93-6 href=#__codelineno-93-6></a>
<a id=__codelineno-93-7 name=__codelineno-93-7 href=#__codelineno-93-7></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-93-8 name=__codelineno-93-8 href=#__codelineno-93-8></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>()</span>
<a id=__codelineno-93-9 name=__codelineno-93-9 href=#__codelineno-93-9></a><span class=p>);</span>
<a id=__codelineno-93-10 name=__codelineno-93-10 href=#__codelineno-93-10></a>
<a id=__codelineno-93-11 name=__codelineno-93-11 href=#__codelineno-93-11></a><span class=c1>//  [</span>
<a id=__codelineno-93-12 name=__codelineno-93-12 href=#__codelineno-93-12></a><span class=c1>//      &#39;inv_id&#39;          =&gt; 4,</span>
<a id=__codelineno-93-13 name=__codelineno-93-13 href=#__codelineno-93-13></a><span class=c1>//      &#39;inv_cst_id&#39;      = $customer-&gt;cst_id,</span>
<a id=__codelineno-93-14 name=__codelineno-93-14 href=#__codelineno-93-14></a><span class=c1>//      &#39;inv_status_flag&#39; = 1,</span>
<a id=__codelineno-93-15 name=__codelineno-93-15 href=#__codelineno-93-15></a><span class=c1>//      &#39;inv_title&#39;       = &#39;Invoice for ACME Inc.&#39;,</span>
<a id=__codelineno-93-16 name=__codelineno-93-16 href=#__codelineno-93-16></a><span class=c1>//      &#39;inv_total&#39;       = 100,</span>
<a id=__codelineno-93-17 name=__codelineno-93-17 href=#__codelineno-93-17></a><span class=c1>//      &#39;inv_created_at&#39;  = &#39;2019-12-25 01:02:03&#39;,</span>
<a id=__codelineno-93-18 name=__codelineno-93-18 href=#__codelineno-93-18></a><span class=c1>//  ]</span>
<a id=__codelineno-93-19 name=__codelineno-93-19 href=#__codelineno-93-19></a>
<a id=__codelineno-93-20 name=__codelineno-93-20 href=#__codelineno-93-20></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-93-21 name=__codelineno-93-21 href=#__codelineno-93-21></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>(</span>
<a id=__codelineno-93-22 name=__codelineno-93-22 href=#__codelineno-93-22></a>        <span class=p>[</span>
<a id=__codelineno-93-23 name=__codelineno-93-23 href=#__codelineno-93-23></a>            <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-93-24 name=__codelineno-93-24 href=#__codelineno-93-24></a>            <span class=s1>&#39;inv_title&#39;</span><span class=p>,</span>
<a id=__codelineno-93-25 name=__codelineno-93-25 href=#__codelineno-93-25></a>            <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-93-26 name=__codelineno-93-26 href=#__codelineno-93-26></a>        <span class=p>]</span>
<a id=__codelineno-93-27 name=__codelineno-93-27 href=#__codelineno-93-27></a>    <span class=p>)</span>
<a id=__codelineno-93-28 name=__codelineno-93-28 href=#__codelineno-93-28></a><span class=p>);</span>
<a id=__codelineno-93-29 name=__codelineno-93-29 href=#__codelineno-93-29></a>
<a id=__codelineno-93-30 name=__codelineno-93-30 href=#__codelineno-93-30></a><span class=c1>//  [</span>
<a id=__codelineno-93-31 name=__codelineno-93-31 href=#__codelineno-93-31></a><span class=c1>//      &#39;inv_status_flag&#39; = 1,</span>
<a id=__codelineno-93-32 name=__codelineno-93-32 href=#__codelineno-93-32></a><span class=c1>//      &#39;inv_title&#39;       = &#39;Invoice for ACME Inc.&#39;,</span>
<a id=__codelineno-93-33 name=__codelineno-93-33 href=#__codelineno-93-33></a><span class=c1>//      &#39;inv_total&#39;       = 100,</span>
<a id=__codelineno-93-34 name=__codelineno-93-34 href=#__codelineno-93-34></a><span class=c1>//  ]</span>
</code></pre></div> <p><code>toArray</code> uses getters by default, to disable this behavior, set <code>$useGetters</code> to <code>false</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-94-1 name=__codelineno-94-1 href=#__codelineno-94-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-94-2 name=__codelineno-94-2 href=#__codelineno-94-2></a>
<a id=__codelineno-94-3 name=__codelineno-94-3 href=#__codelineno-94-3></a><span class=k>use</span> <span class=nx>MyApp\Models\InvoicesGetters</span><span class=p>;</span>
<a id=__codelineno-94-4 name=__codelineno-94-4 href=#__codelineno-94-4></a>
<a id=__codelineno-94-5 name=__codelineno-94-5 href=#__codelineno-94-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>InvoicesGetters</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 4&#39;</span><span class=p>);</span>
<a id=__codelineno-94-6 name=__codelineno-94-6 href=#__codelineno-94-6></a>
<a id=__codelineno-94-7 name=__codelineno-94-7 href=#__codelineno-94-7></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-94-8 name=__codelineno-94-8 href=#__codelineno-94-8></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>
<a id=__codelineno-94-9 name=__codelineno-94-9 href=#__codelineno-94-9></a><span class=p>);</span>
<a id=__codelineno-94-10 name=__codelineno-94-10 href=#__codelineno-94-10></a>
<a id=__codelineno-94-11 name=__codelineno-94-11 href=#__codelineno-94-11></a><span class=c1>// &#39;Invoice for ACME Inc.&#39;</span>
<a id=__codelineno-94-12 name=__codelineno-94-12 href=#__codelineno-94-12></a>
<a id=__codelineno-94-13 name=__codelineno-94-13 href=#__codelineno-94-13></a>
<a id=__codelineno-94-14 name=__codelineno-94-14 href=#__codelineno-94-14></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-94-15 name=__codelineno-94-15 href=#__codelineno-94-15></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getInvTitle</span><span class=p>()</span>
<a id=__codelineno-94-16 name=__codelineno-94-16 href=#__codelineno-94-16></a><span class=p>);</span>
<a id=__codelineno-94-17 name=__codelineno-94-17 href=#__codelineno-94-17></a>
<a id=__codelineno-94-18 name=__codelineno-94-18 href=#__codelineno-94-18></a><span class=c1>// &#39;Invoice for ACME Inc. - Status 1&#39;</span>
<a id=__codelineno-94-19 name=__codelineno-94-19 href=#__codelineno-94-19></a>
<a id=__codelineno-94-20 name=__codelineno-94-20 href=#__codelineno-94-20></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-94-21 name=__codelineno-94-21 href=#__codelineno-94-21></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>()</span>
<a id=__codelineno-94-22 name=__codelineno-94-22 href=#__codelineno-94-22></a><span class=p>);</span>
<a id=__codelineno-94-23 name=__codelineno-94-23 href=#__codelineno-94-23></a>
<a id=__codelineno-94-24 name=__codelineno-94-24 href=#__codelineno-94-24></a><span class=c1>//  [</span>
<a id=__codelineno-94-25 name=__codelineno-94-25 href=#__codelineno-94-25></a><span class=c1>//      &#39;inv_id&#39;          =&gt; 4,</span>
<a id=__codelineno-94-26 name=__codelineno-94-26 href=#__codelineno-94-26></a><span class=c1>//      &#39;inv_cst_id&#39;      = $customer-&gt;cst_id,</span>
<a id=__codelineno-94-27 name=__codelineno-94-27 href=#__codelineno-94-27></a><span class=c1>//      &#39;inv_status_flag&#39; = 1,</span>
<a id=__codelineno-94-28 name=__codelineno-94-28 href=#__codelineno-94-28></a><span class=c1>//      &#39;inv_title&#39;       = &#39;Invoice for ACME Inc. - Status 1&#39; ,</span>
<a id=__codelineno-94-29 name=__codelineno-94-29 href=#__codelineno-94-29></a><span class=c1>//      &#39;inv_total&#39;       = 100,</span>
<a id=__codelineno-94-30 name=__codelineno-94-30 href=#__codelineno-94-30></a><span class=c1>//      &#39;inv_created_at&#39;  = &#39;2019-12-25 01:02:03&#39;,</span>
<a id=__codelineno-94-31 name=__codelineno-94-31 href=#__codelineno-94-31></a><span class=c1>//  ]</span>
<a id=__codelineno-94-32 name=__codelineno-94-32 href=#__codelineno-94-32></a>
<a id=__codelineno-94-33 name=__codelineno-94-33 href=#__codelineno-94-33></a><span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-94-34 name=__codelineno-94-34 href=#__codelineno-94-34></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>toArray</span><span class=p>(</span>
<a id=__codelineno-94-35 name=__codelineno-94-35 href=#__codelineno-94-35></a>        <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-94-36 name=__codelineno-94-36 href=#__codelineno-94-36></a>        <span class=k>false</span>
<a id=__codelineno-94-37 name=__codelineno-94-37 href=#__codelineno-94-37></a>    <span class=p>)</span>
<a id=__codelineno-94-38 name=__codelineno-94-38 href=#__codelineno-94-38></a><span class=p>);</span>
<a id=__codelineno-94-39 name=__codelineno-94-39 href=#__codelineno-94-39></a>
<a id=__codelineno-94-40 name=__codelineno-94-40 href=#__codelineno-94-40></a>
<a id=__codelineno-94-41 name=__codelineno-94-41 href=#__codelineno-94-41></a><span class=c1>//  [</span>
<a id=__codelineno-94-42 name=__codelineno-94-42 href=#__codelineno-94-42></a><span class=c1>//      &#39;inv_id&#39;          =&gt; 4,</span>
<a id=__codelineno-94-43 name=__codelineno-94-43 href=#__codelineno-94-43></a><span class=c1>//      &#39;inv_cst_id&#39;      = $customer-&gt;cst_id,</span>
<a id=__codelineno-94-44 name=__codelineno-94-44 href=#__codelineno-94-44></a><span class=c1>//      &#39;inv_status_flag&#39; = 1,</span>
<a id=__codelineno-94-45 name=__codelineno-94-45 href=#__codelineno-94-45></a><span class=c1>//      &#39;inv_title&#39;       = &#39;Invoice for ACME Inc.&#39; ,</span>
<a id=__codelineno-94-46 name=__codelineno-94-46 href=#__codelineno-94-46></a><span class=c1>//      &#39;inv_total&#39;       = 100,</span>
<a id=__codelineno-94-47 name=__codelineno-94-47 href=#__codelineno-94-47></a><span class=c1>//      &#39;inv_created_at&#39;  = &#39;2019-12-25 01:02:03&#39;,</span>
<a id=__codelineno-94-48 name=__codelineno-94-48 href=#__codelineno-94-48></a><span class=c1>//  ]</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-95-1 name=__codelineno-95-1 href=#__codelineno-95-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>update</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Updates a model instance. If the instance doesn't exist in the persistence it will throw an exception. Returning <code>true</code> on success or <code>false</code> otherwise.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-96-1 name=__codelineno-96-1 href=#__codelineno-96-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-96-2 name=__codelineno-96-2 href=#__codelineno-96-2></a>
<a id=__codelineno-96-3 name=__codelineno-96-3 href=#__codelineno-96-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-96-4 name=__codelineno-96-4 href=#__codelineno-96-4></a>
<a id=__codelineno-96-5 name=__codelineno-96-5 href=#__codelineno-96-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 4&#39;</span><span class=p>);</span>
<a id=__codelineno-96-6 name=__codelineno-96-6 href=#__codelineno-96-6></a>
<a id=__codelineno-96-7 name=__codelineno-96-7 href=#__codelineno-96-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
<a id=__codelineno-96-8 name=__codelineno-96-8 href=#__codelineno-96-8></a>
<a id=__codelineno-96-9 name=__codelineno-96-9 href=#__codelineno-96-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>();</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>When retrieving the record with <code>findFirst()</code>, you need to get the full object back (no <code>columns</code> definition) but also retrieve it using the primary key. If not, the ORM will issue an <code>INSERT</code> instead of <code>UPDATE</code>.</p> </div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-97-1 name=__codelineno-97-1 href=#__codelineno-97-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>writeAttribute</span><span class=p>(</span>
<a id=__codelineno-97-2 name=__codelineno-97-2 href=#__codelineno-97-2></a>    <span class=nx>string</span> <span class=nv>$attribute</span><span class=p>,</span> 
<a id=__codelineno-97-3 name=__codelineno-97-3 href=#__codelineno-97-3></a>    <span class=nx>mixed</span> <span class=nv>$value</span>
<a id=__codelineno-97-4 name=__codelineno-97-4 href=#__codelineno-97-4></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Writes an attribute value by its name</p> <div class=highlight><pre><span></span><code><a id=__codelineno-98-1 name=__codelineno-98-1 href=#__codelineno-98-1></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>writeAttribute</span><span class=p>(</span><span class=s1>&#39;inv_total&#39;</span><span class=p>,</span> <span class=mi>120</span><span class=p>);</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-99-1 name=__codelineno-99-1 href=#__codelineno-99-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>allowEmptyStringValues</span><span class=p>(</span>
<a id=__codelineno-99-2 name=__codelineno-99-2 href=#__codelineno-99-2></a>    <span class=k>array</span> <span class=nv>$attributes</span>
<a id=__codelineno-99-3 name=__codelineno-99-3 href=#__codelineno-99-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets a list of attributes that must be skipped from the generated <code>UPDATE</code> statement</p> <div class=highlight><pre><span></span><code><a id=__codelineno-100-1 name=__codelineno-100-1 href=#__codelineno-100-1></a><span class=o>&lt;?</span><span class=nx>php</span> 
<a id=__codelineno-100-2 name=__codelineno-100-2 href=#__codelineno-100-2></a>
<a id=__codelineno-100-3 name=__codelineno-100-3 href=#__codelineno-100-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-100-4 name=__codelineno-100-4 href=#__codelineno-100-4></a>
<a id=__codelineno-100-5 name=__codelineno-100-5 href=#__codelineno-100-5></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-100-6 name=__codelineno-100-6 href=#__codelineno-100-6></a><span class=p>{</span>
<a id=__codelineno-100-7 name=__codelineno-100-7 href=#__codelineno-100-7></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-100-8 name=__codelineno-100-8 href=#__codelineno-100-8></a>    <span class=p>{</span>
<a id=__codelineno-100-9 name=__codelineno-100-9 href=#__codelineno-100-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>allowEmptyStringValues</span><span class=p>(</span>
<a id=__codelineno-100-10 name=__codelineno-100-10 href=#__codelineno-100-10></a>            <span class=p>[</span>
<a id=__codelineno-100-11 name=__codelineno-100-11 href=#__codelineno-100-11></a>                <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-100-12 name=__codelineno-100-12 href=#__codelineno-100-12></a>            <span class=p>]</span>
<a id=__codelineno-100-13 name=__codelineno-100-13 href=#__codelineno-100-13></a>        <span class=p>);</span>
<a id=__codelineno-100-14 name=__codelineno-100-14 href=#__codelineno-100-14></a>    <span class=p>}</span>
<a id=__codelineno-100-15 name=__codelineno-100-15 href=#__codelineno-100-15></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-101-1 name=__codelineno-101-1 href=#__codelineno-101-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>belongsTo</span><span class=p>(</span>
<a id=__codelineno-101-2 name=__codelineno-101-2 href=#__codelineno-101-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fields</span><span class=p>,</span> 
<a id=__codelineno-101-3 name=__codelineno-101-3 href=#__codelineno-101-3></a>    <span class=nx>string</span> <span class=nv>$referenceModel</span><span class=p>,</span> 
<a id=__codelineno-101-4 name=__codelineno-101-4 href=#__codelineno-101-4></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$referencedFields</span><span class=p>,</span> 
<a id=__codelineno-101-5 name=__codelineno-101-5 href=#__codelineno-101-5></a>    <span class=k>array</span> <span class=nx>options</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-101-6 name=__codelineno-101-6 href=#__codelineno-101-6></a><span class=p>)</span><span class=o>:</span> <span class=nx>Relation</span>
</code></pre></div> Set up a reverse 1-1 or n-1 relation between two models</p> <div class=highlight><pre><span></span><code><a id=__codelineno-102-1 name=__codelineno-102-1 href=#__codelineno-102-1></a><span class=o>&lt;?</span><span class=nx>php</span> 
<a id=__codelineno-102-2 name=__codelineno-102-2 href=#__codelineno-102-2></a>
<a id=__codelineno-102-3 name=__codelineno-102-3 href=#__codelineno-102-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-102-4 name=__codelineno-102-4 href=#__codelineno-102-4></a>
<a id=__codelineno-102-5 name=__codelineno-102-5 href=#__codelineno-102-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-102-6 name=__codelineno-102-6 href=#__codelineno-102-6></a>
<a id=__codelineno-102-7 name=__codelineno-102-7 href=#__codelineno-102-7></a><span class=k>class</span> <span class=nc>InvoicesXProducts</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-102-8 name=__codelineno-102-8 href=#__codelineno-102-8></a><span class=p>{</span>
<a id=__codelineno-102-9 name=__codelineno-102-9 href=#__codelineno-102-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-102-10 name=__codelineno-102-10 href=#__codelineno-102-10></a>    <span class=p>{</span>
<a id=__codelineno-102-11 name=__codelineno-102-11 href=#__codelineno-102-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsTo</span><span class=p>(</span>
<a id=__codelineno-102-12 name=__codelineno-102-12 href=#__codelineno-102-12></a>            <span class=s1>&#39;ixp_inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-102-13 name=__codelineno-102-13 href=#__codelineno-102-13></a>            <span class=nx>Invoices</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<a id=__codelineno-102-14 name=__codelineno-102-14 href=#__codelineno-102-14></a>            <span class=s1>&#39;inv_id&#39;</span>
<a id=__codelineno-102-15 name=__codelineno-102-15 href=#__codelineno-102-15></a>        <span class=p>);</span>
<a id=__codelineno-102-16 name=__codelineno-102-16 href=#__codelineno-102-16></a>    <span class=p>}</span>
<a id=__codelineno-102-17 name=__codelineno-102-17 href=#__codelineno-102-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-103-1 name=__codelineno-103-1 href=#__codelineno-103-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>hasMany</span><span class=p>(</span>
<a id=__codelineno-103-2 name=__codelineno-103-2 href=#__codelineno-103-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fields</span><span class=p>,</span> 
<a id=__codelineno-103-3 name=__codelineno-103-3 href=#__codelineno-103-3></a>    <span class=nx>string</span> <span class=nv>$referenceModel</span><span class=p>,</span> 
<a id=__codelineno-103-4 name=__codelineno-103-4 href=#__codelineno-103-4></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$referencedFields</span><span class=p>,</span> 
<a id=__codelineno-103-5 name=__codelineno-103-5 href=#__codelineno-103-5></a>    <span class=k>array</span> <span class=nx>options</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-103-6 name=__codelineno-103-6 href=#__codelineno-103-6></a><span class=p>)</span><span class=o>:</span> <span class=nx>Relation</span>
</code></pre></div> Setup a 1-n relation between two models</p> <div class=highlight><pre><span></span><code><a id=__codelineno-104-1 name=__codelineno-104-1 href=#__codelineno-104-1></a><span class=o>&lt;?</span><span class=nx>php</span> 
<a id=__codelineno-104-2 name=__codelineno-104-2 href=#__codelineno-104-2></a>
<a id=__codelineno-104-3 name=__codelineno-104-3 href=#__codelineno-104-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-104-4 name=__codelineno-104-4 href=#__codelineno-104-4></a>
<a id=__codelineno-104-5 name=__codelineno-104-5 href=#__codelineno-104-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-104-6 name=__codelineno-104-6 href=#__codelineno-104-6></a>
<a id=__codelineno-104-7 name=__codelineno-104-7 href=#__codelineno-104-7></a><span class=k>class</span> <span class=nc>Customers</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-104-8 name=__codelineno-104-8 href=#__codelineno-104-8></a><span class=p>{</span>
<a id=__codelineno-104-9 name=__codelineno-104-9 href=#__codelineno-104-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-104-10 name=__codelineno-104-10 href=#__codelineno-104-10></a>    <span class=p>{</span>
<a id=__codelineno-104-11 name=__codelineno-104-11 href=#__codelineno-104-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>hasMany</span><span class=p>(</span>
<a id=__codelineno-104-12 name=__codelineno-104-12 href=#__codelineno-104-12></a>            <span class=s1>&#39;cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-104-13 name=__codelineno-104-13 href=#__codelineno-104-13></a>            <span class=nx>Invoices</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<a id=__codelineno-104-14 name=__codelineno-104-14 href=#__codelineno-104-14></a>            <span class=s1>&#39;inv_cst_id&#39;</span>
<a id=__codelineno-104-15 name=__codelineno-104-15 href=#__codelineno-104-15></a>        <span class=p>);</span>
<a id=__codelineno-104-16 name=__codelineno-104-16 href=#__codelineno-104-16></a>    <span class=p>}</span>
<a id=__codelineno-104-17 name=__codelineno-104-17 href=#__codelineno-104-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-105-1 name=__codelineno-105-1 href=#__codelineno-105-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>hasManyToMany</span><span class=p>(</span>
<a id=__codelineno-105-2 name=__codelineno-105-2 href=#__codelineno-105-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fields</span><span class=p>,</span>
<a id=__codelineno-105-3 name=__codelineno-105-3 href=#__codelineno-105-3></a>    <span class=nx>string</span> <span class=nv>$intermediateModel</span><span class=p>,</span> 
<a id=__codelineno-105-4 name=__codelineno-105-4 href=#__codelineno-105-4></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$intermediateFields</span><span class=p>,</span>
<a id=__codelineno-105-5 name=__codelineno-105-5 href=#__codelineno-105-5></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$intermediateReferencedFields</span><span class=p>,</span>
<a id=__codelineno-105-6 name=__codelineno-105-6 href=#__codelineno-105-6></a>    <span class=nx>string</span> <span class=nv>$referenceModel</span><span class=p>,</span> 
<a id=__codelineno-105-7 name=__codelineno-105-7 href=#__codelineno-105-7></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$referencedFields</span><span class=p>,</span>
<a id=__codelineno-105-8 name=__codelineno-105-8 href=#__codelineno-105-8></a>    <span class=k>array</span> <span class=nv>$options</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-105-9 name=__codelineno-105-9 href=#__codelineno-105-9></a><span class=p>)</span><span class=o>:</span> <span class=nx>Relation</span>
</code></pre></div> Set up an n-n relation between two models, through an intermediate relation</p> <div class=highlight><pre><span></span><code><a id=__codelineno-106-1 name=__codelineno-106-1 href=#__codelineno-106-1></a><span class=o>&lt;?</span><span class=nx>php</span> 
<a id=__codelineno-106-2 name=__codelineno-106-2 href=#__codelineno-106-2></a>
<a id=__codelineno-106-3 name=__codelineno-106-3 href=#__codelineno-106-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-106-4 name=__codelineno-106-4 href=#__codelineno-106-4></a>
<a id=__codelineno-106-5 name=__codelineno-106-5 href=#__codelineno-106-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-106-6 name=__codelineno-106-6 href=#__codelineno-106-6></a>
<a id=__codelineno-106-7 name=__codelineno-106-7 href=#__codelineno-106-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-106-8 name=__codelineno-106-8 href=#__codelineno-106-8></a><span class=p>{</span>
<a id=__codelineno-106-9 name=__codelineno-106-9 href=#__codelineno-106-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-106-10 name=__codelineno-106-10 href=#__codelineno-106-10></a>    <span class=p>{</span>
<a id=__codelineno-106-11 name=__codelineno-106-11 href=#__codelineno-106-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>hasManyToMany</span><span class=p>(</span>
<a id=__codelineno-106-12 name=__codelineno-106-12 href=#__codelineno-106-12></a>            <span class=s1>&#39;inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-106-13 name=__codelineno-106-13 href=#__codelineno-106-13></a>            <span class=nx>InvoicesXProducts</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<a id=__codelineno-106-14 name=__codelineno-106-14 href=#__codelineno-106-14></a>            <span class=s1>&#39;ixp_inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-106-15 name=__codelineno-106-15 href=#__codelineno-106-15></a>            <span class=s1>&#39;ixp_prd_id&#39;</span><span class=p>,</span>
<a id=__codelineno-106-16 name=__codelineno-106-16 href=#__codelineno-106-16></a>            <span class=nx>Products</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<a id=__codelineno-106-17 name=__codelineno-106-17 href=#__codelineno-106-17></a>            <span class=s1>&#39;prd_id&#39;</span>
<a id=__codelineno-106-18 name=__codelineno-106-18 href=#__codelineno-106-18></a>        <span class=p>);</span>
<a id=__codelineno-106-19 name=__codelineno-106-19 href=#__codelineno-106-19></a>    <span class=p>}</span>
<a id=__codelineno-106-20 name=__codelineno-106-20 href=#__codelineno-106-20></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-107-1 name=__codelineno-107-1 href=#__codelineno-107-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>hasOne</span><span class=p>(</span>
<a id=__codelineno-107-2 name=__codelineno-107-2 href=#__codelineno-107-2></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$fields</span><span class=p>,</span> 
<a id=__codelineno-107-3 name=__codelineno-107-3 href=#__codelineno-107-3></a>    <span class=nx>string</span> <span class=nv>$referenceModel</span><span class=p>,</span> 
<a id=__codelineno-107-4 name=__codelineno-107-4 href=#__codelineno-107-4></a>    <span class=nx>string</span> <span class=o>|</span> <span class=k>array</span> <span class=nv>$referencedFields</span><span class=p>,</span> 
<a id=__codelineno-107-5 name=__codelineno-107-5 href=#__codelineno-107-5></a>    <span class=k>array</span> <span class=nx>options</span> <span class=o>=</span> <span class=k>null</span>
<a id=__codelineno-107-6 name=__codelineno-107-6 href=#__codelineno-107-6></a><span class=p>)</span><span class=o>:</span> <span class=nx>Relation</span>
</code></pre></div> Setup a 1-1 relation between two models</p> <div class=highlight><pre><span></span><code><a id=__codelineno-108-1 name=__codelineno-108-1 href=#__codelineno-108-1></a><span class=o>&lt;?</span><span class=nx>php</span> 
<a id=__codelineno-108-2 name=__codelineno-108-2 href=#__codelineno-108-2></a>
<a id=__codelineno-108-3 name=__codelineno-108-3 href=#__codelineno-108-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-108-4 name=__codelineno-108-4 href=#__codelineno-108-4></a>
<a id=__codelineno-108-5 name=__codelineno-108-5 href=#__codelineno-108-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-108-6 name=__codelineno-108-6 href=#__codelineno-108-6></a>
<a id=__codelineno-108-7 name=__codelineno-108-7 href=#__codelineno-108-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-108-8 name=__codelineno-108-8 href=#__codelineno-108-8></a><span class=p>{</span>
<a id=__codelineno-108-9 name=__codelineno-108-9 href=#__codelineno-108-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-108-10 name=__codelineno-108-10 href=#__codelineno-108-10></a>    <span class=p>{</span>
<a id=__codelineno-108-11 name=__codelineno-108-11 href=#__codelineno-108-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>hasOne</span><span class=p>(</span>
<a id=__codelineno-108-12 name=__codelineno-108-12 href=#__codelineno-108-12></a>            <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-108-13 name=__codelineno-108-13 href=#__codelineno-108-13></a>            <span class=nx>Customers</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<a id=__codelineno-108-14 name=__codelineno-108-14 href=#__codelineno-108-14></a>            <span class=s1>&#39;cst_id&#39;</span>
<a id=__codelineno-108-15 name=__codelineno-108-15 href=#__codelineno-108-15></a>        <span class=p>);</span>
<a id=__codelineno-108-16 name=__codelineno-108-16 href=#__codelineno-108-16></a>    <span class=p>}</span>
<a id=__codelineno-108-17 name=__codelineno-108-17 href=#__codelineno-108-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-109-1 name=__codelineno-109-1 href=#__codelineno-109-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>keepSnapshots</span><span class=p>(</span>
<a id=__codelineno-109-2 name=__codelineno-109-2 href=#__codelineno-109-2></a>    <span class=nx>bool</span> <span class=nv>$keepSnapshot</span>
<a id=__codelineno-109-3 name=__codelineno-109-3 href=#__codelineno-109-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets if the model must keep the original record snapshot in memory</p> <div class=highlight><pre><span></span><code><a id=__codelineno-110-1 name=__codelineno-110-1 href=#__codelineno-110-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-110-2 name=__codelineno-110-2 href=#__codelineno-110-2></a>
<a id=__codelineno-110-3 name=__codelineno-110-3 href=#__codelineno-110-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-110-4 name=__codelineno-110-4 href=#__codelineno-110-4></a>
<a id=__codelineno-110-5 name=__codelineno-110-5 href=#__codelineno-110-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-110-6 name=__codelineno-110-6 href=#__codelineno-110-6></a>
<a id=__codelineno-110-7 name=__codelineno-110-7 href=#__codelineno-110-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-110-8 name=__codelineno-110-8 href=#__codelineno-110-8></a><span class=p>{</span>
<a id=__codelineno-110-9 name=__codelineno-110-9 href=#__codelineno-110-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-110-10 name=__codelineno-110-10 href=#__codelineno-110-10></a>    <span class=p>{</span>
<a id=__codelineno-110-11 name=__codelineno-110-11 href=#__codelineno-110-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>keepSnapshots</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
<a id=__codelineno-110-12 name=__codelineno-110-12 href=#__codelineno-110-12></a>    <span class=p>}</span>
<a id=__codelineno-110-13 name=__codelineno-110-13 href=#__codelineno-110-13></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-111-1 name=__codelineno-111-1 href=#__codelineno-111-1></a><span class=k>final</span> <span class=k>protected</span> <span class=k>function</span> <span class=nf>setSchema</span><span class=p>(</span>
<a id=__codelineno-111-2 name=__codelineno-111-2 href=#__codelineno-111-2></a>    <span class=nx>string</span> <span class=nv>$schema</span>
<a id=__codelineno-111-3 name=__codelineno-111-3 href=#__codelineno-111-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Sets schema name where the mapped table is located</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-112-1 name=__codelineno-112-1 href=#__codelineno-112-1></a><span class=k>final</span> <span class=k>protected</span> <span class=k>function</span> <span class=nf>setSource</span><span class=p>(</span>
<a id=__codelineno-112-2 name=__codelineno-112-2 href=#__codelineno-112-2></a>    <span class=nx>string</span> <span class=nv>$source</span>
<a id=__codelineno-112-3 name=__codelineno-112-3 href=#__codelineno-112-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>ModelInterface</span>
</code></pre></div> Sets the table name to which the model should be mapped</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-113-1 name=__codelineno-113-1 href=#__codelineno-113-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>skipAttributes</span><span class=p>(</span><span class=k>array</span> <span class=nv>$attributes</span><span class=p>)</span>
</code></pre></div> Sets a list of attributes that must be skipped from the generated <code>INSERT</code>/<code>UPDATE</code> statement</p> <div class=highlight><pre><span></span><code><a id=__codelineno-114-1 name=__codelineno-114-1 href=#__codelineno-114-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-114-2 name=__codelineno-114-2 href=#__codelineno-114-2></a>
<a id=__codelineno-114-3 name=__codelineno-114-3 href=#__codelineno-114-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-114-4 name=__codelineno-114-4 href=#__codelineno-114-4></a>
<a id=__codelineno-114-5 name=__codelineno-114-5 href=#__codelineno-114-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-114-6 name=__codelineno-114-6 href=#__codelineno-114-6></a>
<a id=__codelineno-114-7 name=__codelineno-114-7 href=#__codelineno-114-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-114-8 name=__codelineno-114-8 href=#__codelineno-114-8></a><span class=p>{</span>
<a id=__codelineno-114-9 name=__codelineno-114-9 href=#__codelineno-114-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-114-10 name=__codelineno-114-10 href=#__codelineno-114-10></a>    <span class=p>{</span>
<a id=__codelineno-114-11 name=__codelineno-114-11 href=#__codelineno-114-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributes</span><span class=p>(</span>
<a id=__codelineno-114-12 name=__codelineno-114-12 href=#__codelineno-114-12></a>            <span class=p>[</span>
<a id=__codelineno-114-13 name=__codelineno-114-13 href=#__codelineno-114-13></a>                <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-114-14 name=__codelineno-114-14 href=#__codelineno-114-14></a>            <span class=p>]</span>
<a id=__codelineno-114-15 name=__codelineno-114-15 href=#__codelineno-114-15></a>        <span class=p>);</span>
<a id=__codelineno-114-16 name=__codelineno-114-16 href=#__codelineno-114-16></a>    <span class=p>}</span>
<a id=__codelineno-114-17 name=__codelineno-114-17 href=#__codelineno-114-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-115-1 name=__codelineno-115-1 href=#__codelineno-115-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>skipAttributesOnCreate</span><span class=p>(</span>
<a id=__codelineno-115-2 name=__codelineno-115-2 href=#__codelineno-115-2></a>    <span class=k>array</span> <span class=nv>$attributes</span>
<a id=__codelineno-115-3 name=__codelineno-115-3 href=#__codelineno-115-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets a list of attributes that must be skipped from the generated <code>INSERT</code> statement</p> <div class=highlight><pre><span></span><code><a id=__codelineno-116-1 name=__codelineno-116-1 href=#__codelineno-116-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-116-2 name=__codelineno-116-2 href=#__codelineno-116-2></a>
<a id=__codelineno-116-3 name=__codelineno-116-3 href=#__codelineno-116-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-116-4 name=__codelineno-116-4 href=#__codelineno-116-4></a>
<a id=__codelineno-116-5 name=__codelineno-116-5 href=#__codelineno-116-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-116-6 name=__codelineno-116-6 href=#__codelineno-116-6></a>
<a id=__codelineno-116-7 name=__codelineno-116-7 href=#__codelineno-116-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-116-8 name=__codelineno-116-8 href=#__codelineno-116-8></a><span class=p>{</span>
<a id=__codelineno-116-9 name=__codelineno-116-9 href=#__codelineno-116-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-116-10 name=__codelineno-116-10 href=#__codelineno-116-10></a>    <span class=p>{</span>
<a id=__codelineno-116-11 name=__codelineno-116-11 href=#__codelineno-116-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributesOnCreate</span><span class=p>(</span>
<a id=__codelineno-116-12 name=__codelineno-116-12 href=#__codelineno-116-12></a>            <span class=p>[</span>
<a id=__codelineno-116-13 name=__codelineno-116-13 href=#__codelineno-116-13></a>                <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-116-14 name=__codelineno-116-14 href=#__codelineno-116-14></a>            <span class=p>]</span>
<a id=__codelineno-116-15 name=__codelineno-116-15 href=#__codelineno-116-15></a>        <span class=p>);</span>
<a id=__codelineno-116-16 name=__codelineno-116-16 href=#__codelineno-116-16></a>    <span class=p>}</span>
<a id=__codelineno-116-17 name=__codelineno-116-17 href=#__codelineno-116-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-117-1 name=__codelineno-117-1 href=#__codelineno-117-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>skipAttributesOnUpdate</span><span class=p>(</span>
<a id=__codelineno-117-2 name=__codelineno-117-2 href=#__codelineno-117-2></a>    <span class=k>array</span> <span class=nv>$attributes</span>
<a id=__codelineno-117-3 name=__codelineno-117-3 href=#__codelineno-117-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets a list of attributes that must be skipped from the generated <code>UPDATE</code> statement</p> <div class=highlight><pre><span></span><code><a id=__codelineno-118-1 name=__codelineno-118-1 href=#__codelineno-118-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-118-2 name=__codelineno-118-2 href=#__codelineno-118-2></a>
<a id=__codelineno-118-3 name=__codelineno-118-3 href=#__codelineno-118-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-118-4 name=__codelineno-118-4 href=#__codelineno-118-4></a>
<a id=__codelineno-118-5 name=__codelineno-118-5 href=#__codelineno-118-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-118-6 name=__codelineno-118-6 href=#__codelineno-118-6></a>
<a id=__codelineno-118-7 name=__codelineno-118-7 href=#__codelineno-118-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-118-8 name=__codelineno-118-8 href=#__codelineno-118-8></a><span class=p>{</span>
<a id=__codelineno-118-9 name=__codelineno-118-9 href=#__codelineno-118-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-118-10 name=__codelineno-118-10 href=#__codelineno-118-10></a>    <span class=p>{</span>
<a id=__codelineno-118-11 name=__codelineno-118-11 href=#__codelineno-118-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributesOnUpdate</span><span class=p>(</span>
<a id=__codelineno-118-12 name=__codelineno-118-12 href=#__codelineno-118-12></a>            <span class=p>[</span>
<a id=__codelineno-118-13 name=__codelineno-118-13 href=#__codelineno-118-13></a>                <span class=s1>&#39;inv_modified_at&#39;</span><span class=p>,</span>
<a id=__codelineno-118-14 name=__codelineno-118-14 href=#__codelineno-118-14></a>            <span class=p>]</span>
<a id=__codelineno-118-15 name=__codelineno-118-15 href=#__codelineno-118-15></a>        <span class=p>);</span>
<a id=__codelineno-118-16 name=__codelineno-118-16 href=#__codelineno-118-16></a>    <span class=p>}</span>
<a id=__codelineno-118-17 name=__codelineno-118-17 href=#__codelineno-118-17></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-119-1 name=__codelineno-119-1 href=#__codelineno-119-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>useDynamicUpdate</span><span class=p>(</span>
<a id=__codelineno-119-2 name=__codelineno-119-2 href=#__codelineno-119-2></a>    <span class=nx>bool</span> <span class=nx>dynamicUpdate</span>
<a id=__codelineno-119-3 name=__codelineno-119-3 href=#__codelineno-119-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
</code></pre></div> Sets if a model must use dynamic update instead of the all-field update</p> <div class=highlight><pre><span></span><code><a id=__codelineno-120-1 name=__codelineno-120-1 href=#__codelineno-120-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-120-2 name=__codelineno-120-2 href=#__codelineno-120-2></a>
<a id=__codelineno-120-3 name=__codelineno-120-3 href=#__codelineno-120-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-120-4 name=__codelineno-120-4 href=#__codelineno-120-4></a>
<a id=__codelineno-120-5 name=__codelineno-120-5 href=#__codelineno-120-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-120-6 name=__codelineno-120-6 href=#__codelineno-120-6></a>
<a id=__codelineno-120-7 name=__codelineno-120-7 href=#__codelineno-120-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-120-8 name=__codelineno-120-8 href=#__codelineno-120-8></a><span class=p>{</span>
<a id=__codelineno-120-9 name=__codelineno-120-9 href=#__codelineno-120-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-120-10 name=__codelineno-120-10 href=#__codelineno-120-10></a>    <span class=p>{</span>
<a id=__codelineno-120-11 name=__codelineno-120-11 href=#__codelineno-120-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>useDynamicUpdate</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
<a id=__codelineno-120-12 name=__codelineno-120-12 href=#__codelineno-120-12></a>    <span class=p>}</span>
<a id=__codelineno-120-13 name=__codelineno-120-13 href=#__codelineno-120-13></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-121-1 name=__codelineno-121-1 href=#__codelineno-121-1></a><span class=k>protected</span> <span class=k>function</span> <span class=nf>validate</span><span class=p>(</span>
<a id=__codelineno-121-2 name=__codelineno-121-2 href=#__codelineno-121-2></a>    <span class=nx>ValidationInterface</span> <span class=nv>$validator</span>
<a id=__codelineno-121-3 name=__codelineno-121-3 href=#__codelineno-121-3></a><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Executes validators on every validation call</p> <div class=highlight><pre><span></span><code><a id=__codelineno-122-1 name=__codelineno-122-1 href=#__codelineno-122-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-122-2 name=__codelineno-122-2 href=#__codelineno-122-2></a>
<a id=__codelineno-122-3 name=__codelineno-122-3 href=#__codelineno-122-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-122-4 name=__codelineno-122-4 href=#__codelineno-122-4></a>
<a id=__codelineno-122-5 name=__codelineno-122-5 href=#__codelineno-122-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-122-6 name=__codelineno-122-6 href=#__codelineno-122-6></a><span class=k>use</span> <span class=nx>Phalcon\Validation</span><span class=p>;</span>
<a id=__codelineno-122-7 name=__codelineno-122-7 href=#__codelineno-122-7></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\ExclusionIn</span><span class=p>;</span>
<a id=__codelineno-122-8 name=__codelineno-122-8 href=#__codelineno-122-8></a>
<a id=__codelineno-122-9 name=__codelineno-122-9 href=#__codelineno-122-9></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-122-10 name=__codelineno-122-10 href=#__codelineno-122-10></a><span class=p>{</span>
<a id=__codelineno-122-11 name=__codelineno-122-11 href=#__codelineno-122-11></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>validation</span><span class=p>()</span>
<a id=__codelineno-122-12 name=__codelineno-122-12 href=#__codelineno-122-12></a>    <span class=p>{</span>
<a id=__codelineno-122-13 name=__codelineno-122-13 href=#__codelineno-122-13></a>        <span class=nv>$validator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Validation</span><span class=p>();</span>
<a id=__codelineno-122-14 name=__codelineno-122-14 href=#__codelineno-122-14></a>
<a id=__codelineno-122-15 name=__codelineno-122-15 href=#__codelineno-122-15></a>        <span class=nv>$validator</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span>
<a id=__codelineno-122-16 name=__codelineno-122-16 href=#__codelineno-122-16></a>            <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-122-17 name=__codelineno-122-17 href=#__codelineno-122-17></a>            <span class=k>new</span> <span class=nx>ExclusionIn</span><span class=p>(</span>
<a id=__codelineno-122-18 name=__codelineno-122-18 href=#__codelineno-122-18></a>                <span class=p>[</span>
<a id=__codelineno-122-19 name=__codelineno-122-19 href=#__codelineno-122-19></a>                    <span class=s1>&#39;domain&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-122-20 name=__codelineno-122-20 href=#__codelineno-122-20></a>                        <span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-122-21 name=__codelineno-122-21 href=#__codelineno-122-21></a>                        <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-122-22 name=__codelineno-122-22 href=#__codelineno-122-22></a>                    <span class=p>],</span>
<a id=__codelineno-122-23 name=__codelineno-122-23 href=#__codelineno-122-23></a>                <span class=p>]</span>
<a id=__codelineno-122-24 name=__codelineno-122-24 href=#__codelineno-122-24></a>            <span class=p>)</span>
<a id=__codelineno-122-25 name=__codelineno-122-25 href=#__codelineno-122-25></a>        <span class=p>);</span>
<a id=__codelineno-122-26 name=__codelineno-122-26 href=#__codelineno-122-26></a>
<a id=__codelineno-122-27 name=__codelineno-122-27 href=#__codelineno-122-27></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>validate</span><span class=p>(</span><span class=nv>$validator</span><span class=p>);</span>
<a id=__codelineno-122-28 name=__codelineno-122-28 href=#__codelineno-122-28></a>    <span class=p>}</span>
<a id=__codelineno-122-29 name=__codelineno-122-29 href=#__codelineno-122-29></a><span class=p>}</span>
</code></pre></div> <p><div class=highlight><pre><span></span><code><a id=__codelineno-123-1 name=__codelineno-123-1 href=#__codelineno-123-1></a><span class=k>public</span> <span class=k>function</span> <span class=nf>validationHasFailed</span><span class=p>()</span><span class=o>:</span> <span class=nx>bool</span>
</code></pre></div> Check whether validation process has generated any messages</p> <h2 id=creating-models>Creating Models<a class=headerlink href=#creating-models title="Permanent link">&para;</a></h2> <p>A model is a class that extends from <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a>. Its class name should be in camel case notation:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-124-1 name=__codelineno-124-1 href=#__codelineno-124-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-124-2 name=__codelineno-124-2 href=#__codelineno-124-2></a>
<a id=__codelineno-124-3 name=__codelineno-124-3 href=#__codelineno-124-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-124-4 name=__codelineno-124-4 href=#__codelineno-124-4></a>
<a id=__codelineno-124-5 name=__codelineno-124-5 href=#__codelineno-124-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-124-6 name=__codelineno-124-6 href=#__codelineno-124-6></a>
<a id=__codelineno-124-7 name=__codelineno-124-7 href=#__codelineno-124-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-124-8 name=__codelineno-124-8 href=#__codelineno-124-8></a><span class=p>{</span>
<a id=__codelineno-124-9 name=__codelineno-124-9 href=#__codelineno-124-9></a>
<a id=__codelineno-124-10 name=__codelineno-124-10 href=#__codelineno-124-10></a><span class=p>}</span>
</code></pre></div> <p>By default, the model <code>MyApp\Models\Invoices</code> will map to the table <code>invoices</code>. If you want to manually specify another name for the mapped table, you can use the <code>setSource()</code> method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-125-1 name=__codelineno-125-1 href=#__codelineno-125-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-125-2 name=__codelineno-125-2 href=#__codelineno-125-2></a>
<a id=__codelineno-125-3 name=__codelineno-125-3 href=#__codelineno-125-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-125-4 name=__codelineno-125-4 href=#__codelineno-125-4></a>
<a id=__codelineno-125-5 name=__codelineno-125-5 href=#__codelineno-125-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-125-6 name=__codelineno-125-6 href=#__codelineno-125-6></a>
<a id=__codelineno-125-7 name=__codelineno-125-7 href=#__codelineno-125-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-125-8 name=__codelineno-125-8 href=#__codelineno-125-8></a><span class=p>{</span>
<a id=__codelineno-125-9 name=__codelineno-125-9 href=#__codelineno-125-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-125-10 name=__codelineno-125-10 href=#__codelineno-125-10></a>    <span class=p>{</span>
<a id=__codelineno-125-11 name=__codelineno-125-11 href=#__codelineno-125-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setSource</span><span class=p>(</span><span class=s1>&#39;co_invoices&#39;</span><span class=p>);</span>
<a id=__codelineno-125-12 name=__codelineno-125-12 href=#__codelineno-125-12></a>    <span class=p>}</span>
<a id=__codelineno-125-13 name=__codelineno-125-13 href=#__codelineno-125-13></a><span class=p>}</span>
</code></pre></div> <p>The model <code>Invoices</code> now maps to <code>co_invoices</code> table. The <code>initialize()</code> method helps with setting up this model with a custom behavior i.e. a different table.</p> <p>The <code>initialize()</code> method is only called once during the request. This method is intended to perform initializations that apply to all instances of the model created within the application. If you want to perform initialization tasks for every instance created you can use the <code>onConstruct()</code> method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-126-1 name=__codelineno-126-1 href=#__codelineno-126-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-126-2 name=__codelineno-126-2 href=#__codelineno-126-2></a>
<a id=__codelineno-126-3 name=__codelineno-126-3 href=#__codelineno-126-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-126-4 name=__codelineno-126-4 href=#__codelineno-126-4></a>
<a id=__codelineno-126-5 name=__codelineno-126-5 href=#__codelineno-126-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-126-6 name=__codelineno-126-6 href=#__codelineno-126-6></a>
<a id=__codelineno-126-7 name=__codelineno-126-7 href=#__codelineno-126-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-126-8 name=__codelineno-126-8 href=#__codelineno-126-8></a><span class=p>{</span>
<a id=__codelineno-126-9 name=__codelineno-126-9 href=#__codelineno-126-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>onConstruct</span><span class=p>()</span>
<a id=__codelineno-126-10 name=__codelineno-126-10 href=#__codelineno-126-10></a>    <span class=p>{</span>
<a id=__codelineno-126-11 name=__codelineno-126-11 href=#__codelineno-126-11></a>        <span class=c1>// ...</span>
<a id=__codelineno-126-12 name=__codelineno-126-12 href=#__codelineno-126-12></a>    <span class=p>}</span>
<a id=__codelineno-126-13 name=__codelineno-126-13 href=#__codelineno-126-13></a><span class=p>}</span>
</code></pre></div> <p><strong>Properties vs. Setters/Getters</strong></p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>The model class uses some properties internally for services. The names of those properties are reserved and cannot be used as fields in the database. Please keep that in mind when naming the fields of your tables. If there are collisions, your models will not update properly.</p> <p><code>container</code>, <code>dirtyState</code>, <code>dirtyRelated</code>, <code>errorMessages</code>, <code>modelsManager</code>, <code>modelsMetaData</code>, <code>related</code>, <code>operationMade</code>, <code>oldSnapshot</code>, <code>skipped</code>, <code>snapshot</code>, <code>transaction</code>, <code>uniqueKey</code>, <code>uniqueParams</code>, <code>uniqueTypes</code></p> </div> <p>Models can be implemented with public properties, meaning that each property can be read and updated from any part of the code that has instantiated that model class:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-127-1 name=__codelineno-127-1 href=#__codelineno-127-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-127-2 name=__codelineno-127-2 href=#__codelineno-127-2></a>
<a id=__codelineno-127-3 name=__codelineno-127-3 href=#__codelineno-127-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-127-4 name=__codelineno-127-4 href=#__codelineno-127-4></a>
<a id=__codelineno-127-5 name=__codelineno-127-5 href=#__codelineno-127-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-127-6 name=__codelineno-127-6 href=#__codelineno-127-6></a>
<a id=__codelineno-127-7 name=__codelineno-127-7 href=#__codelineno-127-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-127-8 name=__codelineno-127-8 href=#__codelineno-127-8></a><span class=p>{</span>
<a id=__codelineno-127-9 name=__codelineno-127-9 href=#__codelineno-127-9></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-127-10 name=__codelineno-127-10 href=#__codelineno-127-10></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-127-11 name=__codelineno-127-11 href=#__codelineno-127-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-127-12 name=__codelineno-127-12 href=#__codelineno-127-12></a>    <span class=k>public</span> <span class=nv>$inv_title</span><span class=p>;</span>
<a id=__codelineno-127-13 name=__codelineno-127-13 href=#__codelineno-127-13></a>    <span class=k>public</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-127-14 name=__codelineno-127-14 href=#__codelineno-127-14></a>    <span class=k>public</span> <span class=nv>$inv_created_at</span><span class=p>;</span>
<a id=__codelineno-127-15 name=__codelineno-127-15 href=#__codelineno-127-15></a><span class=p>}</span>
</code></pre></div> <p>Another implementation is to use getter and setter functions, which control which properties are publicly available for that model.</p> <p>The benefit of using getters and setters is that the developer can perform transformations and validation checks on the values set or retrieved for the model, which is impossible when using public properties.</p> <p>Additionally, getters and setters allow for future changes without changing the interface of the model class. So if a field name changes, the only change needed will be in the private property of the model referenced in the relevant getter/setter and nowhere else in the code.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-128-1 name=__codelineno-128-1 href=#__codelineno-128-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-128-2 name=__codelineno-128-2 href=#__codelineno-128-2></a>
<a id=__codelineno-128-3 name=__codelineno-128-3 href=#__codelineno-128-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-128-4 name=__codelineno-128-4 href=#__codelineno-128-4></a>
<a id=__codelineno-128-5 name=__codelineno-128-5 href=#__codelineno-128-5></a><span class=k>use</span> <span class=nx>InvalidArgumentException</span><span class=p>;</span>
<a id=__codelineno-128-6 name=__codelineno-128-6 href=#__codelineno-128-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-128-7 name=__codelineno-128-7 href=#__codelineno-128-7></a>
<a id=__codelineno-128-8 name=__codelineno-128-8 href=#__codelineno-128-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-128-9 name=__codelineno-128-9 href=#__codelineno-128-9></a><span class=p>{</span>
<a id=__codelineno-128-10 name=__codelineno-128-10 href=#__codelineno-128-10></a>    <span class=k>protected</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-128-11 name=__codelineno-128-11 href=#__codelineno-128-11></a>    <span class=k>protected</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-128-12 name=__codelineno-128-12 href=#__codelineno-128-12></a>    <span class=k>protected</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-128-13 name=__codelineno-128-13 href=#__codelineno-128-13></a>    <span class=k>protected</span> <span class=nv>$inv_title</span><span class=p>;</span>
<a id=__codelineno-128-14 name=__codelineno-128-14 href=#__codelineno-128-14></a>    <span class=k>protected</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-128-15 name=__codelineno-128-15 href=#__codelineno-128-15></a>    <span class=k>protected</span> <span class=nv>$inv_created_at</span><span class=p>;</span>
<a id=__codelineno-128-16 name=__codelineno-128-16 href=#__codelineno-128-16></a>
<a id=__codelineno-128-17 name=__codelineno-128-17 href=#__codelineno-128-17></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getId</span><span class=p>()</span><span class=o>:</span> <span class=nx>int</span>
<a id=__codelineno-128-18 name=__codelineno-128-18 href=#__codelineno-128-18></a>    <span class=p>{</span>
<a id=__codelineno-128-19 name=__codelineno-128-19 href=#__codelineno-128-19></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>int</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_id</span><span class=p>;</span>
<a id=__codelineno-128-20 name=__codelineno-128-20 href=#__codelineno-128-20></a>    <span class=p>}</span>
<a id=__codelineno-128-21 name=__codelineno-128-21 href=#__codelineno-128-21></a>
<a id=__codelineno-128-22 name=__codelineno-128-22 href=#__codelineno-128-22></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getCustomerId</span><span class=p>()</span><span class=o>:</span> <span class=nx>int</span>
<a id=__codelineno-128-23 name=__codelineno-128-23 href=#__codelineno-128-23></a>    <span class=p>{</span>
<a id=__codelineno-128-24 name=__codelineno-128-24 href=#__codelineno-128-24></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>int</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-128-25 name=__codelineno-128-25 href=#__codelineno-128-25></a>    <span class=p>}</span>
<a id=__codelineno-128-26 name=__codelineno-128-26 href=#__codelineno-128-26></a>
<a id=__codelineno-128-27 name=__codelineno-128-27 href=#__codelineno-128-27></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getStatus</span><span class=p>()</span><span class=o>:</span> <span class=nx>int</span>
<a id=__codelineno-128-28 name=__codelineno-128-28 href=#__codelineno-128-28></a>    <span class=p>{</span>
<a id=__codelineno-128-29 name=__codelineno-128-29 href=#__codelineno-128-29></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>int</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-128-30 name=__codelineno-128-30 href=#__codelineno-128-30></a>    <span class=p>}</span>
<a id=__codelineno-128-31 name=__codelineno-128-31 href=#__codelineno-128-31></a>
<a id=__codelineno-128-32 name=__codelineno-128-32 href=#__codelineno-128-32></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getTitle</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
<a id=__codelineno-128-33 name=__codelineno-128-33 href=#__codelineno-128-33></a>    <span class=p>{</span>
<a id=__codelineno-128-34 name=__codelineno-128-34 href=#__codelineno-128-34></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_title</span><span class=p>;</span>
<a id=__codelineno-128-35 name=__codelineno-128-35 href=#__codelineno-128-35></a>    <span class=p>}</span>
<a id=__codelineno-128-36 name=__codelineno-128-36 href=#__codelineno-128-36></a>
<a id=__codelineno-128-37 name=__codelineno-128-37 href=#__codelineno-128-37></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getTotal</span><span class=p>()</span><span class=o>:</span> <span class=nx>float</span>
<a id=__codelineno-128-38 name=__codelineno-128-38 href=#__codelineno-128-38></a>    <span class=p>{</span>
<a id=__codelineno-128-39 name=__codelineno-128-39 href=#__codelineno-128-39></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>float</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_total</span><span class=p>;</span>
<a id=__codelineno-128-40 name=__codelineno-128-40 href=#__codelineno-128-40></a>    <span class=p>}</span>
<a id=__codelineno-128-41 name=__codelineno-128-41 href=#__codelineno-128-41></a>
<a id=__codelineno-128-42 name=__codelineno-128-42 href=#__codelineno-128-42></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getCreatedAt</span><span class=p>()</span><span class=o>:</span> <span class=nx>string</span>
<a id=__codelineno-128-43 name=__codelineno-128-43 href=#__codelineno-128-43></a>    <span class=p>{</span>
<a id=__codelineno-128-44 name=__codelineno-128-44 href=#__codelineno-128-44></a>        <span class=k>return</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_created_at</span><span class=p>;</span>
<a id=__codelineno-128-45 name=__codelineno-128-45 href=#__codelineno-128-45></a>    <span class=p>}</span>
<a id=__codelineno-128-46 name=__codelineno-128-46 href=#__codelineno-128-46></a>
<a id=__codelineno-128-47 name=__codelineno-128-47 href=#__codelineno-128-47></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setCustomerId</span><span class=p>(</span><span class=nx>int</span> <span class=nv>$customerId</span><span class=p>)</span><span class=o>:</span> <span class=nx>Invoices</span>
<a id=__codelineno-128-48 name=__codelineno-128-48 href=#__codelineno-128-48></a>    <span class=p>{</span>
<a id=__codelineno-128-49 name=__codelineno-128-49 href=#__codelineno-128-49></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span> <span class=o>=</span> <span class=nv>$customerId</span><span class=p>;</span>
<a id=__codelineno-128-50 name=__codelineno-128-50 href=#__codelineno-128-50></a>
<a id=__codelineno-128-51 name=__codelineno-128-51 href=#__codelineno-128-51></a>        <span class=k>return</span> <span class=nv>$this</span><span class=p>;</span>
<a id=__codelineno-128-52 name=__codelineno-128-52 href=#__codelineno-128-52></a>    <span class=p>}</span>
<a id=__codelineno-128-53 name=__codelineno-128-53 href=#__codelineno-128-53></a>
<a id=__codelineno-128-54 name=__codelineno-128-54 href=#__codelineno-128-54></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setStatus</span><span class=p>(</span><span class=nx>int</span> <span class=nv>$status</span><span class=p>)</span><span class=o>:</span> <span class=nx>Invoices</span>
<a id=__codelineno-128-55 name=__codelineno-128-55 href=#__codelineno-128-55></a>    <span class=p>{</span>
<a id=__codelineno-128-56 name=__codelineno-128-56 href=#__codelineno-128-56></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=nv>$status</span><span class=p>;</span>
<a id=__codelineno-128-57 name=__codelineno-128-57 href=#__codelineno-128-57></a>
<a id=__codelineno-128-58 name=__codelineno-128-58 href=#__codelineno-128-58></a>        <span class=k>return</span> <span class=nv>$this</span><span class=p>;</span>
<a id=__codelineno-128-59 name=__codelineno-128-59 href=#__codelineno-128-59></a>    <span class=p>}</span>
<a id=__codelineno-128-60 name=__codelineno-128-60 href=#__codelineno-128-60></a>
<a id=__codelineno-128-61 name=__codelineno-128-61 href=#__codelineno-128-61></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setTitle</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$title</span><span class=p>)</span><span class=o>:</span> <span class=nx>Invoices</span>
<a id=__codelineno-128-62 name=__codelineno-128-62 href=#__codelineno-128-62></a>    <span class=p>{</span>
<a id=__codelineno-128-63 name=__codelineno-128-63 href=#__codelineno-128-63></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_title</span> <span class=o>=</span> <span class=nv>$title</span><span class=p>;</span>
<a id=__codelineno-128-64 name=__codelineno-128-64 href=#__codelineno-128-64></a>
<a id=__codelineno-128-65 name=__codelineno-128-65 href=#__codelineno-128-65></a>        <span class=k>return</span> <span class=nv>$this</span><span class=p>;</span>
<a id=__codelineno-128-66 name=__codelineno-128-66 href=#__codelineno-128-66></a>    <span class=p>}</span>
<a id=__codelineno-128-67 name=__codelineno-128-67 href=#__codelineno-128-67></a>
<a id=__codelineno-128-68 name=__codelineno-128-68 href=#__codelineno-128-68></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setTotal</span><span class=p>(</span><span class=nx>float</span> <span class=nv>$total</span><span class=p>)</span><span class=o>:</span> <span class=nx>Invoices</span>
<a id=__codelineno-128-69 name=__codelineno-128-69 href=#__codelineno-128-69></a>    <span class=p>{</span>
<a id=__codelineno-128-70 name=__codelineno-128-70 href=#__codelineno-128-70></a>        <span class=k>if</span> <span class=p>(</span><span class=nv>$total</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-128-71 name=__codelineno-128-71 href=#__codelineno-128-71></a>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>InvalidArgumentException</span><span class=p>(</span>
<a id=__codelineno-128-72 name=__codelineno-128-72 href=#__codelineno-128-72></a>                <span class=s1>&#39;Incorrect total&#39;</span>
<a id=__codelineno-128-73 name=__codelineno-128-73 href=#__codelineno-128-73></a>            <span class=p>);</span>
<a id=__codelineno-128-74 name=__codelineno-128-74 href=#__codelineno-128-74></a>        <span class=p>}</span>
<a id=__codelineno-128-75 name=__codelineno-128-75 href=#__codelineno-128-75></a>
<a id=__codelineno-128-76 name=__codelineno-128-76 href=#__codelineno-128-76></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=nv>$total</span><span class=p>;</span>
<a id=__codelineno-128-77 name=__codelineno-128-77 href=#__codelineno-128-77></a>
<a id=__codelineno-128-78 name=__codelineno-128-78 href=#__codelineno-128-78></a>        <span class=k>return</span> <span class=nv>$this</span><span class=p>;</span>
<a id=__codelineno-128-79 name=__codelineno-128-79 href=#__codelineno-128-79></a>    <span class=p>}</span>
<a id=__codelineno-128-80 name=__codelineno-128-80 href=#__codelineno-128-80></a>
<a id=__codelineno-128-81 name=__codelineno-128-81 href=#__codelineno-128-81></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setCreatedAt</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$date</span><span class=p>)</span><span class=o>:</span> <span class=nx>Invoices</span>
<a id=__codelineno-128-82 name=__codelineno-128-82 href=#__codelineno-128-82></a>    <span class=p>{</span>
<a id=__codelineno-128-83 name=__codelineno-128-83 href=#__codelineno-128-83></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_created_at</span> <span class=o>=</span> <span class=nv>$date</span><span class=p>;</span>
<a id=__codelineno-128-84 name=__codelineno-128-84 href=#__codelineno-128-84></a>
<a id=__codelineno-128-85 name=__codelineno-128-85 href=#__codelineno-128-85></a>        <span class=k>return</span> <span class=nv>$this</span><span class=p>;</span>
<a id=__codelineno-128-86 name=__codelineno-128-86 href=#__codelineno-128-86></a>    <span class=p>}</span>
<a id=__codelineno-128-87 name=__codelineno-128-87 href=#__codelineno-128-87></a><span class=p>}</span>
</code></pre></div> <p>Public properties provide less complexity in development. However, getters/setters can heavily increase the testability, extensibility, and maintainability of applications. You will need to decide which strategy is best for you depending on the needs of the application. The ORM is compatible with both schemes of defining properties.</p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>Underscores in property names can be problematic when using getters and setters.</p> </div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>When using the getters/setters approach, you will need to define your properties as <code>protected</code>.</p> </div> <p>If you use underscores in your property names, you must still use camel case in your getter/setter declarations for use with magic methods. (e.g. <code>$model-&gt;getPropertyName</code> instead of <code>$model-&gt;getProperty_name</code>, <code>$model-&gt;findByPropertyName</code> instead of <code>$model-&gt;findByProperty_name</code>, etc.).</p> <p>The ORM expects camel case naming and underscores are commonly removed. It is therefore recommended to name your properties in the manner shown throughout the documentation. You can use a column map (as described above) to ensure proper mapping of your properties to their database counterparts.</p> <h2 id=records-to-objects>Records To Objects<a class=headerlink href=#records-to-objects title="Permanent link">&para;</a></h2> <p>Every instance of a model represents a row in the table. You can easily access record data by reading object properties. For example, for a table 'co_customers' with the records:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-129-1 name=__codelineno-129-1 href=#__codelineno-129-1></a><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>co_customers</span><span class=p>;</span>
<a id=__codelineno-129-2 name=__codelineno-129-2 href=#__codelineno-129-2></a><span class=o>+</span><span class=c1>--------+---------------+----------------+</span>
<a id=__codelineno-129-3 name=__codelineno-129-3 href=#__codelineno-129-3></a><span class=o>|</span><span class=w> </span><span class=n>cst_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cst_name_last</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cst_name_first</span><span class=w> </span><span class=o>|</span>
<a id=__codelineno-129-4 name=__codelineno-129-4 href=#__codelineno-129-4></a><span class=o>+</span><span class=c1>--------+---------------+----------------+</span>
<a id=__codelineno-129-5 name=__codelineno-129-5 href=#__codelineno-129-5></a><span class=o>|</span><span class=w>      </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Vader</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>Darth</span><span class=w>          </span><span class=o>|</span>
<a id=__codelineno-129-6 name=__codelineno-129-6 href=#__codelineno-129-6></a><span class=o>|</span><span class=w>      </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Skywalker</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=k>Like</span><span class=w>           </span><span class=o>|</span>
<a id=__codelineno-129-7 name=__codelineno-129-7 href=#__codelineno-129-7></a><span class=o>|</span><span class=w>      </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Skywalker</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>Leia</span><span class=w>           </span><span class=o>|</span>
<a id=__codelineno-129-8 name=__codelineno-129-8 href=#__codelineno-129-8></a><span class=o>+</span><span class=c1>--------+---------------+----------------+</span>
<a id=__codelineno-129-9 name=__codelineno-129-9 href=#__codelineno-129-9></a><span class=mi>3</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span>
</code></pre></div> <p>You could find a certain record by its primary key and then print its name:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-130-1 name=__codelineno-130-1 href=#__codelineno-130-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-130-2 name=__codelineno-130-2 href=#__codelineno-130-2></a>
<a id=__codelineno-130-3 name=__codelineno-130-3 href=#__codelineno-130-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-130-4 name=__codelineno-130-4 href=#__codelineno-130-4></a>
<a id=__codelineno-130-5 name=__codelineno-130-5 href=#__codelineno-130-5></a><span class=c1>// cst_id = 3</span>
<a id=__codelineno-130-6 name=__codelineno-130-6 href=#__codelineno-130-6></a><span class=nv>$customer</span> <span class=o>=</span> <span class=nx>Customers</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
<a id=__codelineno-130-7 name=__codelineno-130-7 href=#__codelineno-130-7></a>
<a id=__codelineno-130-8 name=__codelineno-130-8 href=#__codelineno-130-8></a><span class=c1>// &#39;Leia&#39;</span>
<a id=__codelineno-130-9 name=__codelineno-130-9 href=#__codelineno-130-9></a><span class=k>echo</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_first</span><span class=p>;</span>
</code></pre></div> <p>Once the record is in memory, you can make modifications to its data and then save changes:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-131-1 name=__codelineno-131-1 href=#__codelineno-131-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-131-2 name=__codelineno-131-2 href=#__codelineno-131-2></a>
<a id=__codelineno-131-3 name=__codelineno-131-3 href=#__codelineno-131-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-131-4 name=__codelineno-131-4 href=#__codelineno-131-4></a>
<a id=__codelineno-131-5 name=__codelineno-131-5 href=#__codelineno-131-5></a><span class=c1>// cst_id = 3</span>
<a id=__codelineno-131-6 name=__codelineno-131-6 href=#__codelineno-131-6></a><span class=nv>$customer</span> <span class=o>=</span> <span class=nx>Customers</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
<a id=__codelineno-131-7 name=__codelineno-131-7 href=#__codelineno-131-7></a>
<a id=__codelineno-131-8 name=__codelineno-131-8 href=#__codelineno-131-8></a><span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_last</span> <span class=o>=</span> <span class=s1>&#39;Princess&#39;</span><span class=p>;</span>
<a id=__codelineno-131-9 name=__codelineno-131-9 href=#__codelineno-131-9></a>
<a id=__codelineno-131-10 name=__codelineno-131-10 href=#__codelineno-131-10></a><span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <p>As you can see, there is no need to use raw SQL statements. <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> provides high database abstraction for web applications, simplifying database operations.</p> <h2 id=finding-records>Finding Records<a class=headerlink href=#finding-records title="Permanent link">&para;</a></h2> <p><a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> also offers several methods for querying records.</p> <h3 id=find><code>find</code><a class=headerlink href=#find title="Permanent link">&para;</a></h3> <p>The method returns a <a href=../api/phalcon_mvc/#mvcmodelresultset-->Phalcon\Mvc\Model\Resultset</a>, <a href=../api/phalcon_mvc/#mvcmodelresultsetcomplex->Phalcon\Mvc\Model\Resultset\Complex</a> or <a href=../api/phalcon_mvc/#mvcmodelresultsetsimple->Phalcon\Mvc\Model\Resultset\Simple</a> collection of records even if the result returned is only one record.</p> <p>The method accepts a variety of parameters to retrieve data:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-132-1 name=__codelineno-132-1 href=#__codelineno-132-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-132-2 name=__codelineno-132-2 href=#__codelineno-132-2></a>
<a id=__codelineno-132-3 name=__codelineno-132-3 href=#__codelineno-132-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-132-4 name=__codelineno-132-4 href=#__codelineno-132-4></a>
<a id=__codelineno-132-5 name=__codelineno-132-5 href=#__codelineno-132-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 3&#39;</span><span class=p>);</span>
</code></pre></div> You can also pass a string with a <code>WHERE</code> clause. In the above example, we are getting the same record, instructing the ORM to give us a record with <code>inv_cst_id = 3</code></p> <p>The most flexible syntax is to pass an array with different parameters:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-133-1 name=__codelineno-133-1 href=#__codelineno-133-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-133-2 name=__codelineno-133-2 href=#__codelineno-133-2></a>
<a id=__codelineno-133-3 name=__codelineno-133-3 href=#__codelineno-133-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-133-4 name=__codelineno-133-4 href=#__codelineno-133-4></a>
<a id=__codelineno-133-5 name=__codelineno-133-5 href=#__codelineno-133-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-133-6 name=__codelineno-133-6 href=#__codelineno-133-6></a>    <span class=p>[</span>
<a id=__codelineno-133-7 name=__codelineno-133-7 href=#__codelineno-133-7></a>        <span class=s1>&#39;inv_id = 3&#39;</span><span class=p>,</span>
<a id=__codelineno-133-8 name=__codelineno-133-8 href=#__codelineno-133-8></a>    <span class=p>]</span>
<a id=__codelineno-133-9 name=__codelineno-133-9 href=#__codelineno-133-9></a><span class=p>);</span>
</code></pre></div> The first parameter of the array (without a key) is treated the same way as the example above (passing a string). The array accepts additional parameters that offer additional options to customize the find operation.</p> <h3 id=findfirst><code>findFirst</code><a class=headerlink href=#findfirst title="Permanent link">&para;</a></h3> <p>You could also use the <code>findFirst()</code> method to get only the first record matching the given criteria:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-134-1 name=__codelineno-134-1 href=#__codelineno-134-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-134-2 name=__codelineno-134-2 href=#__codelineno-134-2></a>
<a id=__codelineno-134-3 name=__codelineno-134-3 href=#__codelineno-134-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-134-4 name=__codelineno-134-4 href=#__codelineno-134-4></a>
<a id=__codelineno-134-5 name=__codelineno-134-5 href=#__codelineno-134-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
</code></pre></div> Calling <code>findFirst</code> without a parameter will return the first record the ORM finds. Usually, this is the first record in the table.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-135-1 name=__codelineno-135-1 href=#__codelineno-135-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-135-2 name=__codelineno-135-2 href=#__codelineno-135-2></a>
<a id=__codelineno-135-3 name=__codelineno-135-3 href=#__codelineno-135-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-135-4 name=__codelineno-135-4 href=#__codelineno-135-4></a>
<a id=__codelineno-135-5 name=__codelineno-135-5 href=#__codelineno-135-5></a><span class=c1>// cst_id = 3</span>
<a id=__codelineno-135-6 name=__codelineno-135-6 href=#__codelineno-135-6></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</code></pre></div> Passing a number will query the underlying model using the primary key matching the number parameter passed. If there is no primary key defined or there is a compound key, you will not get any results.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-136-1 name=__codelineno-136-1 href=#__codelineno-136-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-136-2 name=__codelineno-136-2 href=#__codelineno-136-2></a>
<a id=__codelineno-136-3 name=__codelineno-136-3 href=#__codelineno-136-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-136-4 name=__codelineno-136-4 href=#__codelineno-136-4></a>
<a id=__codelineno-136-5 name=__codelineno-136-5 href=#__codelineno-136-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;inv_id = 3&#39;</span><span class=p>);</span>
</code></pre></div> You can also pass a string with a <code>WHERE</code> clause. In the above example, we are getting the same record, instructing the ORM to give us a record with <code>inv_cst_id = 3</code></p> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>If the primary key of the table is not numeric, use condition. See examples below.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-137-1 name=__codelineno-137-1 href=#__codelineno-137-1></a><span class=nv>$uuid</span> <span class=o>=</span> <span class=s1>&#39;5741bfd7-6870-40b7-adf6-cbacb515b9a9&#39;</span><span class=p>;</span>
<a id=__codelineno-137-2 name=__codelineno-137-2 href=#__codelineno-137-2></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>([</span>
<a id=__codelineno-137-3 name=__codelineno-137-3 href=#__codelineno-137-3></a>    <span class=s1>&#39;uuid = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-137-4 name=__codelineno-137-4 href=#__codelineno-137-4></a>    <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=nv>$uuid</span><span class=p>],</span>
<a id=__codelineno-137-5 name=__codelineno-137-5 href=#__codelineno-137-5></a><span class=p>]);</span>
<a id=__codelineno-137-6 name=__codelineno-137-6 href=#__codelineno-137-6></a>
<a id=__codelineno-137-7 name=__codelineno-137-7 href=#__codelineno-137-7></a><span class=c1>// OR</span>
<a id=__codelineno-137-8 name=__codelineno-137-8 href=#__codelineno-137-8></a>
<a id=__codelineno-137-9 name=__codelineno-137-9 href=#__codelineno-137-9></a><span class=nv>$uuid</span> <span class=o>=</span> <span class=s1>&#39;5741bfd7-6870-40b7-adf6-cbacb515b9a9&#39;</span><span class=p>;</span>
<a id=__codelineno-137-10 name=__codelineno-137-10 href=#__codelineno-137-10></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>([</span>
<a id=__codelineno-137-11 name=__codelineno-137-11 href=#__codelineno-137-11></a>    <span class=s1>&#39;uuid = :primary:&#39;</span><span class=p>,</span>
<a id=__codelineno-137-12 name=__codelineno-137-12 href=#__codelineno-137-12></a>    <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;primary&#39;</span> <span class=o>=&gt;</span> <span class=nv>$uuid</span><span class=p>],</span>
<a id=__codelineno-137-13 name=__codelineno-137-13 href=#__codelineno-137-13></a><span class=p>]);</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>If you do not use bound parameters in your conditions, PHQL will create a new plan internally, therefore consuming more memory. Using bound parameters is highly recommended!</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-138-1 name=__codelineno-138-1 href=#__codelineno-138-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-138-2 name=__codelineno-138-2 href=#__codelineno-138-2></a>
<a id=__codelineno-138-3 name=__codelineno-138-3 href=#__codelineno-138-3></a>
<a id=__codelineno-138-4 name=__codelineno-138-4 href=#__codelineno-138-4></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-138-5 name=__codelineno-138-5 href=#__codelineno-138-5></a>
<a id=__codelineno-138-6 name=__codelineno-138-6 href=#__codelineno-138-6></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span><span class=s1>&#39;uuid = &quot;5741bfd7-6870-40b7-adf6-cbacb515b9a9&quot;&#39;</span><span class=p>);</span>
</code></pre></div> <h3 id=parameters>Parameters<a class=headerlink href=#parameters title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>It is highly recommended to use the array syntax with <code>conditions</code> and <code>bind</code> to shield yourself from SQL injections, especially when the criteria come from user input. For more information check the <a href=#binding-parameters>Binding Parameters</a>` section.</p> </div> <p>Both <code>find()</code> and <code>findFirst()</code> methods accept an associative array specifying the search criteria.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-139-1 name=__codelineno-139-1 href=#__codelineno-139-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-139-2 name=__codelineno-139-2 href=#__codelineno-139-2></a>
<a id=__codelineno-139-3 name=__codelineno-139-3 href=#__codelineno-139-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-139-4 name=__codelineno-139-4 href=#__codelineno-139-4></a>
<a id=__codelineno-139-5 name=__codelineno-139-5 href=#__codelineno-139-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-139-6 name=__codelineno-139-6 href=#__codelineno-139-6></a>    <span class=p>[</span>
<a id=__codelineno-139-7 name=__codelineno-139-7 href=#__codelineno-139-7></a>        <span class=s1>&#39;inv_cst_id = 3&#39;</span><span class=p>,</span>
<a id=__codelineno-139-8 name=__codelineno-139-8 href=#__codelineno-139-8></a>        <span class=s1>&#39;order&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total desc&#39;</span>
<a id=__codelineno-139-9 name=__codelineno-139-9 href=#__codelineno-139-9></a>    <span class=p>]</span>
<a id=__codelineno-139-10 name=__codelineno-139-10 href=#__codelineno-139-10></a><span class=p>);</span>
</code></pre></div> <p>You can (and should) use the <code>conditions</code> and <code>bind</code> array elements which bind parameters to the query parameters. Using this implementation will ensure that your parameters are bound thus reducing the possibility of SQL injections:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-140-1 name=__codelineno-140-1 href=#__codelineno-140-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-140-2 name=__codelineno-140-2 href=#__codelineno-140-2></a>
<a id=__codelineno-140-3 name=__codelineno-140-3 href=#__codelineno-140-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-140-4 name=__codelineno-140-4 href=#__codelineno-140-4></a>
<a id=__codelineno-140-5 name=__codelineno-140-5 href=#__codelineno-140-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-140-6 name=__codelineno-140-6 href=#__codelineno-140-6></a>    <span class=p>[</span>
<a id=__codelineno-140-7 name=__codelineno-140-7 href=#__codelineno-140-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-140-8 name=__codelineno-140-8 href=#__codelineno-140-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-140-9 name=__codelineno-140-9 href=#__codelineno-140-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-140-10 name=__codelineno-140-10 href=#__codelineno-140-10></a>        <span class=p>],</span>
<a id=__codelineno-140-11 name=__codelineno-140-11 href=#__codelineno-140-11></a>        <span class=s1>&#39;order&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;inv_total desc&#39;</span><span class=p>,</span>
<a id=__codelineno-140-12 name=__codelineno-140-12 href=#__codelineno-140-12></a>    <span class=p>]</span>
<a id=__codelineno-140-13 name=__codelineno-140-13 href=#__codelineno-140-13></a><span class=p>);</span>
</code></pre></div> <p>The available query options are:</p> <p><strong><code>bind</code></strong></p> <p>Bind is used together with <code>conditions</code>, by replacing placeholders and escaping values thus increasing security</p> <div class=highlight><pre><span></span><code><a id=__codelineno-141-1 name=__codelineno-141-1 href=#__codelineno-141-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-141-2 name=__codelineno-141-2 href=#__codelineno-141-2></a>
<a id=__codelineno-141-3 name=__codelineno-141-3 href=#__codelineno-141-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-141-4 name=__codelineno-141-4 href=#__codelineno-141-4></a>
<a id=__codelineno-141-5 name=__codelineno-141-5 href=#__codelineno-141-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-141-6 name=__codelineno-141-6 href=#__codelineno-141-6></a>    <span class=p>[</span>
<a id=__codelineno-141-7 name=__codelineno-141-7 href=#__codelineno-141-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :inv_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-141-8 name=__codelineno-141-8 href=#__codelineno-141-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-141-9 name=__codelineno-141-9 href=#__codelineno-141-9></a>            <span class=s1>&#39;inv_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-141-10 name=__codelineno-141-10 href=#__codelineno-141-10></a>        <span class=p>],</span>
<a id=__codelineno-141-11 name=__codelineno-141-11 href=#__codelineno-141-11></a>    <span class=p>]</span>
<a id=__codelineno-141-12 name=__codelineno-141-12 href=#__codelineno-141-12></a><span class=p>);</span>
</code></pre></div> <p><strong><code>bindTypes</code></strong></p> <p>When binding parameters, you can use this option to define additional casting to the bound parameters increasing even more the security of your query.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-142-1 name=__codelineno-142-1 href=#__codelineno-142-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-142-2 name=__codelineno-142-2 href=#__codelineno-142-2></a>
<a id=__codelineno-142-3 name=__codelineno-142-3 href=#__codelineno-142-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-142-4 name=__codelineno-142-4 href=#__codelineno-142-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Column</span><span class=p>;</span>
<a id=__codelineno-142-5 name=__codelineno-142-5 href=#__codelineno-142-5></a>
<a id=__codelineno-142-6 name=__codelineno-142-6 href=#__codelineno-142-6></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-142-7 name=__codelineno-142-7 href=#__codelineno-142-7></a>    <span class=p>[</span>
<a id=__codelineno-142-8 name=__codelineno-142-8 href=#__codelineno-142-8></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :inv_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-142-9 name=__codelineno-142-9 href=#__codelineno-142-9></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-142-10 name=__codelineno-142-10 href=#__codelineno-142-10></a>            <span class=s1>&#39;inv_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-142-11 name=__codelineno-142-11 href=#__codelineno-142-11></a>        <span class=p>],</span>
<a id=__codelineno-142-12 name=__codelineno-142-12 href=#__codelineno-142-12></a>        <span class=s1>&#39;bindTypes&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-142-13 name=__codelineno-142-13 href=#__codelineno-142-13></a>            <span class=nx>Column</span><span class=o>::</span><span class=na>BIND_PARAM_INT</span><span class=p>,</span>
<a id=__codelineno-142-14 name=__codelineno-142-14 href=#__codelineno-142-14></a>        <span class=p>],</span>
<a id=__codelineno-142-15 name=__codelineno-142-15 href=#__codelineno-142-15></a>    <span class=p>]</span>
<a id=__codelineno-142-16 name=__codelineno-142-16 href=#__codelineno-142-16></a><span class=p>);</span>
</code></pre></div> <p><strong><code>cache</code></strong></p> <p>Cache the resultset, reducing the continuous access to the relational system.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-143-1 name=__codelineno-143-1 href=#__codelineno-143-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-143-2 name=__codelineno-143-2 href=#__codelineno-143-2></a>
<a id=__codelineno-143-3 name=__codelineno-143-3 href=#__codelineno-143-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-143-4 name=__codelineno-143-4 href=#__codelineno-143-4></a>
<a id=__codelineno-143-5 name=__codelineno-143-5 href=#__codelineno-143-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-143-6 name=__codelineno-143-6 href=#__codelineno-143-6></a>    <span class=p>[</span>
<a id=__codelineno-143-7 name=__codelineno-143-7 href=#__codelineno-143-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-143-8 name=__codelineno-143-8 href=#__codelineno-143-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-143-9 name=__codelineno-143-9 href=#__codelineno-143-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-143-10 name=__codelineno-143-10 href=#__codelineno-143-10></a>        <span class=p>],</span>
<a id=__codelineno-143-11 name=__codelineno-143-11 href=#__codelineno-143-11></a>        <span class=s1>&#39;cache&#39;</span>      <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-143-12 name=__codelineno-143-12 href=#__codelineno-143-12></a>            <span class=s1>&#39;key&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;customer.3&#39;</span><span class=p>,</span>
<a id=__codelineno-143-13 name=__codelineno-143-13 href=#__codelineno-143-13></a>            <span class=s1>&#39;lifetime&#39;</span> <span class=o>=&gt;</span> <span class=mi>84600</span><span class=p>,</span>
<a id=__codelineno-143-14 name=__codelineno-143-14 href=#__codelineno-143-14></a>        <span class=p>],</span>
<a id=__codelineno-143-15 name=__codelineno-143-15 href=#__codelineno-143-15></a>        <span class=s1>&#39;order&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;inv_total desc&#39;</span><span class=p>,</span>
<a id=__codelineno-143-16 name=__codelineno-143-16 href=#__codelineno-143-16></a>    <span class=p>]</span>
<a id=__codelineno-143-17 name=__codelineno-143-17 href=#__codelineno-143-17></a><span class=p>);</span>
</code></pre></div> <p><strong><code>columns</code></strong></p> <p>Return specific columns in the model.</p> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>When using this option an incomplete object is returned, and therefore you cannot call methods such as <code>update()</code>, <code>getRelated()</code> etc.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-144-1 name=__codelineno-144-1 href=#__codelineno-144-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-144-2 name=__codelineno-144-2 href=#__codelineno-144-2></a>
<a id=__codelineno-144-3 name=__codelineno-144-3 href=#__codelineno-144-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-144-4 name=__codelineno-144-4 href=#__codelineno-144-4></a>
<a id=__codelineno-144-5 name=__codelineno-144-5 href=#__codelineno-144-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-144-6 name=__codelineno-144-6 href=#__codelineno-144-6></a>    <span class=p>[</span>
<a id=__codelineno-144-7 name=__codelineno-144-7 href=#__codelineno-144-7></a>        <span class=s1>&#39;columns&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-144-8 name=__codelineno-144-8 href=#__codelineno-144-8></a>            <span class=s1>&#39;inv_id&#39;</span><span class=p>,</span>
<a id=__codelineno-144-9 name=__codelineno-144-9 href=#__codelineno-144-9></a>            <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span>
<a id=__codelineno-144-10 name=__codelineno-144-10 href=#__codelineno-144-10></a>        <span class=p>],</span>
<a id=__codelineno-144-11 name=__codelineno-144-11 href=#__codelineno-144-11></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-144-12 name=__codelineno-144-12 href=#__codelineno-144-12></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-144-13 name=__codelineno-144-13 href=#__codelineno-144-13></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-144-14 name=__codelineno-144-14 href=#__codelineno-144-14></a>        <span class=p>],</span>
<a id=__codelineno-144-15 name=__codelineno-144-15 href=#__codelineno-144-15></a>    <span class=p>]</span>
<a id=__codelineno-144-16 name=__codelineno-144-16 href=#__codelineno-144-16></a><span class=p>);</span>
</code></pre></div> <p>The columns array can return the columns directly if only a value has been set for one of the array elements. However, if you choose to specify a key, it will be used as an alias for that field. In the above example, the <code>cst_name_first</code> is aliased as <code>first</code>.</p> <p><strong><code>conditions</code></strong></p> <p>Search conditions for the find operation. Is used to extract only those records that fulfill a specified criterion. By default, <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> assumes the first parameter is the conditions.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-145-1 name=__codelineno-145-1 href=#__codelineno-145-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-145-2 name=__codelineno-145-2 href=#__codelineno-145-2></a>
<a id=__codelineno-145-3 name=__codelineno-145-3 href=#__codelineno-145-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-145-4 name=__codelineno-145-4 href=#__codelineno-145-4></a>
<a id=__codelineno-145-5 name=__codelineno-145-5 href=#__codelineno-145-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-145-6 name=__codelineno-145-6 href=#__codelineno-145-6></a>    <span class=p>[</span>
<a id=__codelineno-145-7 name=__codelineno-145-7 href=#__codelineno-145-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-145-8 name=__codelineno-145-8 href=#__codelineno-145-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-145-9 name=__codelineno-145-9 href=#__codelineno-145-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-145-10 name=__codelineno-145-10 href=#__codelineno-145-10></a>        <span class=p>],</span>
<a id=__codelineno-145-11 name=__codelineno-145-11 href=#__codelineno-145-11></a>    <span class=p>]</span>
<a id=__codelineno-145-12 name=__codelineno-145-12 href=#__codelineno-145-12></a><span class=p>);</span>
</code></pre></div> <p><strong><code>for_update</code></strong></p> <p>With this option, <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> reads the latest available data, setting exclusive locks on each row it reads</p> <div class=highlight><pre><span></span><code><a id=__codelineno-146-1 name=__codelineno-146-1 href=#__codelineno-146-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-146-2 name=__codelineno-146-2 href=#__codelineno-146-2></a>
<a id=__codelineno-146-3 name=__codelineno-146-3 href=#__codelineno-146-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-146-4 name=__codelineno-146-4 href=#__codelineno-146-4></a>
<a id=__codelineno-146-5 name=__codelineno-146-5 href=#__codelineno-146-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-146-6 name=__codelineno-146-6 href=#__codelineno-146-6></a>    <span class=p>[</span>
<a id=__codelineno-146-7 name=__codelineno-146-7 href=#__codelineno-146-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-146-8 name=__codelineno-146-8 href=#__codelineno-146-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-146-9 name=__codelineno-146-9 href=#__codelineno-146-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-146-10 name=__codelineno-146-10 href=#__codelineno-146-10></a>        <span class=p>],</span>
<a id=__codelineno-146-11 name=__codelineno-146-11 href=#__codelineno-146-11></a>        <span class=s1>&#39;for_update&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-146-12 name=__codelineno-146-12 href=#__codelineno-146-12></a>    <span class=p>]</span>
<a id=__codelineno-146-13 name=__codelineno-146-13 href=#__codelineno-146-13></a><span class=p>);</span>
</code></pre></div> <p><strong><code>group</code></strong></p> <p>Allows to collect data across multiple records and group the results by one or more columns <code>'group' =&gt; 'name, status'</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-147-1 name=__codelineno-147-1 href=#__codelineno-147-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-147-2 name=__codelineno-147-2 href=#__codelineno-147-2></a>
<a id=__codelineno-147-3 name=__codelineno-147-3 href=#__codelineno-147-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-147-4 name=__codelineno-147-4 href=#__codelineno-147-4></a>
<a id=__codelineno-147-5 name=__codelineno-147-5 href=#__codelineno-147-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-147-6 name=__codelineno-147-6 href=#__codelineno-147-6></a>    <span class=p>[</span>
<a id=__codelineno-147-7 name=__codelineno-147-7 href=#__codelineno-147-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-147-8 name=__codelineno-147-8 href=#__codelineno-147-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-147-9 name=__codelineno-147-9 href=#__codelineno-147-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-147-10 name=__codelineno-147-10 href=#__codelineno-147-10></a>        <span class=p>],</span>
<a id=__codelineno-147-11 name=__codelineno-147-11 href=#__codelineno-147-11></a>        <span class=s1>&#39;group&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-147-12 name=__codelineno-147-12 href=#__codelineno-147-12></a>    <span class=p>]</span>
<a id=__codelineno-147-13 name=__codelineno-147-13 href=#__codelineno-147-13></a><span class=p>);</span>
</code></pre></div> <p><strong><code>hydration</code></strong></p> <p>Sets the hydration strategy to represent each returned record in the result</p> <div class=highlight><pre><span></span><code><a id=__codelineno-148-1 name=__codelineno-148-1 href=#__codelineno-148-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-148-2 name=__codelineno-148-2 href=#__codelineno-148-2></a>
<a id=__codelineno-148-3 name=__codelineno-148-3 href=#__codelineno-148-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-148-4 name=__codelineno-148-4 href=#__codelineno-148-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Resultset</span><span class=p>;</span>
<a id=__codelineno-148-5 name=__codelineno-148-5 href=#__codelineno-148-5></a>
<a id=__codelineno-148-6 name=__codelineno-148-6 href=#__codelineno-148-6></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-148-7 name=__codelineno-148-7 href=#__codelineno-148-7></a>    <span class=p>[</span>
<a id=__codelineno-148-8 name=__codelineno-148-8 href=#__codelineno-148-8></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-148-9 name=__codelineno-148-9 href=#__codelineno-148-9></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-148-10 name=__codelineno-148-10 href=#__codelineno-148-10></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-148-11 name=__codelineno-148-11 href=#__codelineno-148-11></a>        <span class=p>],</span>
<a id=__codelineno-148-12 name=__codelineno-148-12 href=#__codelineno-148-12></a>        <span class=s1>&#39;hydration&#39;</span> <span class=o>=&gt;</span> <span class=nx>Resultset</span><span class=o>::</span><span class=na>HYDRATE_OBJECTS</span><span class=p>,</span>
<a id=__codelineno-148-13 name=__codelineno-148-13 href=#__codelineno-148-13></a>    <span class=p>]</span>
<a id=__codelineno-148-14 name=__codelineno-148-14 href=#__codelineno-148-14></a><span class=p>);</span>
</code></pre></div> <p><strong><code>limit</code></strong></p> <p>Limit the results of the query to results to certain range</p> <div class=highlight><pre><span></span><code><a id=__codelineno-149-1 name=__codelineno-149-1 href=#__codelineno-149-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-149-2 name=__codelineno-149-2 href=#__codelineno-149-2></a>
<a id=__codelineno-149-3 name=__codelineno-149-3 href=#__codelineno-149-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-149-4 name=__codelineno-149-4 href=#__codelineno-149-4></a>
<a id=__codelineno-149-5 name=__codelineno-149-5 href=#__codelineno-149-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-149-6 name=__codelineno-149-6 href=#__codelineno-149-6></a>    <span class=p>[</span>
<a id=__codelineno-149-7 name=__codelineno-149-7 href=#__codelineno-149-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-149-8 name=__codelineno-149-8 href=#__codelineno-149-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-149-9 name=__codelineno-149-9 href=#__codelineno-149-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-149-10 name=__codelineno-149-10 href=#__codelineno-149-10></a>        <span class=p>],</span>
<a id=__codelineno-149-11 name=__codelineno-149-11 href=#__codelineno-149-11></a>        <span class=s1>&#39;limit&#39;</span>      <span class=o>=&gt;</span> <span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-149-12 name=__codelineno-149-12 href=#__codelineno-149-12></a>    <span class=p>]</span>
<a id=__codelineno-149-13 name=__codelineno-149-13 href=#__codelineno-149-13></a><span class=p>);</span>
</code></pre></div> <p><strong><code>offset</code></strong></p> <p>Offset the results of the query by a certain amount</p> <div class=highlight><pre><span></span><code><a id=__codelineno-150-1 name=__codelineno-150-1 href=#__codelineno-150-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-150-2 name=__codelineno-150-2 href=#__codelineno-150-2></a>
<a id=__codelineno-150-3 name=__codelineno-150-3 href=#__codelineno-150-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-150-4 name=__codelineno-150-4 href=#__codelineno-150-4></a>
<a id=__codelineno-150-5 name=__codelineno-150-5 href=#__codelineno-150-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-150-6 name=__codelineno-150-6 href=#__codelineno-150-6></a>    <span class=p>[</span>
<a id=__codelineno-150-7 name=__codelineno-150-7 href=#__codelineno-150-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-150-8 name=__codelineno-150-8 href=#__codelineno-150-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-150-9 name=__codelineno-150-9 href=#__codelineno-150-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-150-10 name=__codelineno-150-10 href=#__codelineno-150-10></a>        <span class=p>],</span>
<a id=__codelineno-150-11 name=__codelineno-150-11 href=#__codelineno-150-11></a>        <span class=s1>&#39;limit&#39;</span>      <span class=o>=&gt;</span> <span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-150-12 name=__codelineno-150-12 href=#__codelineno-150-12></a>        <span class=s1>&#39;offset&#39;</span>     <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-150-13 name=__codelineno-150-13 href=#__codelineno-150-13></a>    <span class=p>]</span>
<a id=__codelineno-150-14 name=__codelineno-150-14 href=#__codelineno-150-14></a><span class=p>);</span>
</code></pre></div> <p><strong><code>order</code></strong></p> <p>Is used to sort the resultset. Use one or more fields separated by commas.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-151-1 name=__codelineno-151-1 href=#__codelineno-151-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-151-2 name=__codelineno-151-2 href=#__codelineno-151-2></a>
<a id=__codelineno-151-3 name=__codelineno-151-3 href=#__codelineno-151-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-151-4 name=__codelineno-151-4 href=#__codelineno-151-4></a>
<a id=__codelineno-151-5 name=__codelineno-151-5 href=#__codelineno-151-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-151-6 name=__codelineno-151-6 href=#__codelineno-151-6></a>    <span class=p>[</span>
<a id=__codelineno-151-7 name=__codelineno-151-7 href=#__codelineno-151-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-151-8 name=__codelineno-151-8 href=#__codelineno-151-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-151-9 name=__codelineno-151-9 href=#__codelineno-151-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-151-10 name=__codelineno-151-10 href=#__codelineno-151-10></a>        <span class=p>],</span>
<a id=__codelineno-151-11 name=__codelineno-151-11 href=#__codelineno-151-11></a>        <span class=s1>&#39;order&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;inv_status_flag, inv_total desc&#39;</span><span class=p>,</span>
<a id=__codelineno-151-12 name=__codelineno-151-12 href=#__codelineno-151-12></a>    <span class=p>]</span>
<a id=__codelineno-151-13 name=__codelineno-151-13 href=#__codelineno-151-13></a><span class=p>);</span>
</code></pre></div> <p><strong><code>shared_lock</code></strong></p> <p>With this option, <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> reads the latest available data, setting shared locks on each row it reads</p> <div class=highlight><pre><span></span><code><a id=__codelineno-152-1 name=__codelineno-152-1 href=#__codelineno-152-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-152-2 name=__codelineno-152-2 href=#__codelineno-152-2></a>
<a id=__codelineno-152-3 name=__codelineno-152-3 href=#__codelineno-152-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-152-4 name=__codelineno-152-4 href=#__codelineno-152-4></a>
<a id=__codelineno-152-5 name=__codelineno-152-5 href=#__codelineno-152-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-152-6 name=__codelineno-152-6 href=#__codelineno-152-6></a>    <span class=p>[</span>
<a id=__codelineno-152-7 name=__codelineno-152-7 href=#__codelineno-152-7></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-152-8 name=__codelineno-152-8 href=#__codelineno-152-8></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-152-9 name=__codelineno-152-9 href=#__codelineno-152-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-152-10 name=__codelineno-152-10 href=#__codelineno-152-10></a>        <span class=p>],</span>
<a id=__codelineno-152-11 name=__codelineno-152-11 href=#__codelineno-152-11></a>        <span class=s1>&#39;shared_lock&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-152-12 name=__codelineno-152-12 href=#__codelineno-152-12></a>    <span class=p>]</span>
<a id=__codelineno-152-13 name=__codelineno-152-13 href=#__codelineno-152-13></a><span class=p>);</span>
</code></pre></div> <h3 id=query><code>query</code><a class=headerlink href=#query title="Permanent link">&para;</a></h3> <p>If you prefer, there is also available a way to create queries in an object-oriented way, instead of using an array of parameters:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-153-1 name=__codelineno-153-1 href=#__codelineno-153-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-153-2 name=__codelineno-153-2 href=#__codelineno-153-2></a>
<a id=__codelineno-153-3 name=__codelineno-153-3 href=#__codelineno-153-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-153-4 name=__codelineno-153-4 href=#__codelineno-153-4></a>
<a id=__codelineno-153-5 name=__codelineno-153-5 href=#__codelineno-153-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>query</span><span class=p>()</span>
<a id=__codelineno-153-6 name=__codelineno-153-6 href=#__codelineno-153-6></a>    <span class=o>-&gt;</span><span class=na>where</span><span class=p>(</span><span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>)</span>
<a id=__codelineno-153-7 name=__codelineno-153-7 href=#__codelineno-153-7></a>    <span class=o>-&gt;</span><span class=na>andWhere</span><span class=p>(</span><span class=s1>&#39;inv_total &gt; :total:&#39;</span><span class=p>)</span>
<a id=__codelineno-153-8 name=__codelineno-153-8 href=#__codelineno-153-8></a>    <span class=o>-&gt;</span><span class=na>bind</span><span class=p>(</span>
<a id=__codelineno-153-9 name=__codelineno-153-9 href=#__codelineno-153-9></a>        <span class=p>[</span>
<a id=__codelineno-153-10 name=__codelineno-153-10 href=#__codelineno-153-10></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-153-11 name=__codelineno-153-11 href=#__codelineno-153-11></a>            <span class=s1>&#39;total&#39;</span>  <span class=o>=&gt;</span> <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-153-12 name=__codelineno-153-12 href=#__codelineno-153-12></a>        <span class=p>]</span>
<a id=__codelineno-153-13 name=__codelineno-153-13 href=#__codelineno-153-13></a>    <span class=p>)</span>
<a id=__codelineno-153-14 name=__codelineno-153-14 href=#__codelineno-153-14></a>    <span class=o>-&gt;</span><span class=na>orderBy</span><span class=p>(</span><span class=s1>&#39;inv_status_flag, inv_total desc&#39;</span><span class=p>)</span>
<a id=__codelineno-153-15 name=__codelineno-153-15 href=#__codelineno-153-15></a>    <span class=o>-&gt;</span><span class=na>execute</span><span class=p>()</span>
<a id=__codelineno-153-16 name=__codelineno-153-16 href=#__codelineno-153-16></a><span class=p>;</span>
</code></pre></div> <p>The static method <code>query()</code> returns a <a href=../api/phalcon_mvc/#mvcmodelcriteria->Phalcon\Mvc\Model\Criteria</a> object that is friendly with IDE auto-complete.</p> <p>All the queries are internally handled as <a href=../db-phql/ >PHQL</a> queries. PHQL is a high-level, object-oriented, and SQL-like language. This language offers more features to perform queries such as joining other models, group records, aggregations, etc.</p> <h3 id=findby><code>findBy*</code><a class=headerlink href=#findby title="Permanent link">&para;</a></h3> <p>You can use the <code>findBy&lt;property-name&gt;()</code> method. This method expands on the <code>find()</code> method mentioned above. It allows you to quickly perform a select query from a table by using the property name in the method itself and passing it a parameter that contains the data you want to search for in that column.</p> <p>For the following model:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-154-1 name=__codelineno-154-1 href=#__codelineno-154-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-154-2 name=__codelineno-154-2 href=#__codelineno-154-2></a>
<a id=__codelineno-154-3 name=__codelineno-154-3 href=#__codelineno-154-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-154-4 name=__codelineno-154-4 href=#__codelineno-154-4></a>
<a id=__codelineno-154-5 name=__codelineno-154-5 href=#__codelineno-154-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-154-6 name=__codelineno-154-6 href=#__codelineno-154-6></a>
<a id=__codelineno-154-7 name=__codelineno-154-7 href=#__codelineno-154-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-154-8 name=__codelineno-154-8 href=#__codelineno-154-8></a><span class=p>{</span>
<a id=__codelineno-154-9 name=__codelineno-154-9 href=#__codelineno-154-9></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-154-10 name=__codelineno-154-10 href=#__codelineno-154-10></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-154-11 name=__codelineno-154-11 href=#__codelineno-154-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-154-12 name=__codelineno-154-12 href=#__codelineno-154-12></a>    <span class=k>public</span> <span class=nv>$inv_title</span><span class=p>;</span>
<a id=__codelineno-154-13 name=__codelineno-154-13 href=#__codelineno-154-13></a>    <span class=k>public</span> <span class=nv>$inv_created_at</span><span class=p>;</span>
<a id=__codelineno-154-14 name=__codelineno-154-14 href=#__codelineno-154-14></a><span class=p>}</span>
</code></pre></div> <p>We have the properties <code>inv_cst_id</code>, <code>inv_id</code>, <code>inv_status_flag</code>, <code>inv_title</code>, <code>inv_created_at</code>. If we want to find all the invoices with <code>inv_total = 100</code> we can use:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-155-1 name=__codelineno-155-1 href=#__codelineno-155-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-155-2 name=__codelineno-155-2 href=#__codelineno-155-2></a>
<a id=__codelineno-155-3 name=__codelineno-155-3 href=#__codelineno-155-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-155-4 name=__codelineno-155-4 href=#__codelineno-155-4></a>
<a id=__codelineno-155-5 name=__codelineno-155-5 href=#__codelineno-155-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-155-6 name=__codelineno-155-6 href=#__codelineno-155-6></a>    <span class=p>[</span>
<a id=__codelineno-155-7 name=__codelineno-155-7 href=#__codelineno-155-7></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_total = :total:&#39;</span><span class=p>,</span>
<a id=__codelineno-155-8 name=__codelineno-155-8 href=#__codelineno-155-8></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-155-9 name=__codelineno-155-9 href=#__codelineno-155-9></a>            <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-155-10 name=__codelineno-155-10 href=#__codelineno-155-10></a>        <span class=p>],</span>
<a id=__codelineno-155-11 name=__codelineno-155-11 href=#__codelineno-155-11></a>    <span class=p>]</span>
<a id=__codelineno-155-12 name=__codelineno-155-12 href=#__codelineno-155-12></a><span class=p>);</span>
</code></pre></div> <p>but we can also use:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-156-1 name=__codelineno-156-1 href=#__codelineno-156-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-156-2 name=__codelineno-156-2 href=#__codelineno-156-2></a>
<a id=__codelineno-156-3 name=__codelineno-156-3 href=#__codelineno-156-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-156-4 name=__codelineno-156-4 href=#__codelineno-156-4></a>
<a id=__codelineno-156-5 name=__codelineno-156-5 href=#__codelineno-156-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findByInvTotal</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>The property names are changed to camel case if they have underscores. <code>inv_total</code> becomes <code>InvTotal</code></p> </div> <p>You can also pass parameters in an array as the second parameter. These parameters are the same as the ones you can pass in the <code>find</code> method.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-157-1 name=__codelineno-157-1 href=#__codelineno-157-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-157-2 name=__codelineno-157-2 href=#__codelineno-157-2></a>
<a id=__codelineno-157-3 name=__codelineno-157-3 href=#__codelineno-157-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-157-4 name=__codelineno-157-4 href=#__codelineno-157-4></a>
<a id=__codelineno-157-5 name=__codelineno-157-5 href=#__codelineno-157-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findByInvTotal</span><span class=p>(</span>
<a id=__codelineno-157-6 name=__codelineno-157-6 href=#__codelineno-157-6></a>    <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-157-7 name=__codelineno-157-7 href=#__codelineno-157-7></a>    <span class=p>[</span>
<a id=__codelineno-157-8 name=__codelineno-157-8 href=#__codelineno-157-8></a>        <span class=s1>&#39;order&#39;</span> <span class=o>=&gt;</span> <span class=sb>`inv_cst_id, inv_created_at`</span>
<a id=__codelineno-157-9 name=__codelineno-157-9 href=#__codelineno-157-9></a>    <span class=p>]</span>
<a id=__codelineno-157-10 name=__codelineno-157-10 href=#__codelineno-157-10></a><span class=p>);</span>
</code></pre></div> <h3 id=findfirstby><code>findFirstBy*</code><a class=headerlink href=#findfirstby title="Permanent link">&para;</a></h3> <p>Finally, you can use the <code>findFirstBy&lt;property-name&gt;()</code> method. This method expands on the <code>findFirst()</code> method mentioned above. It allows you to quickly perform a select from a table by using the property name in the method itself and passing it a parameter that contains the data you want to search for in that column.</p> <p>For the following model:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-158-1 name=__codelineno-158-1 href=#__codelineno-158-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-158-2 name=__codelineno-158-2 href=#__codelineno-158-2></a>
<a id=__codelineno-158-3 name=__codelineno-158-3 href=#__codelineno-158-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-158-4 name=__codelineno-158-4 href=#__codelineno-158-4></a>
<a id=__codelineno-158-5 name=__codelineno-158-5 href=#__codelineno-158-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-158-6 name=__codelineno-158-6 href=#__codelineno-158-6></a>
<a id=__codelineno-158-7 name=__codelineno-158-7 href=#__codelineno-158-7></a><span class=k>class</span> <span class=nc>Guestbook</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-158-8 name=__codelineno-158-8 href=#__codelineno-158-8></a><span class=p>{</span>
<a id=__codelineno-158-9 name=__codelineno-158-9 href=#__codelineno-158-9></a>    <span class=k>public</span> <span class=nv>$id</span><span class=p>;</span>
<a id=__codelineno-158-10 name=__codelineno-158-10 href=#__codelineno-158-10></a>    <span class=k>public</span> <span class=nv>$email</span><span class=p>;</span>
<a id=__codelineno-158-11 name=__codelineno-158-11 href=#__codelineno-158-11></a>    <span class=k>public</span> <span class=nv>$name</span><span class=p>;</span>
<a id=__codelineno-158-12 name=__codelineno-158-12 href=#__codelineno-158-12></a>    <span class=k>public</span> <span class=nv>$text</span><span class=p>;</span>
<a id=__codelineno-158-13 name=__codelineno-158-13 href=#__codelineno-158-13></a><span class=p>}</span>
</code></pre></div> <p>We have the properties <code>id</code>, <code>email</code>, <code>name</code>, and <code>text</code>. If we want to find the guest book entry for <code>Darth Vader</code> we can:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-159-1 name=__codelineno-159-1 href=#__codelineno-159-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-159-2 name=__codelineno-159-2 href=#__codelineno-159-2></a>
<a id=__codelineno-159-3 name=__codelineno-159-3 href=#__codelineno-159-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Guestbook</span><span class=p>;</span>
<a id=__codelineno-159-4 name=__codelineno-159-4 href=#__codelineno-159-4></a>
<a id=__codelineno-159-5 name=__codelineno-159-5 href=#__codelineno-159-5></a><span class=nv>$guest</span> <span class=o>=</span> <span class=nx>Guestbook</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-159-6 name=__codelineno-159-6 href=#__codelineno-159-6></a>    <span class=p>[</span>
<a id=__codelineno-159-7 name=__codelineno-159-7 href=#__codelineno-159-7></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;name = :name:&#39;</span><span class=p>,</span>
<a id=__codelineno-159-8 name=__codelineno-159-8 href=#__codelineno-159-8></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-159-9 name=__codelineno-159-9 href=#__codelineno-159-9></a>            <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Darth Vader&#39;</span><span class=p>,</span>
<a id=__codelineno-159-10 name=__codelineno-159-10 href=#__codelineno-159-10></a>        <span class=p>],</span>
<a id=__codelineno-159-11 name=__codelineno-159-11 href=#__codelineno-159-11></a>    <span class=p>]</span>
<a id=__codelineno-159-12 name=__codelineno-159-12 href=#__codelineno-159-12></a><span class=p>);</span>
</code></pre></div> <p>but we can also use:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-160-1 name=__codelineno-160-1 href=#__codelineno-160-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-160-2 name=__codelineno-160-2 href=#__codelineno-160-2></a>
<a id=__codelineno-160-3 name=__codelineno-160-3 href=#__codelineno-160-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Guestbook</span><span class=p>;</span>
<a id=__codelineno-160-4 name=__codelineno-160-4 href=#__codelineno-160-4></a>
<a id=__codelineno-160-5 name=__codelineno-160-5 href=#__codelineno-160-5></a><span class=nv>$name</span>  <span class=o>=</span> <span class=s1>&#39;Darth Vader&#39;</span><span class=p>;</span>
<a id=__codelineno-160-6 name=__codelineno-160-6 href=#__codelineno-160-6></a><span class=nv>$guest</span> <span class=o>=</span> <span class=nx>Guestbook</span><span class=o>::</span><span class=na>findFirstByName</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Notice that we used <code>Name</code> in the method call and passed the variable <code>$name</code> to it, which contains the name we are looking for in our table. Notice also that when we find a match with our query, all the other properties are available to us as well.</p> </div> <h3 id=model-resultsets>Model Resultsets<a class=headerlink href=#model-resultsets title="Permanent link">&para;</a></h3> <p>While <code>findFirst()</code> returns directly an instance of the called class (when there is data to be returned), the <code>find()</code> method returns a <a href=../api/phalcon_mvc/#mvcmodelresultsetsimple->Phalcon\Mvc\Model\Resultset\Simple</a>. This is an object that encapsulates all the functionality a resultset has, such as seeking, traversing, counting, etc.</p> <p>These objects are more powerful than standard arrays. One of the greatest features of the <a href=../api/phalcon_mvc/#mvcmodelresultset-->Phalcon\Mvc\Model\Resultset</a> is that at any time there is only one record in memory. This greatly helps in memory management especially when working with large amounts of data.</p> <p>Some examples of traversing resultsets are:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-161-1 name=__codelineno-161-1 href=#__codelineno-161-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-161-2 name=__codelineno-161-2 href=#__codelineno-161-2></a>
<a id=__codelineno-161-3 name=__codelineno-161-3 href=#__codelineno-161-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-161-4 name=__codelineno-161-4 href=#__codelineno-161-4></a>
<a id=__codelineno-161-5 name=__codelineno-161-5 href=#__codelineno-161-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
<a id=__codelineno-161-6 name=__codelineno-161-6 href=#__codelineno-161-6></a>
<a id=__codelineno-161-7 name=__codelineno-161-7 href=#__codelineno-161-7></a><span class=c1>// foreach</span>
<a id=__codelineno-161-8 name=__codelineno-161-8 href=#__codelineno-161-8></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-161-9 name=__codelineno-161-9 href=#__codelineno-161-9></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-161-10 name=__codelineno-161-10 href=#__codelineno-161-10></a><span class=p>}</span>
<a id=__codelineno-161-11 name=__codelineno-161-11 href=#__codelineno-161-11></a>
<a id=__codelineno-161-12 name=__codelineno-161-12 href=#__codelineno-161-12></a><span class=c1>// while</span>
<a id=__codelineno-161-13 name=__codelineno-161-13 href=#__codelineno-161-13></a><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>rewind</span><span class=p>();</span>
<a id=__codelineno-161-14 name=__codelineno-161-14 href=#__codelineno-161-14></a><span class=k>while</span> <span class=p>(</span><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>valid</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-161-15 name=__codelineno-161-15 href=#__codelineno-161-15></a>    <span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>current</span><span class=p>();</span>
<a id=__codelineno-161-16 name=__codelineno-161-16 href=#__codelineno-161-16></a>
<a id=__codelineno-161-17 name=__codelineno-161-17 href=#__codelineno-161-17></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-161-18 name=__codelineno-161-18 href=#__codelineno-161-18></a>
<a id=__codelineno-161-19 name=__codelineno-161-19 href=#__codelineno-161-19></a>    <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>next</span><span class=p>();</span>
<a id=__codelineno-161-20 name=__codelineno-161-20 href=#__codelineno-161-20></a><span class=p>}</span>
<a id=__codelineno-161-21 name=__codelineno-161-21 href=#__codelineno-161-21></a>
<a id=__codelineno-161-22 name=__codelineno-161-22 href=#__codelineno-161-22></a><span class=c1>// count</span>
<a id=__codelineno-161-23 name=__codelineno-161-23 href=#__codelineno-161-23></a><span class=k>echo</span> <span class=nb>count</span><span class=p>(</span><span class=nv>$invoices</span><span class=p>);</span>
<a id=__codelineno-161-24 name=__codelineno-161-24 href=#__codelineno-161-24></a><span class=k>echo</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>count</span><span class=p>();</span>
<a id=__codelineno-161-25 name=__codelineno-161-25 href=#__codelineno-161-25></a>
<a id=__codelineno-161-26 name=__codelineno-161-26 href=#__codelineno-161-26></a><span class=c1>// seek</span>
<a id=__codelineno-161-27 name=__codelineno-161-27 href=#__codelineno-161-27></a><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>seek</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-161-28 name=__codelineno-161-28 href=#__codelineno-161-28></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>current</span><span class=p>();</span>
<a id=__codelineno-161-29 name=__codelineno-161-29 href=#__codelineno-161-29></a>
<a id=__codelineno-161-30 name=__codelineno-161-30 href=#__codelineno-161-30></a><span class=c1>// array</span>
<a id=__codelineno-161-31 name=__codelineno-161-31 href=#__codelineno-161-31></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=p>[</span><span class=mi>5</span><span class=p>];</span>
<a id=__codelineno-161-32 name=__codelineno-161-32 href=#__codelineno-161-32></a>
<a id=__codelineno-161-33 name=__codelineno-161-33 href=#__codelineno-161-33></a><span class=c1>// array - isset</span>
<a id=__codelineno-161-34 name=__codelineno-161-34 href=#__codelineno-161-34></a><span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>===</span> <span class=nb>isset</span><span class=p>(</span><span class=nv>$invoices</span><span class=p>[</span><span class=mi>3</span><span class=p>]))</span> <span class=p>{</span>
<a id=__codelineno-161-35 name=__codelineno-161-35 href=#__codelineno-161-35></a>   <span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
<a id=__codelineno-161-36 name=__codelineno-161-36 href=#__codelineno-161-36></a><span class=p>}</span>
<a id=__codelineno-161-37 name=__codelineno-161-37 href=#__codelineno-161-37></a>
<a id=__codelineno-161-38 name=__codelineno-161-38 href=#__codelineno-161-38></a><span class=c1>// First</span>
<a id=__codelineno-161-39 name=__codelineno-161-39 href=#__codelineno-161-39></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>getFirst</span><span class=p>();</span>
<a id=__codelineno-161-40 name=__codelineno-161-40 href=#__codelineno-161-40></a>
<a id=__codelineno-161-41 name=__codelineno-161-41 href=#__codelineno-161-41></a><span class=c1>// Last</span>
<a id=__codelineno-161-42 name=__codelineno-161-42 href=#__codelineno-161-42></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>getLast</span><span class=p>();</span>
</code></pre></div> <p>Phalcon's resultsets emulate scrollable cursors. You can get any row just by accessing its position or seeking the internal pointer to a specific position.</p> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Some database systems do not support scrollable cursors. This forces Phalcon to re-execute the query, in order to rewind the cursor to the beginning and obtain the record at the requested position. Similarly, if a resultset is traversed several times, the query must be executed the same number of times.</p> </div> <p>Storing large query results in memory will consume many resources. You can however instruct Phalcon to fetch data in chunks of rows, thus reducing the need to re-execute the request in many cases. You can achieve that by setting the <code>orm.resultset_prefetch_records</code> setup value. This can be done either in <code>php.ini</code> or in the model <code>setup()</code>. More information about this can be found in the <a href=#disablingenabling-features>features</a> section.</p> <p>Note that resultsets can be serialized and stored in a cache backend. <a href=../cache/ >Phalcon\Cache\Cache</a> can help with that task. However, serializing data causes <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> to retrieve all the data from the database in an array, thus consuming more memory while this process takes place.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-162-1 name=__codelineno-162-1 href=#__codelineno-162-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-162-2 name=__codelineno-162-2 href=#__codelineno-162-2></a>
<a id=__codelineno-162-3 name=__codelineno-162-3 href=#__codelineno-162-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-162-4 name=__codelineno-162-4 href=#__codelineno-162-4></a>
<a id=__codelineno-162-5 name=__codelineno-162-5 href=#__codelineno-162-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
<a id=__codelineno-162-6 name=__codelineno-162-6 href=#__codelineno-162-6></a>
<a id=__codelineno-162-7 name=__codelineno-162-7 href=#__codelineno-162-7></a><span class=nb>file_put_contents</span><span class=p>(</span>
<a id=__codelineno-162-8 name=__codelineno-162-8 href=#__codelineno-162-8></a>    <span class=s1>&#39;invoices.cache&#39;</span><span class=p>,</span>
<a id=__codelineno-162-9 name=__codelineno-162-9 href=#__codelineno-162-9></a>    <span class=nb>serialize</span><span class=p>(</span><span class=nv>$invoices</span><span class=p>)</span>
<a id=__codelineno-162-10 name=__codelineno-162-10 href=#__codelineno-162-10></a><span class=p>);</span>
<a id=__codelineno-162-11 name=__codelineno-162-11 href=#__codelineno-162-11></a>
<a id=__codelineno-162-12 name=__codelineno-162-12 href=#__codelineno-162-12></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nb>unserialize</span><span class=p>(</span>
<a id=__codelineno-162-13 name=__codelineno-162-13 href=#__codelineno-162-13></a>    <span class=nb>file_get_contents</span><span class=p>(</span><span class=s1>&#39;invoices.cache&#39;</span><span class=p>)</span>
<a id=__codelineno-162-14 name=__codelineno-162-14 href=#__codelineno-162-14></a><span class=p>);</span>
<a id=__codelineno-162-15 name=__codelineno-162-15 href=#__codelineno-162-15></a>
<a id=__codelineno-162-16 name=__codelineno-162-16 href=#__codelineno-162-16></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-162-17 name=__codelineno-162-17 href=#__codelineno-162-17></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span><span class=p>;</span>
<a id=__codelineno-162-18 name=__codelineno-162-18 href=#__codelineno-162-18></a><span class=p>}</span>
</code></pre></div> <h3 id=custom-resultsets>Custom Resultsets<a class=headerlink href=#custom-resultsets title="Permanent link">&para;</a></h3> <p>There are times when the application logic requires additional manipulation of the data as it is retrieved from the database. Previously, we would just extend the model and encapsulate the functionality in a class in the model or a trait, returning to the caller usually an array of transformed data.</p> <p>With custom resultsets, you no longer need to do that. The custom resultset will encapsulate the functionality, that otherwise would be in the model, and can be reused by other models, thus keeping the code <a href=https://en.wikipedia.org/wiki/Don%27t_repeat_yourself>DRY</a>. This way, the <code>find()</code> method will no longer return the default <a href=../api/phalcon_mvc/#mvcmodelresultset-->Phalcon\Mvc\Model\Resultset</a>, but instead the custom one. Phalcon allows you to do this by using the <code>getResultsetClass()</code> in your model.</p> <p>First, we need to define the resultset class: <div class=highlight><pre><span></span><code><a id=__codelineno-163-1 name=__codelineno-163-1 href=#__codelineno-163-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-163-2 name=__codelineno-163-2 href=#__codelineno-163-2></a>
<a id=__codelineno-163-3 name=__codelineno-163-3 href=#__codelineno-163-3></a><span class=k>namespace</span> <span class=nx>MyApp\Mvc\Model\Resultset</span><span class=p>;</span>
<a id=__codelineno-163-4 name=__codelineno-163-4 href=#__codelineno-163-4></a>
<a id=__codelineno-163-5 name=__codelineno-163-5 href=#__codelineno-163-5></a><span class=k>use</span> <span class=nx>\Phalcon\Mvc\Model\Resultset\Simple</span><span class=p>;</span>
<a id=__codelineno-163-6 name=__codelineno-163-6 href=#__codelineno-163-6></a>
<a id=__codelineno-163-7 name=__codelineno-163-7 href=#__codelineno-163-7></a><span class=k>class</span> <span class=nc>Custom</span> <span class=k>extends</span> <span class=nx>Simple</span>
<a id=__codelineno-163-8 name=__codelineno-163-8 href=#__codelineno-163-8></a><span class=p>{</span>
<a id=__codelineno-163-9 name=__codelineno-163-9 href=#__codelineno-163-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>calculate</span><span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-163-10 name=__codelineno-163-10 href=#__codelineno-163-10></a>        <span class=c1>// ....</span>
<a id=__codelineno-163-11 name=__codelineno-163-11 href=#__codelineno-163-11></a>    <span class=p>}</span>
<a id=__codelineno-163-12 name=__codelineno-163-12 href=#__codelineno-163-12></a><span class=p>}</span>
</code></pre></div></p> <p>In the model, we set the class in the <code>getResultsetClass()</code> as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-164-1 name=__codelineno-164-1 href=#__codelineno-164-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-164-2 name=__codelineno-164-2 href=#__codelineno-164-2></a>
<a id=__codelineno-164-3 name=__codelineno-164-3 href=#__codelineno-164-3></a><span class=k>namespace</span> <span class=nx>Phalcon\Test\Models\Statistics</span><span class=p>;</span>
<a id=__codelineno-164-4 name=__codelineno-164-4 href=#__codelineno-164-4></a>
<a id=__codelineno-164-5 name=__codelineno-164-5 href=#__codelineno-164-5></a><span class=k>use</span> <span class=nx>MyApp\Mvc\Model\Resultset\Custom</span><span class=p>;</span>
<a id=__codelineno-164-6 name=__codelineno-164-6 href=#__codelineno-164-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-164-7 name=__codelineno-164-7 href=#__codelineno-164-7></a>
<a id=__codelineno-164-8 name=__codelineno-164-8 href=#__codelineno-164-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-164-9 name=__codelineno-164-9 href=#__codelineno-164-9></a><span class=p>{</span>
<a id=__codelineno-164-10 name=__codelineno-164-10 href=#__codelineno-164-10></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-164-11 name=__codelineno-164-11 href=#__codelineno-164-11></a>    <span class=p>{</span>
<a id=__codelineno-164-12 name=__codelineno-164-12 href=#__codelineno-164-12></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setSource</span><span class=p>(</span><span class=s1>&#39;co_invoices&#39;</span><span class=p>);</span>
<a id=__codelineno-164-13 name=__codelineno-164-13 href=#__codelineno-164-13></a>    <span class=p>}</span>
<a id=__codelineno-164-14 name=__codelineno-164-14 href=#__codelineno-164-14></a>
<a id=__codelineno-164-15 name=__codelineno-164-15 href=#__codelineno-164-15></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getResultsetClass</span><span class=p>()</span>
<a id=__codelineno-164-16 name=__codelineno-164-16 href=#__codelineno-164-16></a>    <span class=p>{</span>
<a id=__codelineno-164-17 name=__codelineno-164-17 href=#__codelineno-164-17></a>        <span class=k>return</span> <span class=nx>Custom</span><span class=o>::</span><span class=na>class</span><span class=p>;</span>
<a id=__codelineno-164-18 name=__codelineno-164-18 href=#__codelineno-164-18></a>    <span class=p>}</span>
<a id=__codelineno-164-19 name=__codelineno-164-19 href=#__codelineno-164-19></a><span class=p>}</span>
</code></pre></div> <p>and finally, in your code, you will have something like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-165-1 name=__codelineno-165-1 href=#__codelineno-165-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-165-2 name=__codelineno-165-2 href=#__codelineno-165-2></a>
<a id=__codelineno-165-3 name=__codelineno-165-3 href=#__codelineno-165-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-165-4 name=__codelineno-165-4 href=#__codelineno-165-4></a>
<a id=__codelineno-165-5 name=__codelineno-165-5 href=#__codelineno-165-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-165-6 name=__codelineno-165-6 href=#__codelineno-165-6></a>    <span class=p>[</span>
<a id=__codelineno-165-7 name=__codelineno-165-7 href=#__codelineno-165-7></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :cst_id:&#39;</span><span class=p>,</span>
<a id=__codelineno-165-8 name=__codelineno-165-8 href=#__codelineno-165-8></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-165-9 name=__codelineno-165-9 href=#__codelineno-165-9></a>            <span class=s1>&#39;cst_id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-165-10 name=__codelineno-165-10 href=#__codelineno-165-10></a>        <span class=p>],</span>
<a id=__codelineno-165-11 name=__codelineno-165-11 href=#__codelineno-165-11></a>    <span class=p>]</span>
<a id=__codelineno-165-12 name=__codelineno-165-12 href=#__codelineno-165-12></a><span class=p>);</span>
<a id=__codelineno-165-13 name=__codelineno-165-13 href=#__codelineno-165-13></a>
<a id=__codelineno-165-14 name=__codelineno-165-14 href=#__codelineno-165-14></a><span class=nv>$calculated</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>calculate</span><span class=p>();</span>
</code></pre></div> <h3 id=filtering-resultsets>Filtering Resultsets<a class=headerlink href=#filtering-resultsets title="Permanent link">&para;</a></h3> <p>The most efficient way to filter data is by setting some search criteria, databases will use indexes set on tables to return data faster. Phalcon additionally allows you to filter the data using PHP:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-166-1 name=__codelineno-166-1 href=#__codelineno-166-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-166-2 name=__codelineno-166-2 href=#__codelineno-166-2></a>
<a id=__codelineno-166-3 name=__codelineno-166-3 href=#__codelineno-166-3></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
<a id=__codelineno-166-4 name=__codelineno-166-4 href=#__codelineno-166-4></a>
<a id=__codelineno-166-5 name=__codelineno-166-5 href=#__codelineno-166-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>filter</span><span class=p>(</span>
<a id=__codelineno-166-6 name=__codelineno-166-6 href=#__codelineno-166-6></a>    <span class=k>function</span> <span class=p>(</span><span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-166-7 name=__codelineno-166-7 href=#__codelineno-166-7></a>        <span class=k>if</span> <span class=p>(</span><span class=mi>1</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-166-8 name=__codelineno-166-8 href=#__codelineno-166-8></a>            <span class=k>return</span> <span class=nv>$invoice</span><span class=p>;</span>
<a id=__codelineno-166-9 name=__codelineno-166-9 href=#__codelineno-166-9></a>        <span class=p>}</span>
<a id=__codelineno-166-10 name=__codelineno-166-10 href=#__codelineno-166-10></a>    <span class=p>}</span>
<a id=__codelineno-166-11 name=__codelineno-166-11 href=#__codelineno-166-11></a><span class=p>);</span>
</code></pre></div> <p>The above example will return only the paid invoices from our table (<code>inv_status_flag = 1</code>);</p> <h3 id=binding-parameters>Binding Parameters<a class=headerlink href=#binding-parameters title="Permanent link">&para;</a></h3> <p>Bound parameters are also supported in <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a>. You are encouraged to use this methodology to eliminate the possibility of your code being subject to SQL injection attacks. Both <code>string</code> and <code>integer</code> placeholders are supported.</p> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>When using <code>integer</code> placeholders you must prefix them with <code>?</code> (<code>?0</code>, <code>?1</code>). When using <code>string</code> placeholders you must enclose the string in <code>:</code> (<code>:name:</code>, <code>:total:</code>). </p> </div> <p>Some examples:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-167-1 name=__codelineno-167-1 href=#__codelineno-167-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-167-2 name=__codelineno-167-2 href=#__codelineno-167-2></a>
<a id=__codelineno-167-3 name=__codelineno-167-3 href=#__codelineno-167-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-167-4 name=__codelineno-167-4 href=#__codelineno-167-4></a>
<a id=__codelineno-167-5 name=__codelineno-167-5 href=#__codelineno-167-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-167-6 name=__codelineno-167-6 href=#__codelineno-167-6></a>    <span class=p>[</span>
<a id=__codelineno-167-7 name=__codelineno-167-7 href=#__codelineno-167-7></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_title LIKE :title: AND &#39;</span> <span class=o>.</span>
<a id=__codelineno-167-8 name=__codelineno-167-8 href=#__codelineno-167-8></a>                         <span class=s1>&#39;inv_total &gt; :total:&#39;</span><span class=p>,</span>
<a id=__codelineno-167-9 name=__codelineno-167-9 href=#__codelineno-167-9></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-167-10 name=__codelineno-167-10 href=#__codelineno-167-10></a>            <span class=s1>&#39;title&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;%ACME%&#39;</span><span class=p>,</span>
<a id=__codelineno-167-11 name=__codelineno-167-11 href=#__codelineno-167-11></a>            <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-167-12 name=__codelineno-167-12 href=#__codelineno-167-12></a>        <span class=p>],</span>
<a id=__codelineno-167-13 name=__codelineno-167-13 href=#__codelineno-167-13></a>    <span class=p>]</span>
<a id=__codelineno-167-14 name=__codelineno-167-14 href=#__codelineno-167-14></a><span class=p>);</span>
<a id=__codelineno-167-15 name=__codelineno-167-15 href=#__codelineno-167-15></a>
<a id=__codelineno-167-16 name=__codelineno-167-16 href=#__codelineno-167-16></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-167-17 name=__codelineno-167-17 href=#__codelineno-167-17></a>    <span class=p>[</span>
<a id=__codelineno-167-18 name=__codelineno-167-18 href=#__codelineno-167-18></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_title LIKE ?0 = ?0 AND &#39;</span> <span class=o>.</span>
<a id=__codelineno-167-19 name=__codelineno-167-19 href=#__codelineno-167-19></a>                         <span class=s1>&#39;inv_total &gt; ?1&#39;</span><span class=p>,</span>
<a id=__codelineno-167-20 name=__codelineno-167-20 href=#__codelineno-167-20></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-167-21 name=__codelineno-167-21 href=#__codelineno-167-21></a>            <span class=mi>0</span> <span class=o>=&gt;</span> <span class=s1>&#39;%ACME%&#39;</span><span class=p>,</span>
<a id=__codelineno-167-22 name=__codelineno-167-22 href=#__codelineno-167-22></a>            <span class=mi>1</span> <span class=o>=&gt;</span> <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-167-23 name=__codelineno-167-23 href=#__codelineno-167-23></a>        <span class=p>],</span>
<a id=__codelineno-167-24 name=__codelineno-167-24 href=#__codelineno-167-24></a>    <span class=p>]</span>
<a id=__codelineno-167-25 name=__codelineno-167-25 href=#__codelineno-167-25></a><span class=p>);</span>
<a id=__codelineno-167-26 name=__codelineno-167-26 href=#__codelineno-167-26></a>
<a id=__codelineno-167-27 name=__codelineno-167-27 href=#__codelineno-167-27></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-167-28 name=__codelineno-167-28 href=#__codelineno-167-28></a>    <span class=p>[</span>
<a id=__codelineno-167-29 name=__codelineno-167-29 href=#__codelineno-167-29></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_title = ?0 AND &#39;</span> <span class=o>.</span>
<a id=__codelineno-167-30 name=__codelineno-167-30 href=#__codelineno-167-30></a>                         <span class=s1>&#39;inv_total &gt; :total:&#39;</span><span class=p>,</span>
<a id=__codelineno-167-31 name=__codelineno-167-31 href=#__codelineno-167-31></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-167-32 name=__codelineno-167-32 href=#__codelineno-167-32></a>            <span class=mi>0</span>       <span class=o>=&gt;</span> <span class=s1>&#39;%ACME%&#39;</span><span class=p>,</span>
<a id=__codelineno-167-33 name=__codelineno-167-33 href=#__codelineno-167-33></a>            <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-167-34 name=__codelineno-167-34 href=#__codelineno-167-34></a>        <span class=p>],</span>
<a id=__codelineno-167-35 name=__codelineno-167-35 href=#__codelineno-167-35></a>    <span class=p>]</span>
<a id=__codelineno-167-36 name=__codelineno-167-36 href=#__codelineno-167-36></a><span class=p>);</span>
</code></pre></div> <p>Strings are automatically escaped using <a href=https://php.net/manual/en/pdo.prepared-statements.php>PDO</a>. This function takes into account the connection charset, therefore it is recommended to define the correct charset in the connection parameters or in the database configuration, as a wrong charset will produce undesired effects when storing or retrieving data.</p> <p>Additionally, you can set the parameter <code>bindTypes</code>, this allows defining how the parameters should be bound according to their data type:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-168-1 name=__codelineno-168-1 href=#__codelineno-168-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-168-2 name=__codelineno-168-2 href=#__codelineno-168-2></a>
<a id=__codelineno-168-3 name=__codelineno-168-3 href=#__codelineno-168-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-168-4 name=__codelineno-168-4 href=#__codelineno-168-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Column</span><span class=p>;</span>
<a id=__codelineno-168-5 name=__codelineno-168-5 href=#__codelineno-168-5></a>
<a id=__codelineno-168-6 name=__codelineno-168-6 href=#__codelineno-168-6></a><span class=nv>$parameters</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-168-7 name=__codelineno-168-7 href=#__codelineno-168-7></a>    <span class=s1>&#39;title&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;%ACME%&#39;</span><span class=p>,</span>
<a id=__codelineno-168-8 name=__codelineno-168-8 href=#__codelineno-168-8></a>    <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-168-9 name=__codelineno-168-9 href=#__codelineno-168-9></a><span class=p>];</span>
<a id=__codelineno-168-10 name=__codelineno-168-10 href=#__codelineno-168-10></a>
<a id=__codelineno-168-11 name=__codelineno-168-11 href=#__codelineno-168-11></a><span class=nv>$types</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-168-12 name=__codelineno-168-12 href=#__codelineno-168-12></a>    <span class=s1>&#39;title&#39;</span> <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>BIND_PARAM_STR</span><span class=p>,</span>
<a id=__codelineno-168-13 name=__codelineno-168-13 href=#__codelineno-168-13></a>    <span class=s1>&#39;total&#39;</span> <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>BIND_PARAM_INT</span><span class=p>,</span>
<a id=__codelineno-168-14 name=__codelineno-168-14 href=#__codelineno-168-14></a><span class=p>];</span>
<a id=__codelineno-168-15 name=__codelineno-168-15 href=#__codelineno-168-15></a>
<a id=__codelineno-168-16 name=__codelineno-168-16 href=#__codelineno-168-16></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-168-17 name=__codelineno-168-17 href=#__codelineno-168-17></a>    <span class=p>[</span>
<a id=__codelineno-168-18 name=__codelineno-168-18 href=#__codelineno-168-18></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_title LIKE :title: AND &#39;</span> <span class=o>.</span>
<a id=__codelineno-168-19 name=__codelineno-168-19 href=#__codelineno-168-19></a>                         <span class=s1>&#39;inv_total &gt; :total:&#39;</span><span class=p>,</span>
<a id=__codelineno-168-20 name=__codelineno-168-20 href=#__codelineno-168-20></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>,</span>
<a id=__codelineno-168-21 name=__codelineno-168-21 href=#__codelineno-168-21></a>        <span class=s1>&#39;bindTypes&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$types</span><span class=p>,</span>
<a id=__codelineno-168-22 name=__codelineno-168-22 href=#__codelineno-168-22></a>    <span class=p>]</span>
<a id=__codelineno-168-23 name=__codelineno-168-23 href=#__codelineno-168-23></a><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Since the default bind type is <code>Phalcon\Db\Column::BIND_PARAM_STR</code>, there is no need to specify the 'bindTypes' parameter if all the columns are strings</p> </div> <p>You can also bind arrays in the parameters, especially when using the <code>IN</code> SQL keyword.</p> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>You need to use a zero-based array for arrays without missing elements </p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-169-1 name=__codelineno-169-1 href=#__codelineno-169-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-169-2 name=__codelineno-169-2 href=#__codelineno-169-2></a>
<a id=__codelineno-169-3 name=__codelineno-169-3 href=#__codelineno-169-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-169-4 name=__codelineno-169-4 href=#__codelineno-169-4></a>
<a id=__codelineno-169-5 name=__codelineno-169-5 href=#__codelineno-169-5></a><span class=nv>$customerIds</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>];</span> <span class=c1>// $array: [[0] =&gt; 1, [1] =&gt; 2, [2] =&gt; 4]</span>
<a id=__codelineno-169-6 name=__codelineno-169-6 href=#__codelineno-169-6></a>
<a id=__codelineno-169-7 name=__codelineno-169-7 href=#__codelineno-169-7></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-169-8 name=__codelineno-169-8 href=#__codelineno-169-8></a>    <span class=p>[</span>
<a id=__codelineno-169-9 name=__codelineno-169-9 href=#__codelineno-169-9></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id IN ({customerId:array})&#39;</span><span class=p>,</span>
<a id=__codelineno-169-10 name=__codelineno-169-10 href=#__codelineno-169-10></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-169-11 name=__codelineno-169-11 href=#__codelineno-169-11></a>            <span class=s1>&#39;customerId&#39;</span> <span class=o>=&gt;</span> <span class=nv>$customerIds</span><span class=p>,</span>
<a id=__codelineno-169-12 name=__codelineno-169-12 href=#__codelineno-169-12></a>        <span class=p>],</span>
<a id=__codelineno-169-13 name=__codelineno-169-13 href=#__codelineno-169-13></a>    <span class=p>]</span>
<a id=__codelineno-169-14 name=__codelineno-169-14 href=#__codelineno-169-14></a><span class=p>);</span>
<a id=__codelineno-169-15 name=__codelineno-169-15 href=#__codelineno-169-15></a>
<a id=__codelineno-169-16 name=__codelineno-169-16 href=#__codelineno-169-16></a><span class=nb>unset</span><span class=p>(</span><span class=nv>$customerIds</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>  <span class=c1>// $array: [[0] =&gt; 1, [2] =&gt; 4]</span>
<a id=__codelineno-169-17 name=__codelineno-169-17 href=#__codelineno-169-17></a>
<a id=__codelineno-169-18 name=__codelineno-169-18 href=#__codelineno-169-18></a><span class=nv>$customerIds</span> <span class=o>=</span> <span class=nb>array_values</span><span class=p>(</span><span class=nv>$customerIds</span><span class=p>);</span>  <span class=c1>// $array: [[0] =&gt; 1, [1] =&gt; 4]</span>
<a id=__codelineno-169-19 name=__codelineno-169-19 href=#__codelineno-169-19></a>
<a id=__codelineno-169-20 name=__codelineno-169-20 href=#__codelineno-169-20></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-169-21 name=__codelineno-169-21 href=#__codelineno-169-21></a>    <span class=p>[</span>
<a id=__codelineno-169-22 name=__codelineno-169-22 href=#__codelineno-169-22></a>        <span class=s1>&#39;conditions&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id IN ({customerId:array})&#39;</span><span class=p>,</span>
<a id=__codelineno-169-23 name=__codelineno-169-23 href=#__codelineno-169-23></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-169-24 name=__codelineno-169-24 href=#__codelineno-169-24></a>            <span class=s1>&#39;customerId&#39;</span> <span class=o>=&gt;</span> <span class=nv>$customerIds</span><span class=p>,</span>
<a id=__codelineno-169-25 name=__codelineno-169-25 href=#__codelineno-169-25></a>        <span class=p>],</span>
<a id=__codelineno-169-26 name=__codelineno-169-26 href=#__codelineno-169-26></a>    <span class=p>]</span>
<a id=__codelineno-169-27 name=__codelineno-169-27 href=#__codelineno-169-27></a><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Bound parameters are available for all query methods such as <code>find()</code> and <code>findFirst()</code> but also the calculation methods like <code>count()</code>, <code>sum()</code>, <code>average()</code> etc.</p> </div> <p>If you're using <em>finders</em> e.g. <code>find()</code>, <code>findFirst()</code>, etc., you can inject the bound parameters when using the string syntax for the first parameter instead of using the <code>conditions</code> array element. Also, when using <code>findFirstBy*</code> the parameters are automatically bound.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-170-1 name=__codelineno-170-1 href=#__codelineno-170-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-170-2 name=__codelineno-170-2 href=#__codelineno-170-2></a>
<a id=__codelineno-170-3 name=__codelineno-170-3 href=#__codelineno-170-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-170-4 name=__codelineno-170-4 href=#__codelineno-170-4></a>
<a id=__codelineno-170-5 name=__codelineno-170-5 href=#__codelineno-170-5></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-170-6 name=__codelineno-170-6 href=#__codelineno-170-6></a>    <span class=s1>&#39;inv_total &gt; ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-170-7 name=__codelineno-170-7 href=#__codelineno-170-7></a>    <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-170-8 name=__codelineno-170-8 href=#__codelineno-170-8></a>        <span class=mi>1000</span><span class=p>,</span>
<a id=__codelineno-170-9 name=__codelineno-170-9 href=#__codelineno-170-9></a>    <span class=p>]</span>
<a id=__codelineno-170-10 name=__codelineno-170-10 href=#__codelineno-170-10></a><span class=p>);</span>
<a id=__codelineno-170-11 name=__codelineno-170-11 href=#__codelineno-170-11></a>
<a id=__codelineno-170-12 name=__codelineno-170-12 href=#__codelineno-170-12></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findByInvTotal</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</code></pre></div> <h2 id=beforeafter-fetching>Before/After Fetching<a class=headerlink href=#beforeafter-fetching title="Permanent link">&para;</a></h2> <p>There are cases where we need to manipulate the data after it has been fetched from the database so that our model contains what we need in the application layer. As seen in the <a href=../events/ >events</a> document, models act as listeners, so we can implement some events as methods in the model.</p> <p>Such methods include <code>beforeSave</code>, <code>afterSave</code>, and <code>afterFetch</code> as shown in our example below. The <code>afterFetch</code> method will run right after the data populates the model from the database. We can utilize this method to modify or transform the data in the model.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-171-1 name=__codelineno-171-1 href=#__codelineno-171-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-171-2 name=__codelineno-171-2 href=#__codelineno-171-2></a>
<a id=__codelineno-171-3 name=__codelineno-171-3 href=#__codelineno-171-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-171-4 name=__codelineno-171-4 href=#__codelineno-171-4></a>
<a id=__codelineno-171-5 name=__codelineno-171-5 href=#__codelineno-171-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-171-6 name=__codelineno-171-6 href=#__codelineno-171-6></a>
<a id=__codelineno-171-7 name=__codelineno-171-7 href=#__codelineno-171-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-171-8 name=__codelineno-171-8 href=#__codelineno-171-8></a><span class=p>{</span>
<a id=__codelineno-171-9 name=__codelineno-171-9 href=#__codelineno-171-9></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-171-10 name=__codelineno-171-10 href=#__codelineno-171-10></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-171-11 name=__codelineno-171-11 href=#__codelineno-171-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-171-12 name=__codelineno-171-12 href=#__codelineno-171-12></a>    <span class=k>public</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-171-13 name=__codelineno-171-13 href=#__codelineno-171-13></a>    <span class=k>public</span> <span class=nv>$status</span><span class=p>;</span>
<a id=__codelineno-171-14 name=__codelineno-171-14 href=#__codelineno-171-14></a>
<a id=__codelineno-171-15 name=__codelineno-171-15 href=#__codelineno-171-15></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeSave</span><span class=p>()</span>
<a id=__codelineno-171-16 name=__codelineno-171-16 href=#__codelineno-171-16></a>    <span class=p>{</span>
<a id=__codelineno-171-17 name=__codelineno-171-17 href=#__codelineno-171-17></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span> <span class=o>=</span> <span class=nb>join</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span><span class=p>);</span>
<a id=__codelineno-171-18 name=__codelineno-171-18 href=#__codelineno-171-18></a>    <span class=p>}</span>
<a id=__codelineno-171-19 name=__codelineno-171-19 href=#__codelineno-171-19></a>
<a id=__codelineno-171-20 name=__codelineno-171-20 href=#__codelineno-171-20></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>afterFetch</span><span class=p>()</span>
<a id=__codelineno-171-21 name=__codelineno-171-21 href=#__codelineno-171-21></a>    <span class=p>{</span>
<a id=__codelineno-171-22 name=__codelineno-171-22 href=#__codelineno-171-22></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span> <span class=o>=</span> <span class=nb>explode</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span><span class=p>);</span>
<a id=__codelineno-171-23 name=__codelineno-171-23 href=#__codelineno-171-23></a>    <span class=p>}</span>
<a id=__codelineno-171-24 name=__codelineno-171-24 href=#__codelineno-171-24></a>
<a id=__codelineno-171-25 name=__codelineno-171-25 href=#__codelineno-171-25></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>afterSave</span><span class=p>()</span>
<a id=__codelineno-171-26 name=__codelineno-171-26 href=#__codelineno-171-26></a>    <span class=p>{</span>
<a id=__codelineno-171-27 name=__codelineno-171-27 href=#__codelineno-171-27></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span> <span class=o>=</span> <span class=nb>explode</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span><span class=p>);</span>
<a id=__codelineno-171-28 name=__codelineno-171-28 href=#__codelineno-171-28></a>    <span class=p>}</span>
<a id=__codelineno-171-29 name=__codelineno-171-29 href=#__codelineno-171-29></a><span class=p>}</span>
</code></pre></div> In the above example, we receive a comma-delimited string from the database and <code>explode</code> it to an array so that it can be used from our application. After that, you can add or remove elements in the array; before the model saves it, <code>implode</code> will be called to store the array as a string in the database.</p> <p>If you use getters/setters instead of/or together with public properties, you can initialize the field once it is accessed:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-172-1 name=__codelineno-172-1 href=#__codelineno-172-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-172-2 name=__codelineno-172-2 href=#__codelineno-172-2></a>
<a id=__codelineno-172-3 name=__codelineno-172-3 href=#__codelineno-172-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-172-4 name=__codelineno-172-4 href=#__codelineno-172-4></a>
<a id=__codelineno-172-5 name=__codelineno-172-5 href=#__codelineno-172-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-172-6 name=__codelineno-172-6 href=#__codelineno-172-6></a>
<a id=__codelineno-172-7 name=__codelineno-172-7 href=#__codelineno-172-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-172-8 name=__codelineno-172-8 href=#__codelineno-172-8></a><span class=p>{</span>
<a id=__codelineno-172-9 name=__codelineno-172-9 href=#__codelineno-172-9></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-172-10 name=__codelineno-172-10 href=#__codelineno-172-10></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-172-11 name=__codelineno-172-11 href=#__codelineno-172-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-172-12 name=__codelineno-172-12 href=#__codelineno-172-12></a>    <span class=k>public</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-172-13 name=__codelineno-172-13 href=#__codelineno-172-13></a>    <span class=k>public</span> <span class=nv>$status</span><span class=p>;</span>
<a id=__codelineno-172-14 name=__codelineno-172-14 href=#__codelineno-172-14></a>
<a id=__codelineno-172-15 name=__codelineno-172-15 href=#__codelineno-172-15></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getStatus</span><span class=p>()</span>
<a id=__codelineno-172-16 name=__codelineno-172-16 href=#__codelineno-172-16></a>    <span class=p>{</span>
<a id=__codelineno-172-17 name=__codelineno-172-17 href=#__codelineno-172-17></a>        <span class=k>return</span> <span class=nb>explode</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>status</span><span class=p>);</span>
<a id=__codelineno-172-18 name=__codelineno-172-18 href=#__codelineno-172-18></a>    <span class=p>}</span>
<a id=__codelineno-172-19 name=__codelineno-172-19 href=#__codelineno-172-19></a><span class=p>}</span>
</code></pre></div> <h2 id=calculations>Calculations<a class=headerlink href=#calculations title="Permanent link">&para;</a></h2> <p>Calculations (or aggregations) are helpers for commonly used functions of database systems such as <code>COUNT</code>, <code>SUM</code>, <code>MAX</code>, <code>MIN</code>, or <code>AVG</code>. <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> allows to use of these functions directly from the exposed methods.</p> <p><strong><code>COUNT</code></strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-173-1 name=__codelineno-173-1 href=#__codelineno-173-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-173-2 name=__codelineno-173-2 href=#__codelineno-173-2></a>
<a id=__codelineno-173-3 name=__codelineno-173-3 href=#__codelineno-173-3></a><span class=nv>$rowcount</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>();</span>
<a id=__codelineno-173-4 name=__codelineno-173-4 href=#__codelineno-173-4></a>
<a id=__codelineno-173-5 name=__codelineno-173-5 href=#__codelineno-173-5></a><span class=c1>// inv_cst_id = 3</span>
<a id=__codelineno-173-6 name=__codelineno-173-6 href=#__codelineno-173-6></a><span class=nv>$rowcount</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>(</span>
<a id=__codelineno-173-7 name=__codelineno-173-7 href=#__codelineno-173-7></a>    <span class=p>[</span>
<a id=__codelineno-173-8 name=__codelineno-173-8 href=#__codelineno-173-8></a>        <span class=s1>&#39;inv_cst_id = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-173-9 name=__codelineno-173-9 href=#__codelineno-173-9></a>        <span class=s1>&#39;bind&#39;</span>        <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-173-10 name=__codelineno-173-10 href=#__codelineno-173-10></a>            <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-173-11 name=__codelineno-173-11 href=#__codelineno-173-11></a>        <span class=p>],</span>
<a id=__codelineno-173-12 name=__codelineno-173-12 href=#__codelineno-173-12></a>    <span class=p>]</span>
<a id=__codelineno-173-13 name=__codelineno-173-13 href=#__codelineno-173-13></a><span class=p>);</span>
</code></pre></div> <p>We can also use the <code>group</code> parameter to group our results. The count results appear in the <code>rowcount</code> property of each object in the collection returned.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-174-1 name=__codelineno-174-1 href=#__codelineno-174-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-174-2 name=__codelineno-174-2 href=#__codelineno-174-2></a>
<a id=__codelineno-174-3 name=__codelineno-174-3 href=#__codelineno-174-3></a><span class=nv>$group</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>(</span>
<a id=__codelineno-174-4 name=__codelineno-174-4 href=#__codelineno-174-4></a>    <span class=p>[</span>
<a id=__codelineno-174-5 name=__codelineno-174-5 href=#__codelineno-174-5></a>        <span class=s1>&#39;group&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-174-6 name=__codelineno-174-6 href=#__codelineno-174-6></a>    <span class=p>]</span>
<a id=__codelineno-174-7 name=__codelineno-174-7 href=#__codelineno-174-7></a><span class=p>);</span>
<a id=__codelineno-174-8 name=__codelineno-174-8 href=#__codelineno-174-8></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$group</span> <span class=k>as</span> <span class=nv>$row</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-174-9 name=__codelineno-174-9 href=#__codelineno-174-9></a>   <span class=k>echo</span> <span class=s1>&#39;Count: &#39;</span><span class=p>,</span> <span class=nv>$row</span><span class=o>-&gt;</span><span class=na>rowcount</span><span class=p>,</span> <span class=s1>&#39; - Customer: &#39;</span><span class=p>,</span> <span class=nv>$row</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-174-10 name=__codelineno-174-10 href=#__codelineno-174-10></a><span class=p>}</span>
<a id=__codelineno-174-11 name=__codelineno-174-11 href=#__codelineno-174-11></a>
<a id=__codelineno-174-12 name=__codelineno-174-12 href=#__codelineno-174-12></a><span class=nv>$group</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>(</span>
<a id=__codelineno-174-13 name=__codelineno-174-13 href=#__codelineno-174-13></a>    <span class=p>[</span>
<a id=__codelineno-174-14 name=__codelineno-174-14 href=#__codelineno-174-14></a>        <span class=s1>&#39;group&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-174-15 name=__codelineno-174-15 href=#__codelineno-174-15></a>        <span class=s1>&#39;order&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;rowcount&#39;</span><span class=p>,</span>
<a id=__codelineno-174-16 name=__codelineno-174-16 href=#__codelineno-174-16></a>    <span class=p>]</span>
<a id=__codelineno-174-17 name=__codelineno-174-17 href=#__codelineno-174-17></a><span class=p>);</span>
</code></pre></div> <p><strong><code>SUM</code></strong></p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-175-1 name=__codelineno-175-1 href=#__codelineno-175-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-175-2 name=__codelineno-175-2 href=#__codelineno-175-2></a>
<a id=__codelineno-175-3 name=__codelineno-175-3 href=#__codelineno-175-3></a><span class=nv>$total</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-175-4 name=__codelineno-175-4 href=#__codelineno-175-4></a>    <span class=p>[</span>
<a id=__codelineno-175-5 name=__codelineno-175-5 href=#__codelineno-175-5></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-175-6 name=__codelineno-175-6 href=#__codelineno-175-6></a>    <span class=p>]</span>
<a id=__codelineno-175-7 name=__codelineno-175-7 href=#__codelineno-175-7></a><span class=p>);</span>
<a id=__codelineno-175-8 name=__codelineno-175-8 href=#__codelineno-175-8></a>
<a id=__codelineno-175-9 name=__codelineno-175-9 href=#__codelineno-175-9></a><span class=nv>$total</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-175-10 name=__codelineno-175-10 href=#__codelineno-175-10></a>    <span class=p>[</span>
<a id=__codelineno-175-11 name=__codelineno-175-11 href=#__codelineno-175-11></a>        <span class=s1>&#39;column&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;total&#39;</span><span class=p>,</span>
<a id=__codelineno-175-12 name=__codelineno-175-12 href=#__codelineno-175-12></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-175-13 name=__codelineno-175-13 href=#__codelineno-175-13></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-175-14 name=__codelineno-175-14 href=#__codelineno-175-14></a>            <span class=mi>3</span>
<a id=__codelineno-175-15 name=__codelineno-175-15 href=#__codelineno-175-15></a>        <span class=p>]</span>
<a id=__codelineno-175-16 name=__codelineno-175-16 href=#__codelineno-175-16></a>    <span class=p>]</span>
<a id=__codelineno-175-17 name=__codelineno-175-17 href=#__codelineno-175-17></a><span class=p>);</span>
</code></pre></div> You can also group results. The count results appear in the <code>sumatory</code> property of each object in the collection returned.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-176-1 name=__codelineno-176-1 href=#__codelineno-176-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-176-2 name=__codelineno-176-2 href=#__codelineno-176-2></a>
<a id=__codelineno-176-3 name=__codelineno-176-3 href=#__codelineno-176-3></a><span class=nv>$group</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-176-4 name=__codelineno-176-4 href=#__codelineno-176-4></a>    <span class=p>[</span>
<a id=__codelineno-176-5 name=__codelineno-176-5 href=#__codelineno-176-5></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-176-6 name=__codelineno-176-6 href=#__codelineno-176-6></a>        <span class=s1>&#39;group&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-176-7 name=__codelineno-176-7 href=#__codelineno-176-7></a>    <span class=p>]</span>
<a id=__codelineno-176-8 name=__codelineno-176-8 href=#__codelineno-176-8></a><span class=p>);</span>
<a id=__codelineno-176-9 name=__codelineno-176-9 href=#__codelineno-176-9></a>
<a id=__codelineno-176-10 name=__codelineno-176-10 href=#__codelineno-176-10></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$group</span> <span class=k>as</span> <span class=nv>$row</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-176-11 name=__codelineno-176-11 href=#__codelineno-176-11></a>   <span class=k>echo</span> <span class=s1>&#39;Customer: &#39;</span><span class=p>,</span> <span class=nv>$row</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span><span class=p>,</span> <span class=s1>&#39; - Total: &#39;</span><span class=p>,</span> <span class=nv>$row</span><span class=o>-&gt;</span><span class=na>sumatory</span><span class=p>;</span>
<a id=__codelineno-176-12 name=__codelineno-176-12 href=#__codelineno-176-12></a><span class=p>}</span>
<a id=__codelineno-176-13 name=__codelineno-176-13 href=#__codelineno-176-13></a>
<a id=__codelineno-176-14 name=__codelineno-176-14 href=#__codelineno-176-14></a><span class=nv>$group</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>sum</span><span class=p>(</span>
<a id=__codelineno-176-15 name=__codelineno-176-15 href=#__codelineno-176-15></a>    <span class=p>[</span>
<a id=__codelineno-176-16 name=__codelineno-176-16 href=#__codelineno-176-16></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-176-17 name=__codelineno-176-17 href=#__codelineno-176-17></a>        <span class=s1>&#39;group&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-176-18 name=__codelineno-176-18 href=#__codelineno-176-18></a>        <span class=s1>&#39;order&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;sumatory DESC&#39;</span><span class=p>,</span>
<a id=__codelineno-176-19 name=__codelineno-176-19 href=#__codelineno-176-19></a>    <span class=p>]</span>
<a id=__codelineno-176-20 name=__codelineno-176-20 href=#__codelineno-176-20></a><span class=p>);</span>
</code></pre></div> <p><strong><code>AVERAGE</code></strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-177-1 name=__codelineno-177-1 href=#__codelineno-177-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-177-2 name=__codelineno-177-2 href=#__codelineno-177-2></a>
<a id=__codelineno-177-3 name=__codelineno-177-3 href=#__codelineno-177-3></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>average</span><span class=p>(</span>
<a id=__codelineno-177-4 name=__codelineno-177-4 href=#__codelineno-177-4></a>    <span class=p>[</span>
<a id=__codelineno-177-5 name=__codelineno-177-5 href=#__codelineno-177-5></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-177-6 name=__codelineno-177-6 href=#__codelineno-177-6></a>    <span class=p>]</span>
<a id=__codelineno-177-7 name=__codelineno-177-7 href=#__codelineno-177-7></a><span class=p>);</span>
<a id=__codelineno-177-8 name=__codelineno-177-8 href=#__codelineno-177-8></a>
<a id=__codelineno-177-9 name=__codelineno-177-9 href=#__codelineno-177-9></a><span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>average</span><span class=p>(</span>
<a id=__codelineno-177-10 name=__codelineno-177-10 href=#__codelineno-177-10></a>    <span class=p>[</span>
<a id=__codelineno-177-11 name=__codelineno-177-11 href=#__codelineno-177-11></a>        <span class=s1>&#39;column&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-177-12 name=__codelineno-177-12 href=#__codelineno-177-12></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_status_flag = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-177-13 name=__codelineno-177-13 href=#__codelineno-177-13></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-177-14 name=__codelineno-177-14 href=#__codelineno-177-14></a>            <span class=mi>0</span>
<a id=__codelineno-177-15 name=__codelineno-177-15 href=#__codelineno-177-15></a>        <span class=p>]</span>
<a id=__codelineno-177-16 name=__codelineno-177-16 href=#__codelineno-177-16></a>    <span class=p>]</span>
<a id=__codelineno-177-17 name=__codelineno-177-17 href=#__codelineno-177-17></a><span class=p>);</span>
</code></pre></div> <p><strong><code>MAX</code> - <code>MIN</code></strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-178-1 name=__codelineno-178-1 href=#__codelineno-178-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-178-2 name=__codelineno-178-2 href=#__codelineno-178-2></a>
<a id=__codelineno-178-3 name=__codelineno-178-3 href=#__codelineno-178-3></a><span class=nv>$max</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>maximum</span><span class=p>(</span>
<a id=__codelineno-178-4 name=__codelineno-178-4 href=#__codelineno-178-4></a>    <span class=p>[</span>
<a id=__codelineno-178-5 name=__codelineno-178-5 href=#__codelineno-178-5></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-178-6 name=__codelineno-178-6 href=#__codelineno-178-6></a>    <span class=p>]</span>
<a id=__codelineno-178-7 name=__codelineno-178-7 href=#__codelineno-178-7></a><span class=p>);</span>
<a id=__codelineno-178-8 name=__codelineno-178-8 href=#__codelineno-178-8></a>
<a id=__codelineno-178-9 name=__codelineno-178-9 href=#__codelineno-178-9></a><span class=nv>$max</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>maximum</span><span class=p>(</span>
<a id=__codelineno-178-10 name=__codelineno-178-10 href=#__codelineno-178-10></a>    <span class=p>[</span>
<a id=__codelineno-178-11 name=__codelineno-178-11 href=#__codelineno-178-11></a>        <span class=s1>&#39;column&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-178-12 name=__codelineno-178-12 href=#__codelineno-178-12></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_status_flag = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-178-13 name=__codelineno-178-13 href=#__codelineno-178-13></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-178-14 name=__codelineno-178-14 href=#__codelineno-178-14></a>            <span class=mi>0</span>
<a id=__codelineno-178-15 name=__codelineno-178-15 href=#__codelineno-178-15></a>        <span class=p>],</span>
<a id=__codelineno-178-16 name=__codelineno-178-16 href=#__codelineno-178-16></a>    <span class=p>]</span>
<a id=__codelineno-178-17 name=__codelineno-178-17 href=#__codelineno-178-17></a><span class=p>);</span>
<a id=__codelineno-178-18 name=__codelineno-178-18 href=#__codelineno-178-18></a>
<a id=__codelineno-178-19 name=__codelineno-178-19 href=#__codelineno-178-19></a><span class=nv>$min</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>minimum</span><span class=p>(</span>
<a id=__codelineno-178-20 name=__codelineno-178-20 href=#__codelineno-178-20></a>    <span class=p>[</span>
<a id=__codelineno-178-21 name=__codelineno-178-21 href=#__codelineno-178-21></a>        <span class=s1>&#39;column&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-178-22 name=__codelineno-178-22 href=#__codelineno-178-22></a>    <span class=p>]</span>
<a id=__codelineno-178-23 name=__codelineno-178-23 href=#__codelineno-178-23></a><span class=p>);</span>
<a id=__codelineno-178-24 name=__codelineno-178-24 href=#__codelineno-178-24></a>
<a id=__codelineno-178-25 name=__codelineno-178-25 href=#__codelineno-178-25></a><span class=nv>$min</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>minimum</span><span class=p>(</span>
<a id=__codelineno-178-26 name=__codelineno-178-26 href=#__codelineno-178-26></a>    <span class=p>[</span>
<a id=__codelineno-178-27 name=__codelineno-178-27 href=#__codelineno-178-27></a>        <span class=s1>&#39;column&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-178-28 name=__codelineno-178-28 href=#__codelineno-178-28></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_status_flag = ?0&#39;</span><span class=p>,</span>
<a id=__codelineno-178-29 name=__codelineno-178-29 href=#__codelineno-178-29></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-178-30 name=__codelineno-178-30 href=#__codelineno-178-30></a>            <span class=mi>0</span>
<a id=__codelineno-178-31 name=__codelineno-178-31 href=#__codelineno-178-31></a>        <span class=p>],</span>
<a id=__codelineno-178-32 name=__codelineno-178-32 href=#__codelineno-178-32></a>    <span class=p>]</span>
<a id=__codelineno-178-33 name=__codelineno-178-33 href=#__codelineno-178-33></a><span class=p>);</span>
</code></pre></div> <h2 id=creating-updating>Creating - Updating<a class=headerlink href=#creating-updating title="Permanent link">&para;</a></h2> <p>The <code>Phalcon\Mvc\Model::save()</code> method allows you to create/update records according to whether they already exist in the table associated with a model. The save method is called internally by the create and update methods of <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a>. For this to work as expected it is necessary to have properly defined a primary key in the entity to determine whether a record should be created or updated.</p> <p>The method also executes associated validators, virtual foreign keys, and events that are defined in the model:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-179-1 name=__codelineno-179-1 href=#__codelineno-179-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-179-2 name=__codelineno-179-2 href=#__codelineno-179-2></a>
<a id=__codelineno-179-3 name=__codelineno-179-3 href=#__codelineno-179-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-179-4 name=__codelineno-179-4 href=#__codelineno-179-4></a>
<a id=__codelineno-179-5 name=__codelineno-179-5 href=#__codelineno-179-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-179-6 name=__codelineno-179-6 href=#__codelineno-179-6></a>
<a id=__codelineno-179-7 name=__codelineno-179-7 href=#__codelineno-179-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-179-8 name=__codelineno-179-8 href=#__codelineno-179-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-179-9 name=__codelineno-179-9 href=#__codelineno-179-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-179-10 name=__codelineno-179-10 href=#__codelineno-179-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-179-11 name=__codelineno-179-11 href=#__codelineno-179-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-179-12 name=__codelineno-179-12 href=#__codelineno-179-12></a>
<a id=__codelineno-179-13 name=__codelineno-179-13 href=#__codelineno-179-13></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-179-14 name=__codelineno-179-14 href=#__codelineno-179-14></a>
<a id=__codelineno-179-15 name=__codelineno-179-15 href=#__codelineno-179-15></a><span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$result</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-179-16 name=__codelineno-179-16 href=#__codelineno-179-16></a>
<a id=__codelineno-179-17 name=__codelineno-179-17 href=#__codelineno-179-17></a>    <span class=k>echo</span> <span class=s1>&#39;Error saving Invoice: &#39;</span><span class=p>;</span>
<a id=__codelineno-179-18 name=__codelineno-179-18 href=#__codelineno-179-18></a>
<a id=__codelineno-179-19 name=__codelineno-179-19 href=#__codelineno-179-19></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-179-20 name=__codelineno-179-20 href=#__codelineno-179-20></a>
<a id=__codelineno-179-21 name=__codelineno-179-21 href=#__codelineno-179-21></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-179-22 name=__codelineno-179-22 href=#__codelineno-179-22></a>        <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-179-23 name=__codelineno-179-23 href=#__codelineno-179-23></a>    <span class=p>}</span>
<a id=__codelineno-179-24 name=__codelineno-179-24 href=#__codelineno-179-24></a><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-179-25 name=__codelineno-179-25 href=#__codelineno-179-25></a>
<a id=__codelineno-179-26 name=__codelineno-179-26 href=#__codelineno-179-26></a>    <span class=k>echo</span> <span class=s1>&#39;Record Saved&#39;</span><span class=p>;</span>
<a id=__codelineno-179-27 name=__codelineno-179-27 href=#__codelineno-179-27></a><span class=p>}</span>
</code></pre></div> <p>You can also use the <code>assign()</code> method and pass an array of <code>field =&gt; value</code> elements, to avoid assigning each column manually. <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> will check if there are setters implemented for the columns passed in the array, giving priority to them, instead of directly the values of the attributes:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-180-1 name=__codelineno-180-1 href=#__codelineno-180-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-180-2 name=__codelineno-180-2 href=#__codelineno-180-2></a>
<a id=__codelineno-180-3 name=__codelineno-180-3 href=#__codelineno-180-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-180-4 name=__codelineno-180-4 href=#__codelineno-180-4></a>
<a id=__codelineno-180-5 name=__codelineno-180-5 href=#__codelineno-180-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-180-6 name=__codelineno-180-6 href=#__codelineno-180-6></a>
<a id=__codelineno-180-7 name=__codelineno-180-7 href=#__codelineno-180-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-180-8 name=__codelineno-180-8 href=#__codelineno-180-8></a>    <span class=p>[</span>
<a id=__codelineno-180-9 name=__codelineno-180-9 href=#__codelineno-180-9></a>        <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-180-10 name=__codelineno-180-10 href=#__codelineno-180-10></a>        <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-180-11 name=__codelineno-180-11 href=#__codelineno-180-11></a>        <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>,</span>
<a id=__codelineno-180-12 name=__codelineno-180-12 href=#__codelineno-180-12></a>        <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-180-13 name=__codelineno-180-13 href=#__codelineno-180-13></a>        <span class=s1>&#39;inv_created_at&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>,</span>
<a id=__codelineno-180-14 name=__codelineno-180-14 href=#__codelineno-180-14></a>    <span class=p>]</span>
<a id=__codelineno-180-15 name=__codelineno-180-15 href=#__codelineno-180-15></a><span class=p>);</span>
<a id=__codelineno-180-16 name=__codelineno-180-16 href=#__codelineno-180-16></a>
<a id=__codelineno-180-17 name=__codelineno-180-17 href=#__codelineno-180-17></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <p>Values assigned directly, or via the array of attributes, are escaped/sanitized according to the related attribute data type. So you can pass an insecure array without worrying about possible SQL injections:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-181-1 name=__codelineno-181-1 href=#__codelineno-181-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-181-2 name=__codelineno-181-2 href=#__codelineno-181-2></a>
<a id=__codelineno-181-3 name=__codelineno-181-3 href=#__codelineno-181-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-181-4 name=__codelineno-181-4 href=#__codelineno-181-4></a>
<a id=__codelineno-181-5 name=__codelineno-181-5 href=#__codelineno-181-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-181-6 name=__codelineno-181-6 href=#__codelineno-181-6></a>
<a id=__codelineno-181-7 name=__codelineno-181-7 href=#__codelineno-181-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>);</span>
<a id=__codelineno-181-8 name=__codelineno-181-8 href=#__codelineno-181-8></a>
<a id=__codelineno-181-9 name=__codelineno-181-9 href=#__codelineno-181-9></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <div class="admonition danger"> <p class=admonition-title>NOTE</p> <p>Without precautions mass assignment could allow attackers to set any database column's value. Only use this feature if you want to permit a user to insert/update every column in the model, even if those fields are not in the submitted form.</p> </div> <p>You can set an additional parameter in <code>assign</code> to set a whitelist of fields that are only taken into account when doing the mass assignment:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-182-1 name=__codelineno-182-1 href=#__codelineno-182-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-182-2 name=__codelineno-182-2 href=#__codelineno-182-2></a>
<a id=__codelineno-182-3 name=__codelineno-182-3 href=#__codelineno-182-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-182-4 name=__codelineno-182-4 href=#__codelineno-182-4></a>
<a id=__codelineno-182-5 name=__codelineno-182-5 href=#__codelineno-182-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-182-6 name=__codelineno-182-6 href=#__codelineno-182-6></a>
<a id=__codelineno-182-7 name=__codelineno-182-7 href=#__codelineno-182-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>assign</span><span class=p>(</span>
<a id=__codelineno-182-8 name=__codelineno-182-8 href=#__codelineno-182-8></a>    <span class=nv>$_POST</span><span class=p>,</span>
<a id=__codelineno-182-9 name=__codelineno-182-9 href=#__codelineno-182-9></a>    <span class=p>[</span>
<a id=__codelineno-182-10 name=__codelineno-182-10 href=#__codelineno-182-10></a>        <span class=s1>&#39;inv_cst_id&#39;</span><span class=p>,</span>
<a id=__codelineno-182-11 name=__codelineno-182-11 href=#__codelineno-182-11></a>        <span class=s1>&#39;inv_status_flag&#39;</span><span class=p>,</span>
<a id=__codelineno-182-12 name=__codelineno-182-12 href=#__codelineno-182-12></a>        <span class=s1>&#39;inv_title&#39;</span><span class=p>,</span>
<a id=__codelineno-182-13 name=__codelineno-182-13 href=#__codelineno-182-13></a>        <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-182-14 name=__codelineno-182-14 href=#__codelineno-182-14></a>    <span class=p>]</span>
<a id=__codelineno-182-15 name=__codelineno-182-15 href=#__codelineno-182-15></a><span class=p>);</span>
<a id=__codelineno-182-16 name=__codelineno-182-16 href=#__codelineno-182-16></a>
<a id=__codelineno-182-17 name=__codelineno-182-17 href=#__codelineno-182-17></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>On really busy applications, you can use <code>create</code> or <code>update</code> for the respective operations. By using those two methods instead of save, we ensure that data will be saved or not in the database, since those throw exceptions on <code>create</code> if the record already exists, and on <code>update</code> if the record does not exist.</p> </div> <div class=highlight><pre><span></span><code><a id=__codelineno-183-1 name=__codelineno-183-1 href=#__codelineno-183-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-183-2 name=__codelineno-183-2 href=#__codelineno-183-2></a>
<a id=__codelineno-183-3 name=__codelineno-183-3 href=#__codelineno-183-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-183-4 name=__codelineno-183-4 href=#__codelineno-183-4></a>
<a id=__codelineno-183-5 name=__codelineno-183-5 href=#__codelineno-183-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-183-6 name=__codelineno-183-6 href=#__codelineno-183-6></a>
<a id=__codelineno-183-7 name=__codelineno-183-7 href=#__codelineno-183-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_id</span>          <span class=o>=</span> <span class=mi>1234</span><span class=p>;</span>
<a id=__codelineno-183-8 name=__codelineno-183-8 href=#__codelineno-183-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-183-9 name=__codelineno-183-9 href=#__codelineno-183-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-183-10 name=__codelineno-183-10 href=#__codelineno-183-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-183-11 name=__codelineno-183-11 href=#__codelineno-183-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-183-12 name=__codelineno-183-12 href=#__codelineno-183-12></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-183-13 name=__codelineno-183-13 href=#__codelineno-183-13></a>
<a id=__codelineno-183-14 name=__codelineno-183-14 href=#__codelineno-183-14></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>();</span>
<a id=__codelineno-183-15 name=__codelineno-183-15 href=#__codelineno-183-15></a>
<a id=__codelineno-183-16 name=__codelineno-183-16 href=#__codelineno-183-16></a><span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$result</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-183-17 name=__codelineno-183-17 href=#__codelineno-183-17></a>
<a id=__codelineno-183-18 name=__codelineno-183-18 href=#__codelineno-183-18></a>    <span class=k>echo</span> <span class=s1>&#39;Error saving Invoice: &#39;</span><span class=p>;</span>
<a id=__codelineno-183-19 name=__codelineno-183-19 href=#__codelineno-183-19></a>
<a id=__codelineno-183-20 name=__codelineno-183-20 href=#__codelineno-183-20></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-183-21 name=__codelineno-183-21 href=#__codelineno-183-21></a>
<a id=__codelineno-183-22 name=__codelineno-183-22 href=#__codelineno-183-22></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-183-23 name=__codelineno-183-23 href=#__codelineno-183-23></a>        <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-183-24 name=__codelineno-183-24 href=#__codelineno-183-24></a>    <span class=p>}</span>
<a id=__codelineno-183-25 name=__codelineno-183-25 href=#__codelineno-183-25></a><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-183-26 name=__codelineno-183-26 href=#__codelineno-183-26></a>
<a id=__codelineno-183-27 name=__codelineno-183-27 href=#__codelineno-183-27></a>    <span class=k>echo</span> <span class=s1>&#39;Record Updated&#39;</span><span class=p>;</span>
<a id=__codelineno-183-28 name=__codelineno-183-28 href=#__codelineno-183-28></a>
<a id=__codelineno-183-29 name=__codelineno-183-29 href=#__codelineno-183-29></a><span class=p>}</span>
</code></pre></div> <p>The methods <code>create</code> and <code>update</code> also accepts an array of values as parameters.</p> <h2 id=deleting>Deleting<a class=headerlink href=#deleting title="Permanent link">&para;</a></h2> <p>The <code>delete()</code> method allows you to delete a record. It returns a boolean signifying success or failure</p> <div class=highlight><pre><span></span><code><a id=__codelineno-184-1 name=__codelineno-184-1 href=#__codelineno-184-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-184-2 name=__codelineno-184-2 href=#__codelineno-184-2></a>
<a id=__codelineno-184-3 name=__codelineno-184-3 href=#__codelineno-184-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-184-4 name=__codelineno-184-4 href=#__codelineno-184-4></a>
<a id=__codelineno-184-5 name=__codelineno-184-5 href=#__codelineno-184-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-184-6 name=__codelineno-184-6 href=#__codelineno-184-6></a>    <span class=p>[</span>
<a id=__codelineno-184-7 name=__codelineno-184-7 href=#__codelineno-184-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :id:&#39;</span><span class=p>,</span>
<a id=__codelineno-184-8 name=__codelineno-184-8 href=#__codelineno-184-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-184-9 name=__codelineno-184-9 href=#__codelineno-184-9></a>            <span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>4</span><span class=p>,</span>
<a id=__codelineno-184-10 name=__codelineno-184-10 href=#__codelineno-184-10></a>        <span class=p>]</span>
<a id=__codelineno-184-11 name=__codelineno-184-11 href=#__codelineno-184-11></a>    <span class=p>]</span>
<a id=__codelineno-184-12 name=__codelineno-184-12 href=#__codelineno-184-12></a><span class=p>);</span>
<a id=__codelineno-184-13 name=__codelineno-184-13 href=#__codelineno-184-13></a>
<a id=__codelineno-184-14 name=__codelineno-184-14 href=#__codelineno-184-14></a><span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>!==</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-184-15 name=__codelineno-184-15 href=#__codelineno-184-15></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>delete</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-184-16 name=__codelineno-184-16 href=#__codelineno-184-16></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-184-17 name=__codelineno-184-17 href=#__codelineno-184-17></a>
<a id=__codelineno-184-18 name=__codelineno-184-18 href=#__codelineno-184-18></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-184-19 name=__codelineno-184-19 href=#__codelineno-184-19></a>            <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-184-20 name=__codelineno-184-20 href=#__codelineno-184-20></a>        <span class=p>}</span>
<a id=__codelineno-184-21 name=__codelineno-184-21 href=#__codelineno-184-21></a>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-184-22 name=__codelineno-184-22 href=#__codelineno-184-22></a>
<a id=__codelineno-184-23 name=__codelineno-184-23 href=#__codelineno-184-23></a>        <span class=k>echo</span> <span class=s1>&#39;Record Deleted&#39;</span><span class=p>;</span>
<a id=__codelineno-184-24 name=__codelineno-184-24 href=#__codelineno-184-24></a>    <span class=p>}</span>
<a id=__codelineno-184-25 name=__codelineno-184-25 href=#__codelineno-184-25></a><span class=p>}</span>
</code></pre></div> <p>You can also delete many records by traversing a resultset with a <code>foreach</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-185-1 name=__codelineno-185-1 href=#__codelineno-185-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-185-2 name=__codelineno-185-2 href=#__codelineno-185-2></a>
<a id=__codelineno-185-3 name=__codelineno-185-3 href=#__codelineno-185-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-185-4 name=__codelineno-185-4 href=#__codelineno-185-4></a>
<a id=__codelineno-185-5 name=__codelineno-185-5 href=#__codelineno-185-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-185-6 name=__codelineno-185-6 href=#__codelineno-185-6></a>    <span class=p>[</span>
<a id=__codelineno-185-7 name=__codelineno-185-7 href=#__codelineno-185-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :id:&#39;</span><span class=p>,</span>
<a id=__codelineno-185-8 name=__codelineno-185-8 href=#__codelineno-185-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-185-9 name=__codelineno-185-9 href=#__codelineno-185-9></a>            <span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-185-10 name=__codelineno-185-10 href=#__codelineno-185-10></a>        <span class=p>]</span>
<a id=__codelineno-185-11 name=__codelineno-185-11 href=#__codelineno-185-11></a>    <span class=p>]</span>
<a id=__codelineno-185-12 name=__codelineno-185-12 href=#__codelineno-185-12></a><span class=p>);</span>
<a id=__codelineno-185-13 name=__codelineno-185-13 href=#__codelineno-185-13></a>
<a id=__codelineno-185-14 name=__codelineno-185-14 href=#__codelineno-185-14></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-185-15 name=__codelineno-185-15 href=#__codelineno-185-15></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>delete</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-185-16 name=__codelineno-185-16 href=#__codelineno-185-16></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-185-17 name=__codelineno-185-17 href=#__codelineno-185-17></a>
<a id=__codelineno-185-18 name=__codelineno-185-18 href=#__codelineno-185-18></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-185-19 name=__codelineno-185-19 href=#__codelineno-185-19></a>            <span class=k>echo</span> <span class=nv>$message</span> <span class=o>.</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-185-20 name=__codelineno-185-20 href=#__codelineno-185-20></a>        <span class=p>}</span>
<a id=__codelineno-185-21 name=__codelineno-185-21 href=#__codelineno-185-21></a>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-185-22 name=__codelineno-185-22 href=#__codelineno-185-22></a>
<a id=__codelineno-185-23 name=__codelineno-185-23 href=#__codelineno-185-23></a>        <span class=k>echo</span> <span class=s1>&#39;Record Deleted&#39;</span><span class=p>;</span>
<a id=__codelineno-185-24 name=__codelineno-185-24 href=#__codelineno-185-24></a>    <span class=p>}</span>
<a id=__codelineno-185-25 name=__codelineno-185-25 href=#__codelineno-185-25></a><span class=p>}</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Check the <a href=#transactions>transactions</a> section on how you can delete all the records in a loop with one operation</p> </div> <h2 id=hydration-modes>Hydration Modes<a class=headerlink href=#hydration-modes title="Permanent link">&para;</a></h2> <p>As mentioned earlier, resultsets are collections of complete objects. This means that every returned result is an object, representing a row in the database. These documents can be modified and later on, saved to persist the changes in the database.</p> <p>However, there are times that you will need to get the data in a read-only mode, such as in cases of just viewing data. In these cases, it is useful to change the way the records are returned to save resources and increase performance. The strategy used to represent these objects returned in a resultset is called <code>hydration</code>.</p> <p>Phalcon offers three ways of hydrating data:</p> <table> <thead> <tr> <th>Result</th> <th>Mode</th> </tr> </thead> <tbody> <tr> <td>Arrays</td> <td><code>Phalcon\Mvc\Model\Resultset::HYDRATE_ARRAYS</code></td> </tr> <tr> <td>Objects</td> <td><code>Phalcon\Mvc\Model\Resultset::HYDRATE_OBJECTS</code></td> </tr> <tr> <td>Records</td> <td><code>Phalcon\Mvc\Model\Resultset::HYDRATE_RECORDS</code></td> </tr> </tbody> </table> <p>The default hydration mode is to return records (<code>HYDRATE_RECORDS</code>). We can easily change the hydration mode to get arrays or objects back. Changing the hydration mode to anything other than <code>HYDRATE_RECORDS</code> will return objects (or arrays) that have no connection to the database i.e. we will not be able to perform any operations on those objects such as <code>save()</code>, <code>create()</code>, <code>delete()</code> etc.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-186-1 name=__codelineno-186-1 href=#__codelineno-186-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-186-2 name=__codelineno-186-2 href=#__codelineno-186-2></a>
<a id=__codelineno-186-3 name=__codelineno-186-3 href=#__codelineno-186-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-186-4 name=__codelineno-186-4 href=#__codelineno-186-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Resultset</span><span class=p>;</span>
<a id=__codelineno-186-5 name=__codelineno-186-5 href=#__codelineno-186-5></a>
<a id=__codelineno-186-6 name=__codelineno-186-6 href=#__codelineno-186-6></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-186-7 name=__codelineno-186-7 href=#__codelineno-186-7></a>    <span class=p>[</span>
<a id=__codelineno-186-8 name=__codelineno-186-8 href=#__codelineno-186-8></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :id:&#39;</span><span class=p>,</span>
<a id=__codelineno-186-9 name=__codelineno-186-9 href=#__codelineno-186-9></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-186-10 name=__codelineno-186-10 href=#__codelineno-186-10></a>            <span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>4</span><span class=p>,</span>
<a id=__codelineno-186-11 name=__codelineno-186-11 href=#__codelineno-186-11></a>        <span class=p>]</span>
<a id=__codelineno-186-12 name=__codelineno-186-12 href=#__codelineno-186-12></a>    <span class=p>]</span>
<a id=__codelineno-186-13 name=__codelineno-186-13 href=#__codelineno-186-13></a><span class=p>);</span>
<a id=__codelineno-186-14 name=__codelineno-186-14 href=#__codelineno-186-14></a>
<a id=__codelineno-186-15 name=__codelineno-186-15 href=#__codelineno-186-15></a><span class=c1>// Array</span>
<a id=__codelineno-186-16 name=__codelineno-186-16 href=#__codelineno-186-16></a><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>setHydrateMode</span><span class=p>(</span>
<a id=__codelineno-186-17 name=__codelineno-186-17 href=#__codelineno-186-17></a>    <span class=nx>Resultset</span><span class=o>::</span><span class=na>HYDRATE_ARRAYS</span>
<a id=__codelineno-186-18 name=__codelineno-186-18 href=#__codelineno-186-18></a><span class=p>);</span>
<a id=__codelineno-186-19 name=__codelineno-186-19 href=#__codelineno-186-19></a>
<a id=__codelineno-186-20 name=__codelineno-186-20 href=#__codelineno-186-20></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-186-21 name=__codelineno-186-21 href=#__codelineno-186-21></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=p>[</span><span class=s1>&#39;inv_total&#39;</span><span class=p>],</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-186-22 name=__codelineno-186-22 href=#__codelineno-186-22></a><span class=p>}</span>
<a id=__codelineno-186-23 name=__codelineno-186-23 href=#__codelineno-186-23></a>
<a id=__codelineno-186-24 name=__codelineno-186-24 href=#__codelineno-186-24></a><span class=c1>// \stdClass</span>
<a id=__codelineno-186-25 name=__codelineno-186-25 href=#__codelineno-186-25></a><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>setHydrateMode</span><span class=p>(</span>
<a id=__codelineno-186-26 name=__codelineno-186-26 href=#__codelineno-186-26></a>    <span class=nx>Resultset</span><span class=o>::</span><span class=na>HYDRATE_OBJECTS</span>
<a id=__codelineno-186-27 name=__codelineno-186-27 href=#__codelineno-186-27></a><span class=p>);</span>
<a id=__codelineno-186-28 name=__codelineno-186-28 href=#__codelineno-186-28></a>
<a id=__codelineno-186-29 name=__codelineno-186-29 href=#__codelineno-186-29></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-186-30 name=__codelineno-186-30 href=#__codelineno-186-30></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-186-31 name=__codelineno-186-31 href=#__codelineno-186-31></a><span class=p>}</span>
<a id=__codelineno-186-32 name=__codelineno-186-32 href=#__codelineno-186-32></a>
<a id=__codelineno-186-33 name=__codelineno-186-33 href=#__codelineno-186-33></a><span class=c1>// Invoices</span>
<a id=__codelineno-186-34 name=__codelineno-186-34 href=#__codelineno-186-34></a><span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>setHydrateMode</span><span class=p>(</span>
<a id=__codelineno-186-35 name=__codelineno-186-35 href=#__codelineno-186-35></a>    <span class=nx>Resultset</span><span class=o>::</span><span class=na>HYDRATE_RECORDS</span>
<a id=__codelineno-186-36 name=__codelineno-186-36 href=#__codelineno-186-36></a><span class=p>);</span>
<a id=__codelineno-186-37 name=__codelineno-186-37 href=#__codelineno-186-37></a>
<a id=__codelineno-186-38 name=__codelineno-186-38 href=#__codelineno-186-38></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-186-39 name=__codelineno-186-39 href=#__codelineno-186-39></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-186-40 name=__codelineno-186-40 href=#__codelineno-186-40></a><span class=p>}</span>
</code></pre></div> <p>Hydration mode can also be passed as a parameter of <code>find</code>, <code>findFirst</code>, <code>findFirstBy*</code> etc.:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-187-1 name=__codelineno-187-1 href=#__codelineno-187-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-187-2 name=__codelineno-187-2 href=#__codelineno-187-2></a>
<a id=__codelineno-187-3 name=__codelineno-187-3 href=#__codelineno-187-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-187-4 name=__codelineno-187-4 href=#__codelineno-187-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Resultset</span><span class=p>;</span>
<a id=__codelineno-187-5 name=__codelineno-187-5 href=#__codelineno-187-5></a>
<a id=__codelineno-187-6 name=__codelineno-187-6 href=#__codelineno-187-6></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-187-7 name=__codelineno-187-7 href=#__codelineno-187-7></a>    <span class=p>[</span>
<a id=__codelineno-187-8 name=__codelineno-187-8 href=#__codelineno-187-8></a>        <span class=s1>&#39;hydration&#39;</span>  <span class=o>=&gt;</span> <span class=nx>Resultset</span><span class=o>::</span><span class=na>HYDRATE_ARRAYS</span><span class=p>,</span>
<a id=__codelineno-187-9 name=__codelineno-187-9 href=#__codelineno-187-9></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :id:&#39;</span><span class=p>,</span>
<a id=__codelineno-187-10 name=__codelineno-187-10 href=#__codelineno-187-10></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-187-11 name=__codelineno-187-11 href=#__codelineno-187-11></a>            <span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>4</span><span class=p>,</span>
<a id=__codelineno-187-12 name=__codelineno-187-12 href=#__codelineno-187-12></a>        <span class=p>],</span>
<a id=__codelineno-187-13 name=__codelineno-187-13 href=#__codelineno-187-13></a>    <span class=p>]</span>
<a id=__codelineno-187-14 name=__codelineno-187-14 href=#__codelineno-187-14></a><span class=p>);</span>
<a id=__codelineno-187-15 name=__codelineno-187-15 href=#__codelineno-187-15></a>
<a id=__codelineno-187-16 name=__codelineno-187-16 href=#__codelineno-187-16></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-187-17 name=__codelineno-187-17 href=#__codelineno-187-17></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=p>[</span><span class=s1>&#39;inv_total&#39;</span><span class=p>],</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-187-18 name=__codelineno-187-18 href=#__codelineno-187-18></a><span class=p>}</span>
</code></pre></div> <h2 id=table-prefixes>Table Prefixes<a class=headerlink href=#table-prefixes title="Permanent link">&para;</a></h2> <p>If you want all your tables to have a certain prefix without setting the source in all models, you can use the <a href=../api/phalcon_mvc/#mvcmodelmanager->Phalcon\Mvc\Model\Manager</a> and the method <code>setModelPrefix()</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-188-1 name=__codelineno-188-1 href=#__codelineno-188-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-188-2 name=__codelineno-188-2 href=#__codelineno-188-2></a>
<a id=__codelineno-188-3 name=__codelineno-188-3 href=#__codelineno-188-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-188-4 name=__codelineno-188-4 href=#__codelineno-188-4></a>
<a id=__codelineno-188-5 name=__codelineno-188-5 href=#__codelineno-188-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Manager</span><span class=p>;</span>
<a id=__codelineno-188-6 name=__codelineno-188-6 href=#__codelineno-188-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-188-7 name=__codelineno-188-7 href=#__codelineno-188-7></a>
<a id=__codelineno-188-8 name=__codelineno-188-8 href=#__codelineno-188-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-188-9 name=__codelineno-188-9 href=#__codelineno-188-9></a><span class=p>{</span>
<a id=__codelineno-188-10 name=__codelineno-188-10 href=#__codelineno-188-10></a>
<a id=__codelineno-188-11 name=__codelineno-188-11 href=#__codelineno-188-11></a><span class=p>}</span>
<a id=__codelineno-188-12 name=__codelineno-188-12 href=#__codelineno-188-12></a>
<a id=__codelineno-188-13 name=__codelineno-188-13 href=#__codelineno-188-13></a><span class=nv>$manager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Manager</span><span class=p>();</span>
<a id=__codelineno-188-14 name=__codelineno-188-14 href=#__codelineno-188-14></a>
<a id=__codelineno-188-15 name=__codelineno-188-15 href=#__codelineno-188-15></a><span class=nv>$manager</span><span class=o>-&gt;</span><span class=na>setModelPrefix</span><span class=p>(</span><span class=s1>&#39;co_&#39;</span><span class=p>);</span>
<a id=__codelineno-188-16 name=__codelineno-188-16 href=#__codelineno-188-16></a>
<a id=__codelineno-188-17 name=__codelineno-188-17 href=#__codelineno-188-17></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>(</span><span class=k>null</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=nv>$manager</span><span class=p>);</span>
<a id=__codelineno-188-18 name=__codelineno-188-18 href=#__codelineno-188-18></a>
<a id=__codelineno-188-19 name=__codelineno-188-19 href=#__codelineno-188-19></a><span class=k>echo</span> <span class=nv>$invoices</span><span class=o>-&gt;</span><span class=na>getSource</span><span class=p>();</span> <span class=c1>// will return co_invoices</span>
</code></pre></div> <h2 id=identity-columns>Identity Columns<a class=headerlink href=#identity-columns title="Permanent link">&para;</a></h2> <p>Some models may have identity columns. These columns usually are the primary key of the mapped table. <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> can recognize the identity column omitting it in the generated <code>INSERT</code> SQL statements, to allow the database system to correctly generate a new value for that field. After creating a new record, the identity field will always be registered with the value generated in the database system for it:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-189-1 name=__codelineno-189-1 href=#__codelineno-189-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-189-2 name=__codelineno-189-2 href=#__codelineno-189-2></a>
<a id=__codelineno-189-3 name=__codelineno-189-3 href=#__codelineno-189-3></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
<a id=__codelineno-189-4 name=__codelineno-189-4 href=#__codelineno-189-4></a>
<a id=__codelineno-189-5 name=__codelineno-189-5 href=#__codelineno-189-5></a><span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_id</span><span class=p>;</span> <span class=c1>// 4</span>
</code></pre></div> <p><a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> attempts to recognize the identity column from each table. However, depending on the database system, these columns might be serial columns, such as in the case of PostgreSQL, or <code>auto_increment</code> columns in the case of MySQL.</p> <p>PostgreSQL uses sequences to generate automatically numeric values for the primary key. Phalcon tries to obtain the generated value from the sequence <code>table_field_seq</code>, for example: <code>co_invoices_id_seq</code>. If the sequence name is different, you can always use the <code>getSequenceName()</code> method in the model, instructing Phalcon the sequence it needs to use for the primary key:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-190-1 name=__codelineno-190-1 href=#__codelineno-190-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-190-2 name=__codelineno-190-2 href=#__codelineno-190-2></a>
<a id=__codelineno-190-3 name=__codelineno-190-3 href=#__codelineno-190-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-190-4 name=__codelineno-190-4 href=#__codelineno-190-4></a>
<a id=__codelineno-190-5 name=__codelineno-190-5 href=#__codelineno-190-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-190-6 name=__codelineno-190-6 href=#__codelineno-190-6></a>
<a id=__codelineno-190-7 name=__codelineno-190-7 href=#__codelineno-190-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-190-8 name=__codelineno-190-8 href=#__codelineno-190-8></a><span class=p>{</span>
<a id=__codelineno-190-9 name=__codelineno-190-9 href=#__codelineno-190-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getSequenceName</span><span class=p>()</span>
<a id=__codelineno-190-10 name=__codelineno-190-10 href=#__codelineno-190-10></a>    <span class=p>{</span>
<a id=__codelineno-190-11 name=__codelineno-190-11 href=#__codelineno-190-11></a>        <span class=k>return</span> <span class=s1>&#39;invoices_sequence_name&#39;</span><span class=p>;</span>
<a id=__codelineno-190-12 name=__codelineno-190-12 href=#__codelineno-190-12></a>    <span class=p>}</span>
<a id=__codelineno-190-13 name=__codelineno-190-13 href=#__codelineno-190-13></a><span class=p>}</span>
</code></pre></div> <h2 id=skipping-columns>Skipping Columns<a class=headerlink href=#skipping-columns title="Permanent link">&para;</a></h2> <p>Depending on how you implement business rules or model rules in your database, certain fields could very well be ignored in database operations. For instance, if we have a <code>inv_created_date</code> in our model, we can instruct the database system to inject the current timestamp on it:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-191-1 name=__codelineno-191-1 href=#__codelineno-191-1></a><span class=nx>CREATE</span> <span class=nx>TABLE</span> <span class=nx>co_invoices</span> <span class=p>(</span>
<a id=__codelineno-191-2 name=__codelineno-191-2 href=#__codelineno-191-2></a>    <span class=c1>// ...</span>
<a id=__codelineno-191-3 name=__codelineno-191-3 href=#__codelineno-191-3></a>    <span class=nx>inv_created_at</span> <span class=nx>datetime</span> <span class=k>DEFAULT</span> <span class=nx>CURRENT_TIMESTAMP</span>
<a id=__codelineno-191-4 name=__codelineno-191-4 href=#__codelineno-191-4></a><span class=p>)</span>
</code></pre></div> <p>The code above (for MySQL) instructs the RDBMS to assign the current timestamp on the <code>inv_created_at</code> field when the record is created. We can therefore omit this field when creating a record. Similarly, we might want to ignore some fields when we are updating records.</p> <p>To achieve this task we can use the <code>skipAttributes</code> (for any operation), <code>skipAttributesOnCreate</code> (create) or <code>skipAttributesOnUpdate</code> (update)</p> <p>To tell <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> that always omits some fields in the creation and/or update of records in order to delegate the database system the assignation of the values by a trigger or a default:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-192-1 name=__codelineno-192-1 href=#__codelineno-192-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-192-2 name=__codelineno-192-2 href=#__codelineno-192-2></a>
<a id=__codelineno-192-3 name=__codelineno-192-3 href=#__codelineno-192-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-192-4 name=__codelineno-192-4 href=#__codelineno-192-4></a>
<a id=__codelineno-192-5 name=__codelineno-192-5 href=#__codelineno-192-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-192-6 name=__codelineno-192-6 href=#__codelineno-192-6></a>
<a id=__codelineno-192-7 name=__codelineno-192-7 href=#__codelineno-192-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-192-8 name=__codelineno-192-8 href=#__codelineno-192-8></a><span class=p>{</span>
<a id=__codelineno-192-9 name=__codelineno-192-9 href=#__codelineno-192-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-192-10 name=__codelineno-192-10 href=#__codelineno-192-10></a>    <span class=p>{</span>
<a id=__codelineno-192-11 name=__codelineno-192-11 href=#__codelineno-192-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributes</span><span class=p>(</span>
<a id=__codelineno-192-12 name=__codelineno-192-12 href=#__codelineno-192-12></a>            <span class=p>[</span>
<a id=__codelineno-192-13 name=__codelineno-192-13 href=#__codelineno-192-13></a>                <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-192-14 name=__codelineno-192-14 href=#__codelineno-192-14></a>                <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-192-15 name=__codelineno-192-15 href=#__codelineno-192-15></a>            <span class=p>]</span>
<a id=__codelineno-192-16 name=__codelineno-192-16 href=#__codelineno-192-16></a>        <span class=p>);</span>
<a id=__codelineno-192-17 name=__codelineno-192-17 href=#__codelineno-192-17></a>
<a id=__codelineno-192-18 name=__codelineno-192-18 href=#__codelineno-192-18></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributesOnCreate</span><span class=p>(</span>
<a id=__codelineno-192-19 name=__codelineno-192-19 href=#__codelineno-192-19></a>            <span class=p>[</span>
<a id=__codelineno-192-20 name=__codelineno-192-20 href=#__codelineno-192-20></a>                <span class=s1>&#39;inv_created_at&#39;</span><span class=p>,</span>
<a id=__codelineno-192-21 name=__codelineno-192-21 href=#__codelineno-192-21></a>            <span class=p>]</span>
<a id=__codelineno-192-22 name=__codelineno-192-22 href=#__codelineno-192-22></a>        <span class=p>);</span>
<a id=__codelineno-192-23 name=__codelineno-192-23 href=#__codelineno-192-23></a>
<a id=__codelineno-192-24 name=__codelineno-192-24 href=#__codelineno-192-24></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>skipAttributesOnUpdate</span><span class=p>(</span>
<a id=__codelineno-192-25 name=__codelineno-192-25 href=#__codelineno-192-25></a>            <span class=p>[</span>
<a id=__codelineno-192-26 name=__codelineno-192-26 href=#__codelineno-192-26></a>                <span class=s1>&#39;inv_modified_at&#39;</span><span class=p>,</span>
<a id=__codelineno-192-27 name=__codelineno-192-27 href=#__codelineno-192-27></a>            <span class=p>]</span>
<a id=__codelineno-192-28 name=__codelineno-192-28 href=#__codelineno-192-28></a>        <span class=p>);</span>
<a id=__codelineno-192-29 name=__codelineno-192-29 href=#__codelineno-192-29></a>    <span class=p>}</span>
<a id=__codelineno-192-30 name=__codelineno-192-30 href=#__codelineno-192-30></a><span class=p>}</span>
</code></pre></div> <p>If you want to set default values in your model properties (such as the <code>inv_created_at</code>) you can use the <a href=../api/phalcon_db/#dbrawvalue->Phalcon\Db\RawValue</a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-193-1 name=__codelineno-193-1 href=#__codelineno-193-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-193-2 name=__codelineno-193-2 href=#__codelineno-193-2></a>
<a id=__codelineno-193-3 name=__codelineno-193-3 href=#__codelineno-193-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-193-4 name=__codelineno-193-4 href=#__codelineno-193-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\RawValue</span><span class=p>;</span>
<a id=__codelineno-193-5 name=__codelineno-193-5 href=#__codelineno-193-5></a>
<a id=__codelineno-193-6 name=__codelineno-193-6 href=#__codelineno-193-6></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-193-7 name=__codelineno-193-7 href=#__codelineno-193-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_id</span>          <span class=o>=</span> <span class=mi>1234</span><span class=p>;</span>
<a id=__codelineno-193-8 name=__codelineno-193-8 href=#__codelineno-193-8></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-193-9 name=__codelineno-193-9 href=#__codelineno-193-9></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-193-10 name=__codelineno-193-10 href=#__codelineno-193-10></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-193-11 name=__codelineno-193-11 href=#__codelineno-193-11></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-193-12 name=__codelineno-193-12 href=#__codelineno-193-12></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=k>new</span> <span class=nx>RawValue</span><span class=p>(</span><span class=s1>&#39;default&#39;</span><span class=p>);</span>
<a id=__codelineno-193-13 name=__codelineno-193-13 href=#__codelineno-193-13></a>
<a id=__codelineno-193-14 name=__codelineno-193-14 href=#__codelineno-193-14></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
</code></pre></div> <p>We can also take advantage of the <code>beforeCreate</code> event in the model to assign the default value there:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-194-1 name=__codelineno-194-1 href=#__codelineno-194-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-194-2 name=__codelineno-194-2 href=#__codelineno-194-2></a>
<a id=__codelineno-194-3 name=__codelineno-194-3 href=#__codelineno-194-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-194-4 name=__codelineno-194-4 href=#__codelineno-194-4></a>
<a id=__codelineno-194-5 name=__codelineno-194-5 href=#__codelineno-194-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-194-6 name=__codelineno-194-6 href=#__codelineno-194-6></a><span class=k>use</span> <span class=nx>Phalcon\Db\RawValue</span><span class=p>;</span>
<a id=__codelineno-194-7 name=__codelineno-194-7 href=#__codelineno-194-7></a>
<a id=__codelineno-194-8 name=__codelineno-194-8 href=#__codelineno-194-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-194-9 name=__codelineno-194-9 href=#__codelineno-194-9></a><span class=p>{</span>
<a id=__codelineno-194-10 name=__codelineno-194-10 href=#__codelineno-194-10></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeCreate</span><span class=p>()</span>
<a id=__codelineno-194-11 name=__codelineno-194-11 href=#__codelineno-194-11></a>    <span class=p>{</span>
<a id=__codelineno-194-12 name=__codelineno-194-12 href=#__codelineno-194-12></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_created_at</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RawValue</span><span class=p>(</span><span class=s1>&#39;default&#39;</span><span class=p>);</span>
<a id=__codelineno-194-13 name=__codelineno-194-13 href=#__codelineno-194-13></a>    <span class=p>}</span>
<a id=__codelineno-194-14 name=__codelineno-194-14 href=#__codelineno-194-14></a><span class=p>}</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>Never use a <a href=../api/phalcon_db/#dbrawvalue->Phalcon\Db\RawValue</a> to assign external data (such as user input) or variable data. The value of these fields is ignored when binding parameters to the query. So it could be used for SQL injection attacks.</p> </div> <h2 id=dynamic-updates>Dynamic Updates<a class=headerlink href=#dynamic-updates title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p>Dynamic Update is now enabled by default, you can disable it by changing the "phalcon.orm.dynamic_update" in the php.ini or by ini_set.</p> </div> <p>If the system-wide dynamic update is disabled, the SQL <code>UPDATE</code> statements are by default created with every column defined in the model (full all-field SQL update). You can change specific models to make dynamic updates, in this case, just the fields that had changed are used to create the final SQL statement.</p> <p>In some cases, this could improve the performance by reducing the traffic between the application and the database server, especially when the target table has blob/text fields:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-195-1 name=__codelineno-195-1 href=#__codelineno-195-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-195-2 name=__codelineno-195-2 href=#__codelineno-195-2></a>
<a id=__codelineno-195-3 name=__codelineno-195-3 href=#__codelineno-195-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-195-4 name=__codelineno-195-4 href=#__codelineno-195-4></a>
<a id=__codelineno-195-5 name=__codelineno-195-5 href=#__codelineno-195-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-195-6 name=__codelineno-195-6 href=#__codelineno-195-6></a>
<a id=__codelineno-195-7 name=__codelineno-195-7 href=#__codelineno-195-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-195-8 name=__codelineno-195-8 href=#__codelineno-195-8></a><span class=p>{</span>
<a id=__codelineno-195-9 name=__codelineno-195-9 href=#__codelineno-195-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-195-10 name=__codelineno-195-10 href=#__codelineno-195-10></a>    <span class=p>{</span>
<a id=__codelineno-195-11 name=__codelineno-195-11 href=#__codelineno-195-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>useDynamicUpdate</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
<a id=__codelineno-195-12 name=__codelineno-195-12 href=#__codelineno-195-12></a>    <span class=p>}</span>
<a id=__codelineno-195-13 name=__codelineno-195-13 href=#__codelineno-195-13></a><span class=p>}</span>
</code></pre></div> <h2 id=column-mapping>Column Mapping<a class=headerlink href=#column-mapping title="Permanent link">&para;</a></h2> <p>The ORM supports an independent column map, which allows the developer to use different column names in the model to the ones in the table. Phalcon will recognize the new column names and will rename them accordingly to match the respective columns in the database. This is a great feature when one needs to rename fields in the database without having to worry about all the queries in the code.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-196-1 name=__codelineno-196-1 href=#__codelineno-196-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-196-2 name=__codelineno-196-2 href=#__codelineno-196-2></a>
<a id=__codelineno-196-3 name=__codelineno-196-3 href=#__codelineno-196-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-196-4 name=__codelineno-196-4 href=#__codelineno-196-4></a>
<a id=__codelineno-196-5 name=__codelineno-196-5 href=#__codelineno-196-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-196-6 name=__codelineno-196-6 href=#__codelineno-196-6></a>
<a id=__codelineno-196-7 name=__codelineno-196-7 href=#__codelineno-196-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-196-8 name=__codelineno-196-8 href=#__codelineno-196-8></a><span class=p>{</span>
<a id=__codelineno-196-9 name=__codelineno-196-9 href=#__codelineno-196-9></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-196-10 name=__codelineno-196-10 href=#__codelineno-196-10></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-196-11 name=__codelineno-196-11 href=#__codelineno-196-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-196-12 name=__codelineno-196-12 href=#__codelineno-196-12></a>    <span class=k>public</span> <span class=nv>$inv_title</span><span class=p>;</span>
<a id=__codelineno-196-13 name=__codelineno-196-13 href=#__codelineno-196-13></a>    <span class=k>public</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-196-14 name=__codelineno-196-14 href=#__codelineno-196-14></a>    <span class=k>public</span> <span class=nv>$inv_created_at</span><span class=p>;</span>
<a id=__codelineno-196-15 name=__codelineno-196-15 href=#__codelineno-196-15></a>
<a id=__codelineno-196-16 name=__codelineno-196-16 href=#__codelineno-196-16></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>columnMap</span><span class=p>()</span>
<a id=__codelineno-196-17 name=__codelineno-196-17 href=#__codelineno-196-17></a>    <span class=p>{</span>
<a id=__codelineno-196-18 name=__codelineno-196-18 href=#__codelineno-196-18></a>        <span class=k>return</span> <span class=p>[</span>
<a id=__codelineno-196-19 name=__codelineno-196-19 href=#__codelineno-196-19></a>            <span class=s1>&#39;inv_id&#39;</span>          <span class=o>=&gt;</span> <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-196-20 name=__codelineno-196-20 href=#__codelineno-196-20></a>            <span class=s1>&#39;inv_cst_id&#39;</span>      <span class=o>=&gt;</span> <span class=s1>&#39;customerId&#39;</span><span class=p>,</span>
<a id=__codelineno-196-21 name=__codelineno-196-21 href=#__codelineno-196-21></a>            <span class=s1>&#39;inv_status_flag&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;status&#39;</span><span class=p>,</span>
<a id=__codelineno-196-22 name=__codelineno-196-22 href=#__codelineno-196-22></a>            <span class=s1>&#39;inv_title&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;title&#39;</span><span class=p>,</span>
<a id=__codelineno-196-23 name=__codelineno-196-23 href=#__codelineno-196-23></a>            <span class=s1>&#39;inv_total&#39;</span>       <span class=o>=&gt;</span> <span class=s1>&#39;total&#39;</span><span class=p>,</span>
<a id=__codelineno-196-24 name=__codelineno-196-24 href=#__codelineno-196-24></a>            <span class=s1>&#39;inv_created_at&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;createdAt&#39;</span><span class=p>,</span>
<a id=__codelineno-196-25 name=__codelineno-196-25 href=#__codelineno-196-25></a>        <span class=p>];</span>
<a id=__codelineno-196-26 name=__codelineno-196-26 href=#__codelineno-196-26></a>    <span class=p>}</span>
<a id=__codelineno-196-27 name=__codelineno-196-27 href=#__codelineno-196-27></a><span class=p>}</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>In the array defined in the column map, the keys are the actual names of the fields in the database, and the values are the <em>virtual</em> fields we can use in your code</p> </div> <p>Now we can use those <em>virtual</em> fields (or column maps) in your code:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-197-1 name=__codelineno-197-1 href=#__codelineno-197-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-197-2 name=__codelineno-197-2 href=#__codelineno-197-2></a>
<a id=__codelineno-197-3 name=__codelineno-197-3 href=#__codelineno-197-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-197-4 name=__codelineno-197-4 href=#__codelineno-197-4></a>
<a id=__codelineno-197-5 name=__codelineno-197-5 href=#__codelineno-197-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-197-6 name=__codelineno-197-6 href=#__codelineno-197-6></a>    <span class=p>[</span>
<a id=__codelineno-197-7 name=__codelineno-197-7 href=#__codelineno-197-7></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_id = :id:&#39;</span><span class=p>,</span>
<a id=__codelineno-197-8 name=__codelineno-197-8 href=#__codelineno-197-8></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-197-9 name=__codelineno-197-9 href=#__codelineno-197-9></a>            <span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>4</span><span class=p>,</span>
<a id=__codelineno-197-10 name=__codelineno-197-10 href=#__codelineno-197-10></a>        <span class=p>]</span>
<a id=__codelineno-197-11 name=__codelineno-197-11 href=#__codelineno-197-11></a>    <span class=p>]</span>
<a id=__codelineno-197-12 name=__codelineno-197-12 href=#__codelineno-197-12></a><span class=p>);</span>
<a id=__codelineno-197-13 name=__codelineno-197-13 href=#__codelineno-197-13></a>
<a id=__codelineno-197-14 name=__codelineno-197-14 href=#__codelineno-197-14></a><span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>customerId</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>,</span>
<a id=__codelineno-197-15 name=__codelineno-197-15 href=#__codelineno-197-15></a>     <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>,</span>
<a id=__codelineno-197-16 name=__codelineno-197-16 href=#__codelineno-197-16></a>     <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>createdAt</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-197-17 name=__codelineno-197-17 href=#__codelineno-197-17></a>
<a id=__codelineno-197-18 name=__codelineno-197-18 href=#__codelineno-197-18></a><span class=nv>$invoices</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>find</span><span class=p>(</span>
<a id=__codelineno-197-19 name=__codelineno-197-19 href=#__codelineno-197-19></a>    <span class=p>[</span>
<a id=__codelineno-197-20 name=__codelineno-197-20 href=#__codelineno-197-20></a>        <span class=s1>&#39;order&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;createdAt DESC&#39;</span><span class=p>,</span>
<a id=__codelineno-197-21 name=__codelineno-197-21 href=#__codelineno-197-21></a>    <span class=p>]</span>
<a id=__codelineno-197-22 name=__codelineno-197-22 href=#__codelineno-197-22></a><span class=p>);</span>
<a id=__codelineno-197-23 name=__codelineno-197-23 href=#__codelineno-197-23></a>
<a id=__codelineno-197-24 name=__codelineno-197-24 href=#__codelineno-197-24></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$invoices</span> <span class=k>as</span> <span class=nv>$invoice</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-197-25 name=__codelineno-197-25 href=#__codelineno-197-25></a>    <span class=k>echo</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>customerId</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>,</span>
<a id=__codelineno-197-26 name=__codelineno-197-26 href=#__codelineno-197-26></a>         <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>total</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>,</span>
<a id=__codelineno-197-27 name=__codelineno-197-27 href=#__codelineno-197-27></a>         <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>createdAt</span><span class=p>,</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
<a id=__codelineno-197-28 name=__codelineno-197-28 href=#__codelineno-197-28></a><span class=p>}</span>
<a id=__codelineno-197-29 name=__codelineno-197-29 href=#__codelineno-197-29></a>
<a id=__codelineno-197-30 name=__codelineno-197-30 href=#__codelineno-197-30></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-197-31 name=__codelineno-197-31 href=#__codelineno-197-31></a>
<a id=__codelineno-197-32 name=__codelineno-197-32 href=#__codelineno-197-32></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>customerId</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-197-33 name=__codelineno-197-33 href=#__codelineno-197-33></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>status</span>     <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-197-34 name=__codelineno-197-34 href=#__codelineno-197-34></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>title</span>      <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-197-35 name=__codelineno-197-35 href=#__codelineno-197-35></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>total</span>      <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-197-36 name=__codelineno-197-36 href=#__codelineno-197-36></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>createdAt</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-197-37 name=__codelineno-197-37 href=#__codelineno-197-37></a>
<a id=__codelineno-197-38 name=__codelineno-197-38 href=#__codelineno-197-38></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>();</span>
</code></pre></div> <p><strong>Considerations</strong></p> <p>Consider the following when renaming your columns:</p> <ul> <li>References to attributes in relationships/validators <strong>must use the virtual names</strong></li> <li>Refer the real column names will result in an exception by the ORM</li> </ul> <p>The independent column map allows you to:</p> <ul> <li>Write applications using your own conventions</li> <li>Eliminate vendor prefixes/suffixes in your code</li> <li>Change column names without changing your application code</li> </ul> <h2 id=record-snapshots>Record Snapshots<a class=headerlink href=#record-snapshots title="Permanent link">&para;</a></h2> <p>Specific models could be set to maintain a record snapshot when they are queried. You can use this feature to implement auditing or just to know what fields have been changed in the model compared to the data in the database.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-198-1 name=__codelineno-198-1 href=#__codelineno-198-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-198-2 name=__codelineno-198-2 href=#__codelineno-198-2></a>
<a id=__codelineno-198-3 name=__codelineno-198-3 href=#__codelineno-198-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-198-4 name=__codelineno-198-4 href=#__codelineno-198-4></a>
<a id=__codelineno-198-5 name=__codelineno-198-5 href=#__codelineno-198-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-198-6 name=__codelineno-198-6 href=#__codelineno-198-6></a>
<a id=__codelineno-198-7 name=__codelineno-198-7 href=#__codelineno-198-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-198-8 name=__codelineno-198-8 href=#__codelineno-198-8></a><span class=p>{</span>
<a id=__codelineno-198-9 name=__codelineno-198-9 href=#__codelineno-198-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-198-10 name=__codelineno-198-10 href=#__codelineno-198-10></a>    <span class=p>{</span>
<a id=__codelineno-198-11 name=__codelineno-198-11 href=#__codelineno-198-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>keepSnapshots</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
<a id=__codelineno-198-12 name=__codelineno-198-12 href=#__codelineno-198-12></a>    <span class=p>}</span>
<a id=__codelineno-198-13 name=__codelineno-198-13 href=#__codelineno-198-13></a><span class=p>}</span>
</code></pre></div> <p>When activating this feature, the application consumes a bit more memory, to keep track of the original values obtained from the database. In models that have this feature activated, you can check what fields changed as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-199-1 name=__codelineno-199-1 href=#__codelineno-199-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-199-2 name=__codelineno-199-2 href=#__codelineno-199-2></a>
<a id=__codelineno-199-3 name=__codelineno-199-3 href=#__codelineno-199-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-199-4 name=__codelineno-199-4 href=#__codelineno-199-4></a>
<a id=__codelineno-199-5 name=__codelineno-199-5 href=#__codelineno-199-5></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
<a id=__codelineno-199-6 name=__codelineno-199-6 href=#__codelineno-199-6></a>
<a id=__codelineno-199-7 name=__codelineno-199-7 href=#__codelineno-199-7></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
<a id=__codelineno-199-8 name=__codelineno-199-8 href=#__codelineno-199-8></a>
<a id=__codelineno-199-9 name=__codelineno-199-9 href=#__codelineno-199-9></a><span class=nb>var_dump</span><span class=p>(</span><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>());</span> <span class=c1>// [&#39;inv_total&#39;]</span>
<a id=__codelineno-199-10 name=__codelineno-199-10 href=#__codelineno-199-10></a>
<a id=__codelineno-199-11 name=__codelineno-199-11 href=#__codelineno-199-11></a><span class=nb>var_dump</span><span class=p>(</span><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>hasChanged</span><span class=p>(</span><span class=s1>&#39;inv_total&#39;</span><span class=p>));</span> <span class=c1>// true</span>
<a id=__codelineno-199-12 name=__codelineno-199-12 href=#__codelineno-199-12></a>
<a id=__codelineno-199-13 name=__codelineno-199-13 href=#__codelineno-199-13></a><span class=nb>var_dump</span><span class=p>(</span><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>hasChanged</span><span class=p>(</span><span class=s1>&#39;inv_cst_id&#39;</span><span class=p>));</span> <span class=c1>// false</span>
</code></pre></div> <p>Snapshots are updated on model creation/update. Using <code>hasUpdated()</code> and <code>getUpdatedFields()</code> can be used to check if fields were updated after a create/save/update, but it could potentially cause problems to your application if you execute <code>getChangedFields()</code> in <code>afterUpdate()</code>, <code>afterSave()</code> or <code>afterCreate()</code>.</p> <p>You can disable this functionality by using:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-200-1 name=__codelineno-200-1 href=#__codelineno-200-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-200-2 name=__codelineno-200-2 href=#__codelineno-200-2></a>
<a id=__codelineno-200-3 name=__codelineno-200-3 href=#__codelineno-200-3></a><span class=nx>Phalcon\Mvc\Model</span><span class=o>::</span><span class=na>setup</span><span class=p>(</span>
<a id=__codelineno-200-4 name=__codelineno-200-4 href=#__codelineno-200-4></a>    <span class=p>[</span>
<a id=__codelineno-200-5 name=__codelineno-200-5 href=#__codelineno-200-5></a>        <span class=s1>&#39;updateSnapshotOnSave&#39;</span> <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-200-6 name=__codelineno-200-6 href=#__codelineno-200-6></a>    <span class=p>]</span>
<a id=__codelineno-200-7 name=__codelineno-200-7 href=#__codelineno-200-7></a><span class=p>);</span>
</code></pre></div> or if you prefer set this in your <code>php.ini</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-201-1 name=__codelineno-201-1 href=#__codelineno-201-1></a><span class=na>phalcon.orm.update_snapshot_on_save</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>0</span>
</code></pre></div> <p>Using this functionality will have the following effect:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-202-1 name=__codelineno-202-1 href=#__codelineno-202-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-202-2 name=__codelineno-202-2 href=#__codelineno-202-2></a>
<a id=__codelineno-202-3 name=__codelineno-202-3 href=#__codelineno-202-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-202-4 name=__codelineno-202-4 href=#__codelineno-202-4></a>
<a id=__codelineno-202-5 name=__codelineno-202-5 href=#__codelineno-202-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-202-6 name=__codelineno-202-6 href=#__codelineno-202-6></a>
<a id=__codelineno-202-7 name=__codelineno-202-7 href=#__codelineno-202-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-202-8 name=__codelineno-202-8 href=#__codelineno-202-8></a><span class=p>{</span>
<a id=__codelineno-202-9 name=__codelineno-202-9 href=#__codelineno-202-9></a>    <span class=k>public</span> <span class=nv>$inv_id</span><span class=p>;</span>
<a id=__codelineno-202-10 name=__codelineno-202-10 href=#__codelineno-202-10></a>    <span class=k>public</span> <span class=nv>$inv_cst_id</span><span class=p>;</span>
<a id=__codelineno-202-11 name=__codelineno-202-11 href=#__codelineno-202-11></a>    <span class=k>public</span> <span class=nv>$inv_status_flag</span><span class=p>;</span>
<a id=__codelineno-202-12 name=__codelineno-202-12 href=#__codelineno-202-12></a>    <span class=k>public</span> <span class=nv>$inv_title</span><span class=p>;</span>
<a id=__codelineno-202-13 name=__codelineno-202-13 href=#__codelineno-202-13></a>    <span class=k>public</span> <span class=nv>$inv_total</span><span class=p>;</span>
<a id=__codelineno-202-14 name=__codelineno-202-14 href=#__codelineno-202-14></a>    <span class=k>public</span> <span class=nv>$inv_created_at</span><span class=p>;</span>
<a id=__codelineno-202-15 name=__codelineno-202-15 href=#__codelineno-202-15></a>
<a id=__codelineno-202-16 name=__codelineno-202-16 href=#__codelineno-202-16></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-202-17 name=__codelineno-202-17 href=#__codelineno-202-17></a>    <span class=p>{</span>
<a id=__codelineno-202-18 name=__codelineno-202-18 href=#__codelineno-202-18></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>keepSnapshots</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
<a id=__codelineno-202-19 name=__codelineno-202-19 href=#__codelineno-202-19></a>    <span class=p>}</span>
<a id=__codelineno-202-20 name=__codelineno-202-20 href=#__codelineno-202-20></a><span class=p>}</span>
<a id=__codelineno-202-21 name=__codelineno-202-21 href=#__codelineno-202-21></a>
<a id=__codelineno-202-22 name=__codelineno-202-22 href=#__codelineno-202-22></a><span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-202-23 name=__codelineno-202-23 href=#__codelineno-202-23></a>
<a id=__codelineno-202-24 name=__codelineno-202-24 href=#__codelineno-202-24></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_id</span>          <span class=o>=</span> <span class=mi>1234</span><span class=p>;</span>
<a id=__codelineno-202-25 name=__codelineno-202-25 href=#__codelineno-202-25></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-202-26 name=__codelineno-202-26 href=#__codelineno-202-26></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-202-27 name=__codelineno-202-27 href=#__codelineno-202-27></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-202-28 name=__codelineno-202-28 href=#__codelineno-202-28></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-202-29 name=__codelineno-202-29 href=#__codelineno-202-29></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-202-30 name=__codelineno-202-30 href=#__codelineno-202-30></a>
<a id=__codelineno-202-31 name=__codelineno-202-31 href=#__codelineno-202-31></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
<a id=__codelineno-202-32 name=__codelineno-202-32 href=#__codelineno-202-32></a>
<a id=__codelineno-202-33 name=__codelineno-202-33 href=#__codelineno-202-33></a><span class=nb>var_dump</span><span class=p>(</span>
<a id=__codelineno-202-34 name=__codelineno-202-34 href=#__codelineno-202-34></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span> <span class=c1>// []</span>
<a id=__codelineno-202-35 name=__codelineno-202-35 href=#__codelineno-202-35></a><span class=p>);</span>
<a id=__codelineno-202-36 name=__codelineno-202-36 href=#__codelineno-202-36></a>
<a id=__codelineno-202-37 name=__codelineno-202-37 href=#__codelineno-202-37></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span> <span class=o>=</span> <span class=mi>120</span><span class=p>;</span>
<a id=__codelineno-202-38 name=__codelineno-202-38 href=#__codelineno-202-38></a>
<a id=__codelineno-202-39 name=__codelineno-202-39 href=#__codelineno-202-39></a><span class=nb>var_dump</span><span class=p>(</span>
<a id=__codelineno-202-40 name=__codelineno-202-40 href=#__codelineno-202-40></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span> <span class=c1>// [&#39;inv_total&#39;]</span>
<a id=__codelineno-202-41 name=__codelineno-202-41 href=#__codelineno-202-41></a><span class=p>);</span>
<a id=__codelineno-202-42 name=__codelineno-202-42 href=#__codelineno-202-42></a>
<a id=__codelineno-202-43 name=__codelineno-202-43 href=#__codelineno-202-43></a><span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>();</span>
<a id=__codelineno-202-44 name=__codelineno-202-44 href=#__codelineno-202-44></a>
<a id=__codelineno-202-45 name=__codelineno-202-45 href=#__codelineno-202-45></a><span class=nb>var_dump</span><span class=p>(</span>
<a id=__codelineno-202-46 name=__codelineno-202-46 href=#__codelineno-202-46></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>getChangedFields</span><span class=p>()</span> <span class=c1>// []</span>
<a id=__codelineno-202-47 name=__codelineno-202-47 href=#__codelineno-202-47></a><span class=p>);</span>
</code></pre></div> <p><code>getUpdatedFields()</code> will properly return updated fields or as mentioned above you can go back to the previous behavior by setting the relevant ini value.</p> <h2 id=events>Events<a class=headerlink href=#events title="Permanent link">&para;</a></h2> <p>As mentioned before <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> acts as a listener to events. Therefore, all the events that the model is listening to can be implemented as methods in the model itself. You can check the <a href=../events/ >events</a> document for additional information.</p> <p>The events supported are:</p> <ul> <li><code>afterCreate</code></li> <li><code>afterDelete</code></li> <li><code>afterFetch</code></li> <li><code>afterSave</code></li> <li><code>afterUpdate</code></li> <li><code>afterValidation</code></li> <li><code>afterValidationOnCreate</code></li> <li><code>afterValidationOnUpdate</code></li> <li><code>beforeDelete</code></li> <li><code>beforeCreate</code></li> <li><code>beforeSave</code></li> <li><code>beforeUpdate</code></li> <li><code>beforeValidation</code></li> <li><code>beforeValidationOnCreate</code></li> <li><code>beforeValidationOnUpdate</code></li> <li><code>notDeleted</code></li> <li><code>notSaved</code></li> <li><code>onValidationFails</code></li> <li><code>prepareSave</code></li> <li><code>validation</code></li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-203-1 name=__codelineno-203-1 href=#__codelineno-203-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-203-2 name=__codelineno-203-2 href=#__codelineno-203-2></a>
<a id=__codelineno-203-3 name=__codelineno-203-3 href=#__codelineno-203-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-203-4 name=__codelineno-203-4 href=#__codelineno-203-4></a>
<a id=__codelineno-203-5 name=__codelineno-203-5 href=#__codelineno-203-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-203-6 name=__codelineno-203-6 href=#__codelineno-203-6></a><span class=k>use</span> <span class=nx>Phalcon\Messages\Message</span> <span class=k>as</span> <span class=nx>Message</span><span class=p>;</span>
<a id=__codelineno-203-7 name=__codelineno-203-7 href=#__codelineno-203-7></a>
<a id=__codelineno-203-8 name=__codelineno-203-8 href=#__codelineno-203-8></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-203-9 name=__codelineno-203-9 href=#__codelineno-203-9></a><span class=p>{</span>
<a id=__codelineno-203-10 name=__codelineno-203-10 href=#__codelineno-203-10></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeSave</span><span class=p>()</span>
<a id=__codelineno-203-11 name=__codelineno-203-11 href=#__codelineno-203-11></a>    <span class=p>{</span>
<a id=__codelineno-203-12 name=__codelineno-203-12 href=#__codelineno-203-12></a>        <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>===</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-203-13 name=__codelineno-203-13 href=#__codelineno-203-13></a>            <span class=nv>$message</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Message</span><span class=p>(</span>
<a id=__codelineno-203-14 name=__codelineno-203-14 href=#__codelineno-203-14></a>                <span class=s1>&#39;Sorry, an invoice cannot be unpaid&#39;</span>
<a id=__codelineno-203-15 name=__codelineno-203-15 href=#__codelineno-203-15></a>            <span class=p>);</span>
<a id=__codelineno-203-16 name=__codelineno-203-16 href=#__codelineno-203-16></a>
<a id=__codelineno-203-17 name=__codelineno-203-17 href=#__codelineno-203-17></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>appendMessage</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-203-18 name=__codelineno-203-18 href=#__codelineno-203-18></a>        <span class=p>}</span>
<a id=__codelineno-203-19 name=__codelineno-203-19 href=#__codelineno-203-19></a>    <span class=p>}</span>
<a id=__codelineno-203-20 name=__codelineno-203-20 href=#__codelineno-203-20></a><span class=p>}</span>
</code></pre></div> <h2 id=transactions>Transactions<a class=headerlink href=#transactions title="Permanent link">&para;</a></h2> <p><a href=../db-models-transactions/ >Transactions</a> are necessary to ensure data integrity, when we need to insert or update data in more than one table during the same operation. <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> exposes the <code>setTransaction</code> method that allows you to bind each model to an active transaction.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-204-1 name=__codelineno-204-1 href=#__codelineno-204-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-204-2 name=__codelineno-204-2 href=#__codelineno-204-2></a>
<a id=__codelineno-204-3 name=__codelineno-204-3 href=#__codelineno-204-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-204-4 name=__codelineno-204-4 href=#__codelineno-204-4></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-204-5 name=__codelineno-204-5 href=#__codelineno-204-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Manager</span><span class=p>;</span>
<a id=__codelineno-204-6 name=__codelineno-204-6 href=#__codelineno-204-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Failed</span><span class=p>;</span>
<a id=__codelineno-204-7 name=__codelineno-204-7 href=#__codelineno-204-7></a>
<a id=__codelineno-204-8 name=__codelineno-204-8 href=#__codelineno-204-8></a><span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-204-9 name=__codelineno-204-9 href=#__codelineno-204-9></a>    <span class=nv>$txManager</span>   <span class=o>=</span> <span class=k>new</span> <span class=nx>Manager</span><span class=p>();</span>
<a id=__codelineno-204-10 name=__codelineno-204-10 href=#__codelineno-204-10></a>    <span class=nv>$transaction</span> <span class=o>=</span> <span class=nv>$txManager</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
<a id=__codelineno-204-11 name=__codelineno-204-11 href=#__codelineno-204-11></a>
<a id=__codelineno-204-12 name=__codelineno-204-12 href=#__codelineno-204-12></a>    <span class=nv>$customer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Customers</span><span class=p>();</span>
<a id=__codelineno-204-13 name=__codelineno-204-13 href=#__codelineno-204-13></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-204-14 name=__codelineno-204-14 href=#__codelineno-204-14></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_last</span>  <span class=o>=</span> <span class=s1>&#39;Vader&#39;</span><span class=p>;</span>
<a id=__codelineno-204-15 name=__codelineno-204-15 href=#__codelineno-204-15></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_first</span> <span class=o>=</span> <span class=s1>&#39;Darth&#39;</span><span class=p>;</span>
<a id=__codelineno-204-16 name=__codelineno-204-16 href=#__codelineno-204-16></a>
<a id=__codelineno-204-17 name=__codelineno-204-17 href=#__codelineno-204-17></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-204-18 name=__codelineno-204-18 href=#__codelineno-204-18></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save Customer&#39;</span><span class=p>);</span>
<a id=__codelineno-204-19 name=__codelineno-204-19 href=#__codelineno-204-19></a>    <span class=p>}</span>
<a id=__codelineno-204-20 name=__codelineno-204-20 href=#__codelineno-204-20></a>
<a id=__codelineno-204-21 name=__codelineno-204-21 href=#__codelineno-204-21></a>    <span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-204-22 name=__codelineno-204-22 href=#__codelineno-204-22></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-204-23 name=__codelineno-204-23 href=#__codelineno-204-23></a>
<a id=__codelineno-204-24 name=__codelineno-204-24 href=#__codelineno-204-24></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_id</span><span class=p>;</span>
<a id=__codelineno-204-25 name=__codelineno-204-25 href=#__codelineno-204-25></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-204-26 name=__codelineno-204-26 href=#__codelineno-204-26></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-204-27 name=__codelineno-204-27 href=#__codelineno-204-27></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
<a id=__codelineno-204-28 name=__codelineno-204-28 href=#__codelineno-204-28></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-204-29 name=__codelineno-204-29 href=#__codelineno-204-29></a>
<a id=__codelineno-204-30 name=__codelineno-204-30 href=#__codelineno-204-30></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-204-31 name=__codelineno-204-31 href=#__codelineno-204-31></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save record&#39;</span><span class=p>);</span>
<a id=__codelineno-204-32 name=__codelineno-204-32 href=#__codelineno-204-32></a>    <span class=p>}</span>
<a id=__codelineno-204-33 name=__codelineno-204-33 href=#__codelineno-204-33></a>
<a id=__codelineno-204-34 name=__codelineno-204-34 href=#__codelineno-204-34></a>    <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-204-35 name=__codelineno-204-35 href=#__codelineno-204-35></a><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Failed</span> <span class=nv>$ex</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-204-36 name=__codelineno-204-36 href=#__codelineno-204-36></a>    <span class=k>echo</span> <span class=s1>&#39;ERROR: &#39;</span><span class=p>,</span> <span class=nv>$ex</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>();</span>
<a id=__codelineno-204-37 name=__codelineno-204-37 href=#__codelineno-204-37></a><span class=p>}</span>
</code></pre></div> <p>You can also include <em>finder</em> results in your transactions or even have multiple transactions running at the same time:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-205-1 name=__codelineno-205-1 href=#__codelineno-205-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-205-2 name=__codelineno-205-2 href=#__codelineno-205-2></a>
<a id=__codelineno-205-3 name=__codelineno-205-3 href=#__codelineno-205-3></a><span class=k>use</span> <span class=nx>MyApp\Models\Customers</span><span class=p>;</span>
<a id=__codelineno-205-4 name=__codelineno-205-4 href=#__codelineno-205-4></a><span class=k>use</span> <span class=nx>MyApp\Models\Invoices</span><span class=p>;</span>
<a id=__codelineno-205-5 name=__codelineno-205-5 href=#__codelineno-205-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Manager</span><span class=p>;</span>
<a id=__codelineno-205-6 name=__codelineno-205-6 href=#__codelineno-205-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Transaction\Failed</span><span class=p>;</span>
<a id=__codelineno-205-7 name=__codelineno-205-7 href=#__codelineno-205-7></a>
<a id=__codelineno-205-8 name=__codelineno-205-8 href=#__codelineno-205-8></a><span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-205-9 name=__codelineno-205-9 href=#__codelineno-205-9></a>    <span class=nv>$txManager</span>   <span class=o>=</span> <span class=k>new</span> <span class=nx>Manager</span><span class=p>();</span>
<a id=__codelineno-205-10 name=__codelineno-205-10 href=#__codelineno-205-10></a>    <span class=nv>$transaction</span> <span class=o>=</span> <span class=nv>$txManager</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
<a id=__codelineno-205-11 name=__codelineno-205-11 href=#__codelineno-205-11></a>
<a id=__codelineno-205-12 name=__codelineno-205-12 href=#__codelineno-205-12></a>    <span class=nv>$customer</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Customers</span><span class=p>();</span>
<a id=__codelineno-205-13 name=__codelineno-205-13 href=#__codelineno-205-13></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-205-14 name=__codelineno-205-14 href=#__codelineno-205-14></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_last</span>  <span class=o>=</span> <span class=s1>&#39;Vader&#39;</span><span class=p>;</span>
<a id=__codelineno-205-15 name=__codelineno-205-15 href=#__codelineno-205-15></a>    <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_name_first</span> <span class=o>=</span> <span class=s1>&#39;Darth&#39;</span><span class=p>;</span>
<a id=__codelineno-205-16 name=__codelineno-205-16 href=#__codelineno-205-16></a>
<a id=__codelineno-205-17 name=__codelineno-205-17 href=#__codelineno-205-17></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-205-18 name=__codelineno-205-18 href=#__codelineno-205-18></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save Customer&#39;</span><span class=p>);</span>
<a id=__codelineno-205-19 name=__codelineno-205-19 href=#__codelineno-205-19></a>    <span class=p>}</span>
<a id=__codelineno-205-20 name=__codelineno-205-20 href=#__codelineno-205-20></a>
<a id=__codelineno-205-21 name=__codelineno-205-21 href=#__codelineno-205-21></a>    <span class=nv>$average</span> <span class=o>=</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>average</span><span class=p>(</span>
<a id=__codelineno-205-22 name=__codelineno-205-22 href=#__codelineno-205-22></a>        <span class=p>[</span>
<a id=__codelineno-205-23 name=__codelineno-205-23 href=#__codelineno-205-23></a>            <span class=nx>Model</span><span class=o>::</span><span class=na>TRANSACTION_INDEX</span> <span class=o>=&gt;</span> <span class=nv>$transaction</span><span class=p>,</span>
<a id=__codelineno-205-24 name=__codelineno-205-24 href=#__codelineno-205-24></a>            <span class=s1>&#39;column&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;inv_total&#39;</span><span class=p>,</span>
<a id=__codelineno-205-25 name=__codelineno-205-25 href=#__codelineno-205-25></a>            <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;inv_cst_id = :customerId:&#39;</span><span class=p>,</span>
<a id=__codelineno-205-26 name=__codelineno-205-26 href=#__codelineno-205-26></a>            <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-205-27 name=__codelineno-205-27 href=#__codelineno-205-27></a>                <span class=s1>&#39;customerId&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-205-28 name=__codelineno-205-28 href=#__codelineno-205-28></a>            <span class=p>],</span>
<a id=__codelineno-205-29 name=__codelineno-205-29 href=#__codelineno-205-29></a>        <span class=p>]</span>
<a id=__codelineno-205-30 name=__codelineno-205-30 href=#__codelineno-205-30></a>    <span class=p>);</span>
<a id=__codelineno-205-31 name=__codelineno-205-31 href=#__codelineno-205-31></a>
<a id=__codelineno-205-32 name=__codelineno-205-32 href=#__codelineno-205-32></a>    <span class=nv>$invoice</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Invoices</span><span class=p>();</span>
<a id=__codelineno-205-33 name=__codelineno-205-33 href=#__codelineno-205-33></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>setTransaction</span><span class=p>(</span><span class=nv>$transaction</span><span class=p>);</span>
<a id=__codelineno-205-34 name=__codelineno-205-34 href=#__codelineno-205-34></a>
<a id=__codelineno-205-35 name=__codelineno-205-35 href=#__codelineno-205-35></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_cst_id</span>      <span class=o>=</span> <span class=nv>$customer</span><span class=o>-&gt;</span><span class=na>cst_id</span><span class=p>;</span>
<a id=__codelineno-205-36 name=__codelineno-205-36 href=#__codelineno-205-36></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_status_flag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-205-37 name=__codelineno-205-37 href=#__codelineno-205-37></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_title</span>       <span class=o>=</span> <span class=s1>&#39;Invoice for ACME Inc.&#39;</span><span class=p>;</span>
<a id=__codelineno-205-38 name=__codelineno-205-38 href=#__codelineno-205-38></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_total</span>       <span class=o>=</span> <span class=mi>100</span> <span class=o>+</span> <span class=nv>$average</span><span class=p>;</span>
<a id=__codelineno-205-39 name=__codelineno-205-39 href=#__codelineno-205-39></a>    <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>inv_created_at</span>  <span class=o>=</span> <span class=s1>&#39;2019-12-25 01:02:03&#39;</span><span class=p>;</span>
<a id=__codelineno-205-40 name=__codelineno-205-40 href=#__codelineno-205-40></a>
<a id=__codelineno-205-41 name=__codelineno-205-41 href=#__codelineno-205-41></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$invoice</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-205-42 name=__codelineno-205-42 href=#__codelineno-205-42></a>        <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>(</span><span class=s1>&#39;Cannot save record&#39;</span><span class=p>);</span>
<a id=__codelineno-205-43 name=__codelineno-205-43 href=#__codelineno-205-43></a>    <span class=p>}</span>
<a id=__codelineno-205-44 name=__codelineno-205-44 href=#__codelineno-205-44></a>
<a id=__codelineno-205-45 name=__codelineno-205-45 href=#__codelineno-205-45></a>    <span class=nv>$transaction</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-205-46 name=__codelineno-205-46 href=#__codelineno-205-46></a><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Failed</span> <span class=nv>$ex</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-205-47 name=__codelineno-205-47 href=#__codelineno-205-47></a>    <span class=k>echo</span> <span class=s1>&#39;ERROR: &#39;</span><span class=p>,</span> <span class=nv>$ex</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>();</span>
<a id=__codelineno-205-48 name=__codelineno-205-48 href=#__codelineno-205-48></a><span class=p>}</span>
</code></pre></div> <h2 id=changing-schema>Changing Schema<a class=headerlink href=#changing-schema title="Permanent link">&para;</a></h2> <p>If a model is mapped to a table that is located in a different schema than the default, you can use the <code>setSchema()</code> to point to the correct location:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-206-1 name=__codelineno-206-1 href=#__codelineno-206-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-206-2 name=__codelineno-206-2 href=#__codelineno-206-2></a>
<a id=__codelineno-206-3 name=__codelineno-206-3 href=#__codelineno-206-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-206-4 name=__codelineno-206-4 href=#__codelineno-206-4></a>
<a id=__codelineno-206-5 name=__codelineno-206-5 href=#__codelineno-206-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-206-6 name=__codelineno-206-6 href=#__codelineno-206-6></a>
<a id=__codelineno-206-7 name=__codelineno-206-7 href=#__codelineno-206-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-206-8 name=__codelineno-206-8 href=#__codelineno-206-8></a><span class=p>{</span>
<a id=__codelineno-206-9 name=__codelineno-206-9 href=#__codelineno-206-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-206-10 name=__codelineno-206-10 href=#__codelineno-206-10></a>    <span class=p>{</span>
<a id=__codelineno-206-11 name=__codelineno-206-11 href=#__codelineno-206-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setSchema</span><span class=p>(</span><span class=s1>&#39;invoices&#39;</span><span class=p>);</span>
<a id=__codelineno-206-12 name=__codelineno-206-12 href=#__codelineno-206-12></a>    <span class=p>}</span>
<a id=__codelineno-206-13 name=__codelineno-206-13 href=#__codelineno-206-13></a><span class=p>}</span>
</code></pre></div> <h2 id=multiple-databases>Multiple Databases<a class=headerlink href=#multiple-databases title="Permanent link">&para;</a></h2> <p>Phalcon models by default connect to the same database connection (<code>db</code> service) that has been defined in the dependency injection container. However, you might need to connect specific models to different connections, which could be connections to different databases.</p> <p>We can define which model connects to which database in the <code>initialize</code> method of each model:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-207-1 name=__codelineno-207-1 href=#__codelineno-207-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-207-2 name=__codelineno-207-2 href=#__codelineno-207-2></a>
<a id=__codelineno-207-3 name=__codelineno-207-3 href=#__codelineno-207-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\FactoryDefault</span><span class=p>;</span>
<a id=__codelineno-207-4 name=__codelineno-207-4 href=#__codelineno-207-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Mysql</span><span class=p>;</span>
<a id=__codelineno-207-5 name=__codelineno-207-5 href=#__codelineno-207-5></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\PostgreSQL</span><span class=p>;</span>
<a id=__codelineno-207-6 name=__codelineno-207-6 href=#__codelineno-207-6></a>
<a id=__codelineno-207-7 name=__codelineno-207-7 href=#__codelineno-207-7></a><span class=nv>$container</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FactoryDefault</span><span class=p>();</span>
<a id=__codelineno-207-8 name=__codelineno-207-8 href=#__codelineno-207-8></a>
<a id=__codelineno-207-9 name=__codelineno-207-9 href=#__codelineno-207-9></a><span class=c1>// MySQL</span>
<a id=__codelineno-207-10 name=__codelineno-207-10 href=#__codelineno-207-10></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-207-11 name=__codelineno-207-11 href=#__codelineno-207-11></a>    <span class=s1>&#39;dbMysql&#39;</span><span class=p>,</span>
<a id=__codelineno-207-12 name=__codelineno-207-12 href=#__codelineno-207-12></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-207-13 name=__codelineno-207-13 href=#__codelineno-207-13></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Mysql</span><span class=p>(</span>
<a id=__codelineno-207-14 name=__codelineno-207-14 href=#__codelineno-207-14></a>            <span class=p>[</span>
<a id=__codelineno-207-15 name=__codelineno-207-15 href=#__codelineno-207-15></a>                <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-207-16 name=__codelineno-207-16 href=#__codelineno-207-16></a>                <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-207-17 name=__codelineno-207-17 href=#__codelineno-207-17></a>                <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-207-18 name=__codelineno-207-18 href=#__codelineno-207-18></a>                <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;tutorial&#39;</span><span class=p>,</span>
<a id=__codelineno-207-19 name=__codelineno-207-19 href=#__codelineno-207-19></a>            <span class=p>]</span>
<a id=__codelineno-207-20 name=__codelineno-207-20 href=#__codelineno-207-20></a>        <span class=p>);</span>
<a id=__codelineno-207-21 name=__codelineno-207-21 href=#__codelineno-207-21></a>    <span class=p>},</span>
<a id=__codelineno-207-22 name=__codelineno-207-22 href=#__codelineno-207-22></a>    <span class=k>true</span>
<a id=__codelineno-207-23 name=__codelineno-207-23 href=#__codelineno-207-23></a><span class=p>);</span>
<a id=__codelineno-207-24 name=__codelineno-207-24 href=#__codelineno-207-24></a>
<a id=__codelineno-207-25 name=__codelineno-207-25 href=#__codelineno-207-25></a><span class=c1>// PostgreSQL</span>
<a id=__codelineno-207-26 name=__codelineno-207-26 href=#__codelineno-207-26></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-207-27 name=__codelineno-207-27 href=#__codelineno-207-27></a>    <span class=s1>&#39;dbPostgres&#39;</span><span class=p>,</span>
<a id=__codelineno-207-28 name=__codelineno-207-28 href=#__codelineno-207-28></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-207-29 name=__codelineno-207-29 href=#__codelineno-207-29></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>PostgreSQL</span><span class=p>(</span>
<a id=__codelineno-207-30 name=__codelineno-207-30 href=#__codelineno-207-30></a>            <span class=p>[</span>
<a id=__codelineno-207-31 name=__codelineno-207-31 href=#__codelineno-207-31></a>                <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-207-32 name=__codelineno-207-32 href=#__codelineno-207-32></a>                <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;postgres&#39;</span><span class=p>,</span>
<a id=__codelineno-207-33 name=__codelineno-207-33 href=#__codelineno-207-33></a>                <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
<a id=__codelineno-207-34 name=__codelineno-207-34 href=#__codelineno-207-34></a>                <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;tutorial&#39;</span><span class=p>,</span>
<a id=__codelineno-207-35 name=__codelineno-207-35 href=#__codelineno-207-35></a>            <span class=p>]</span>
<a id=__codelineno-207-36 name=__codelineno-207-36 href=#__codelineno-207-36></a>        <span class=p>);</span>
<a id=__codelineno-207-37 name=__codelineno-207-37 href=#__codelineno-207-37></a>    <span class=p>}</span>
<a id=__codelineno-207-38 name=__codelineno-207-38 href=#__codelineno-207-38></a><span class=p>);</span>
</code></pre></div> <p>and in the <code>initialize()</code> method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-208-1 name=__codelineno-208-1 href=#__codelineno-208-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-208-2 name=__codelineno-208-2 href=#__codelineno-208-2></a>
<a id=__codelineno-208-3 name=__codelineno-208-3 href=#__codelineno-208-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-208-4 name=__codelineno-208-4 href=#__codelineno-208-4></a>
<a id=__codelineno-208-5 name=__codelineno-208-5 href=#__codelineno-208-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-208-6 name=__codelineno-208-6 href=#__codelineno-208-6></a>
<a id=__codelineno-208-7 name=__codelineno-208-7 href=#__codelineno-208-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-208-8 name=__codelineno-208-8 href=#__codelineno-208-8></a><span class=p>{</span>
<a id=__codelineno-208-9 name=__codelineno-208-9 href=#__codelineno-208-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-208-10 name=__codelineno-208-10 href=#__codelineno-208-10></a>    <span class=p>{</span>
<a id=__codelineno-208-11 name=__codelineno-208-11 href=#__codelineno-208-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setConnectionService</span><span class=p>(</span><span class=s1>&#39;dbPostgres&#39;</span><span class=p>);</span>
<a id=__codelineno-208-12 name=__codelineno-208-12 href=#__codelineno-208-12></a>    <span class=p>}</span>
<a id=__codelineno-208-13 name=__codelineno-208-13 href=#__codelineno-208-13></a><span class=p>}</span>
</code></pre></div> <p>Additional flexibility is available regarding database connections. You can specify a different connection for <code>read</code> operations and a different one for <code>write</code> operations. This is particularly useful when you have memory databases that can be used for read operations and different, more powerful databases that are used for <code>write</code> operations.</p> <p>You can set two different connections and utilize each database in each model transparently</p> <div class=highlight><pre><span></span><code><a id=__codelineno-209-1 name=__codelineno-209-1 href=#__codelineno-209-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-209-2 name=__codelineno-209-2 href=#__codelineno-209-2></a>
<a id=__codelineno-209-3 name=__codelineno-209-3 href=#__codelineno-209-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\FactoryDefault</span><span class=p>;</span>
<a id=__codelineno-209-4 name=__codelineno-209-4 href=#__codelineno-209-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Mysql</span><span class=p>;</span>
<a id=__codelineno-209-5 name=__codelineno-209-5 href=#__codelineno-209-5></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\PostgreSQL</span><span class=p>;</span>
<a id=__codelineno-209-6 name=__codelineno-209-6 href=#__codelineno-209-6></a>
<a id=__codelineno-209-7 name=__codelineno-209-7 href=#__codelineno-209-7></a><span class=nv>$container</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FactoryDefault</span><span class=p>();</span>
<a id=__codelineno-209-8 name=__codelineno-209-8 href=#__codelineno-209-8></a>
<a id=__codelineno-209-9 name=__codelineno-209-9 href=#__codelineno-209-9></a><span class=c1>// MySQL - read</span>
<a id=__codelineno-209-10 name=__codelineno-209-10 href=#__codelineno-209-10></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-209-11 name=__codelineno-209-11 href=#__codelineno-209-11></a>    <span class=s1>&#39;mysqlRead&#39;</span><span class=p>,</span>
<a id=__codelineno-209-12 name=__codelineno-209-12 href=#__codelineno-209-12></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-209-13 name=__codelineno-209-13 href=#__codelineno-209-13></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Mysql</span><span class=p>(</span>
<a id=__codelineno-209-14 name=__codelineno-209-14 href=#__codelineno-209-14></a>            <span class=p>[</span>
<a id=__codelineno-209-15 name=__codelineno-209-15 href=#__codelineno-209-15></a>                <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;10.0.4.100&#39;</span><span class=p>,</span>
<a id=__codelineno-209-16 name=__codelineno-209-16 href=#__codelineno-209-16></a>                <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-209-17 name=__codelineno-209-17 href=#__codelineno-209-17></a>                <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-209-18 name=__codelineno-209-18 href=#__codelineno-209-18></a>                <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;tutorial&#39;</span><span class=p>,</span>
<a id=__codelineno-209-19 name=__codelineno-209-19 href=#__codelineno-209-19></a>            <span class=p>]</span>
<a id=__codelineno-209-20 name=__codelineno-209-20 href=#__codelineno-209-20></a>        <span class=p>);</span>
<a id=__codelineno-209-21 name=__codelineno-209-21 href=#__codelineno-209-21></a>    <span class=p>},</span>
<a id=__codelineno-209-22 name=__codelineno-209-22 href=#__codelineno-209-22></a>    <span class=k>true</span>
<a id=__codelineno-209-23 name=__codelineno-209-23 href=#__codelineno-209-23></a><span class=p>);</span>
<a id=__codelineno-209-24 name=__codelineno-209-24 href=#__codelineno-209-24></a>
<a id=__codelineno-209-25 name=__codelineno-209-25 href=#__codelineno-209-25></a><span class=c1>// MySQL - write</span>
<a id=__codelineno-209-26 name=__codelineno-209-26 href=#__codelineno-209-26></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-209-27 name=__codelineno-209-27 href=#__codelineno-209-27></a>    <span class=s1>&#39;mysqlWrite&#39;</span><span class=p>,</span>
<a id=__codelineno-209-28 name=__codelineno-209-28 href=#__codelineno-209-28></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-209-29 name=__codelineno-209-29 href=#__codelineno-209-29></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Mysql</span><span class=p>(</span>
<a id=__codelineno-209-30 name=__codelineno-209-30 href=#__codelineno-209-30></a>            <span class=p>[</span>
<a id=__codelineno-209-31 name=__codelineno-209-31 href=#__codelineno-209-31></a>                <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;10.0.4.200&#39;</span><span class=p>,</span>
<a id=__codelineno-209-32 name=__codelineno-209-32 href=#__codelineno-209-32></a>                <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-209-33 name=__codelineno-209-33 href=#__codelineno-209-33></a>                <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-209-34 name=__codelineno-209-34 href=#__codelineno-209-34></a>                <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;tutorial&#39;</span><span class=p>,</span>
<a id=__codelineno-209-35 name=__codelineno-209-35 href=#__codelineno-209-35></a>            <span class=p>]</span>
<a id=__codelineno-209-36 name=__codelineno-209-36 href=#__codelineno-209-36></a>        <span class=p>);</span>
<a id=__codelineno-209-37 name=__codelineno-209-37 href=#__codelineno-209-37></a>    <span class=p>},</span>
<a id=__codelineno-209-38 name=__codelineno-209-38 href=#__codelineno-209-38></a>    <span class=k>true</span>
<a id=__codelineno-209-39 name=__codelineno-209-39 href=#__codelineno-209-39></a><span class=p>);</span>
</code></pre></div> <p>and in the <code>initialize()</code> method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-210-1 name=__codelineno-210-1 href=#__codelineno-210-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-210-2 name=__codelineno-210-2 href=#__codelineno-210-2></a>
<a id=__codelineno-210-3 name=__codelineno-210-3 href=#__codelineno-210-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-210-4 name=__codelineno-210-4 href=#__codelineno-210-4></a>
<a id=__codelineno-210-5 name=__codelineno-210-5 href=#__codelineno-210-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-210-6 name=__codelineno-210-6 href=#__codelineno-210-6></a>
<a id=__codelineno-210-7 name=__codelineno-210-7 href=#__codelineno-210-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-210-8 name=__codelineno-210-8 href=#__codelineno-210-8></a><span class=p>{</span>
<a id=__codelineno-210-9 name=__codelineno-210-9 href=#__codelineno-210-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-210-10 name=__codelineno-210-10 href=#__codelineno-210-10></a>    <span class=p>{</span>
<a id=__codelineno-210-11 name=__codelineno-210-11 href=#__codelineno-210-11></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setReadConnectionService</span><span class=p>(</span><span class=s1>&#39;mysqlRead&#39;</span><span class=p>);</span>
<a id=__codelineno-210-12 name=__codelineno-210-12 href=#__codelineno-210-12></a>
<a id=__codelineno-210-13 name=__codelineno-210-13 href=#__codelineno-210-13></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>setWriteConnectionService</span><span class=p>(</span><span class=s1>&#39;mysqlWrite&#39;</span><span class=p>);</span>
<a id=__codelineno-210-14 name=__codelineno-210-14 href=#__codelineno-210-14></a>    <span class=p>}</span>
<a id=__codelineno-210-15 name=__codelineno-210-15 href=#__codelineno-210-15></a><span class=p>}</span>
</code></pre></div> <p>The ORM also provides Horizontal Sharding features, by allowing you to implement a <code>shard</code> selection according to the query conditions:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-211-1 name=__codelineno-211-1 href=#__codelineno-211-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-211-2 name=__codelineno-211-2 href=#__codelineno-211-2></a>
<a id=__codelineno-211-3 name=__codelineno-211-3 href=#__codelineno-211-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-211-4 name=__codelineno-211-4 href=#__codelineno-211-4></a>
<a id=__codelineno-211-5 name=__codelineno-211-5 href=#__codelineno-211-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-211-6 name=__codelineno-211-6 href=#__codelineno-211-6></a>
<a id=__codelineno-211-7 name=__codelineno-211-7 href=#__codelineno-211-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-211-8 name=__codelineno-211-8 href=#__codelineno-211-8></a><span class=p>{</span>
<a id=__codelineno-211-9 name=__codelineno-211-9 href=#__codelineno-211-9></a>    <span class=sd>/**</span>
<a id=__codelineno-211-10 name=__codelineno-211-10 href=#__codelineno-211-10></a><span class=sd>     * Dynamically selects a shard</span>
<a id=__codelineno-211-11 name=__codelineno-211-11 href=#__codelineno-211-11></a><span class=sd>     *</span>
<a id=__codelineno-211-12 name=__codelineno-211-12 href=#__codelineno-211-12></a><span class=sd>     * @param array $intermediate</span>
<a id=__codelineno-211-13 name=__codelineno-211-13 href=#__codelineno-211-13></a><span class=sd>     * @param array $bindParams</span>
<a id=__codelineno-211-14 name=__codelineno-211-14 href=#__codelineno-211-14></a><span class=sd>     * @param array $bindTypes</span>
<a id=__codelineno-211-15 name=__codelineno-211-15 href=#__codelineno-211-15></a><span class=sd>     *</span>
<a id=__codelineno-211-16 name=__codelineno-211-16 href=#__codelineno-211-16></a><span class=sd>     * @return Phalcon\Db\Adapter\AdapterInterface</span>
<a id=__codelineno-211-17 name=__codelineno-211-17 href=#__codelineno-211-17></a><span class=sd>     */</span>
<a id=__codelineno-211-18 name=__codelineno-211-18 href=#__codelineno-211-18></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>selectReadConnection</span><span class=p>(</span>
<a id=__codelineno-211-19 name=__codelineno-211-19 href=#__codelineno-211-19></a>        <span class=k>array</span> <span class=nv>$intermediate</span><span class=p>,</span> 
<a id=__codelineno-211-20 name=__codelineno-211-20 href=#__codelineno-211-20></a>        <span class=k>array</span> <span class=nv>$bindParams</span><span class=p>,</span> 
<a id=__codelineno-211-21 name=__codelineno-211-21 href=#__codelineno-211-21></a>        <span class=k>array</span> <span class=nv>$bindTypes</span>
<a id=__codelineno-211-22 name=__codelineno-211-22 href=#__codelineno-211-22></a>    <span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-211-23 name=__codelineno-211-23 href=#__codelineno-211-23></a>        <span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>===</span> <span class=nb>isset</span><span class=p>(</span><span class=nv>$intermediate</span><span class=p>[</span><span class=s1>&#39;where&#39;</span><span class=p>]))</span> <span class=p>{</span>
<a id=__codelineno-211-24 name=__codelineno-211-24 href=#__codelineno-211-24></a>            <span class=nv>$conditions</span> <span class=o>=</span> <span class=nv>$intermediate</span><span class=p>[</span><span class=s1>&#39;where&#39;</span><span class=p>];</span>
<a id=__codelineno-211-25 name=__codelineno-211-25 href=#__codelineno-211-25></a>
<a id=__codelineno-211-26 name=__codelineno-211-26 href=#__codelineno-211-26></a>            <span class=k>if</span> <span class=p>(</span><span class=nv>$conditions</span><span class=p>[</span><span class=s1>&#39;left&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;id&#39;</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-211-27 name=__codelineno-211-27 href=#__codelineno-211-27></a>                <span class=nv>$id</span> <span class=o>=</span> <span class=nv>$conditions</span><span class=p>[</span><span class=s1>&#39;right&#39;</span><span class=p>][</span><span class=s1>&#39;value&#39;</span><span class=p>];</span>
<a id=__codelineno-211-28 name=__codelineno-211-28 href=#__codelineno-211-28></a>
<a id=__codelineno-211-29 name=__codelineno-211-29 href=#__codelineno-211-29></a>                <span class=k>if</span> <span class=p>(</span><span class=nv>$id</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=nv>$id</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-211-30 name=__codelineno-211-30 href=#__codelineno-211-30></a>                    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getDI</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;dbShard1&#39;</span><span class=p>);</span>
<a id=__codelineno-211-31 name=__codelineno-211-31 href=#__codelineno-211-31></a>                <span class=p>}</span>
<a id=__codelineno-211-32 name=__codelineno-211-32 href=#__codelineno-211-32></a>
<a id=__codelineno-211-33 name=__codelineno-211-33 href=#__codelineno-211-33></a>                <span class=k>if</span> <span class=p>(</span><span class=nv>$id</span> <span class=o>&gt;</span> <span class=mi>10000</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-211-34 name=__codelineno-211-34 href=#__codelineno-211-34></a>                    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getDI</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;dbShard2&#39;</span><span class=p>);</span>
<a id=__codelineno-211-35 name=__codelineno-211-35 href=#__codelineno-211-35></a>                <span class=p>}</span>
<a id=__codelineno-211-36 name=__codelineno-211-36 href=#__codelineno-211-36></a>            <span class=p>}</span>
<a id=__codelineno-211-37 name=__codelineno-211-37 href=#__codelineno-211-37></a>        <span class=p>}</span>
<a id=__codelineno-211-38 name=__codelineno-211-38 href=#__codelineno-211-38></a>
<a id=__codelineno-211-39 name=__codelineno-211-39 href=#__codelineno-211-39></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getDI</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;dbShard0&#39;</span><span class=p>);</span>
<a id=__codelineno-211-40 name=__codelineno-211-40 href=#__codelineno-211-40></a>    <span class=p>}</span>
<a id=__codelineno-211-41 name=__codelineno-211-41 href=#__codelineno-211-41></a><span class=p>}</span>
</code></pre></div> <p>In the above example, we are checking the <code>$intermediate</code> array, which is an array constructed internally in Phalcon, offering the intermediate representation of the query. We check if we have any <code>where</code> conditions. If not, we just use the default shard <code>dbShard0</code>.</p> <p>If conditions have been defined, we are checking if we have the <code>id</code> as a field in the conditions, and retrieve its value. If the <code>id</code> is between <code>0</code> and <code>100000</code> then we use <code>dbShard1</code>, alternatively <code>dbShard2</code>.</p> <p>The <code>selectReadConnection()</code> method is called every time we need to get data from the database, and returns the correct connection to be used.</p> <h2 id=dependency-injection>Dependency Injection<a class=headerlink href=#dependency-injection title="Permanent link">&para;</a></h2> <p><a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> is tightly bound to the DI container. You can retrieve the container by using the <code>getDI</code> method. Therefore, you have access to all services registered in the DI container.</p> <p>The following example shows you how you can print any messages generated by an unsuccessful <code>save</code> operation in the model and show these messages in the <a href=../flash/ >flash</a> messenger. To do this, we use the <code>notSaved</code> event:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-212-1 name=__codelineno-212-1 href=#__codelineno-212-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-212-2 name=__codelineno-212-2 href=#__codelineno-212-2></a>
<a id=__codelineno-212-3 name=__codelineno-212-3 href=#__codelineno-212-3></a><span class=k>namespace</span> <span class=nx>MyApp\Models</span><span class=p>;</span>
<a id=__codelineno-212-4 name=__codelineno-212-4 href=#__codelineno-212-4></a>
<a id=__codelineno-212-5 name=__codelineno-212-5 href=#__codelineno-212-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-212-6 name=__codelineno-212-6 href=#__codelineno-212-6></a>
<a id=__codelineno-212-7 name=__codelineno-212-7 href=#__codelineno-212-7></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-212-8 name=__codelineno-212-8 href=#__codelineno-212-8></a><span class=p>{</span>
<a id=__codelineno-212-9 name=__codelineno-212-9 href=#__codelineno-212-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>notSaved</span><span class=p>()</span>
<a id=__codelineno-212-10 name=__codelineno-212-10 href=#__codelineno-212-10></a>    <span class=p>{</span>
<a id=__codelineno-212-11 name=__codelineno-212-11 href=#__codelineno-212-11></a>        <span class=nv>$flash</span>    <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getDI</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>getFlash</span><span class=p>();</span>
<a id=__codelineno-212-12 name=__codelineno-212-12 href=#__codelineno-212-12></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-212-13 name=__codelineno-212-13 href=#__codelineno-212-13></a>
<a id=__codelineno-212-14 name=__codelineno-212-14 href=#__codelineno-212-14></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-212-15 name=__codelineno-212-15 href=#__codelineno-212-15></a>            <span class=nv>$flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-212-16 name=__codelineno-212-16 href=#__codelineno-212-16></a>        <span class=p>}</span>
<a id=__codelineno-212-17 name=__codelineno-212-17 href=#__codelineno-212-17></a>    <span class=p>}</span>
<a id=__codelineno-212-18 name=__codelineno-212-18 href=#__codelineno-212-18></a><span class=p>}</span>
</code></pre></div> <h2 id=model-features>Model Features<a class=headerlink href=#model-features title="Permanent link">&para;</a></h2> <p>The ORM has several options that control specific behaviors globally. You can enable or disable these features by adding specific lines to your <code>php.ini</code> file or using the <code>setup</code> static method on the model. You can enable or disable these features temporarily in your code or permanently.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-213-1 name=__codelineno-213-1 href=#__codelineno-213-1></a><span class=na>phalcon.orm.column_renaming</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>false</span>
<a id=__codelineno-213-2 name=__codelineno-213-2 href=#__codelineno-213-2></a><span class=na>phalcon.orm.events</span><span class=w>          </span><span class=o>=</span><span class=w> </span><span class=s>false</span>
</code></pre></div> <p>or by using the <code>Model</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-214-1 name=__codelineno-214-1 href=#__codelineno-214-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-214-2 name=__codelineno-214-2 href=#__codelineno-214-2></a>
<a id=__codelineno-214-3 name=__codelineno-214-3 href=#__codelineno-214-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-214-4 name=__codelineno-214-4 href=#__codelineno-214-4></a>
<a id=__codelineno-214-5 name=__codelineno-214-5 href=#__codelineno-214-5></a><span class=nx>Model</span><span class=o>::</span><span class=na>setup</span><span class=p>(</span>
<a id=__codelineno-214-6 name=__codelineno-214-6 href=#__codelineno-214-6></a>    <span class=p>[</span>
<a id=__codelineno-214-7 name=__codelineno-214-7 href=#__codelineno-214-7></a>        <span class=s1>&#39;columnRenaming&#39;</span> <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-214-8 name=__codelineno-214-8 href=#__codelineno-214-8></a>        <span class=s1>&#39;events&#39;</span>         <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-214-9 name=__codelineno-214-9 href=#__codelineno-214-9></a>    <span class=p>]</span>
<a id=__codelineno-214-10 name=__codelineno-214-10 href=#__codelineno-214-10></a><span class=p>);</span>
</code></pre></div> <p>The available options are:</p> <table> <thead> <tr> <th>Option</th> <th style="text-align: center;">Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>caseInsensitiveColumnMap</code></td> <td style="text-align: center;"><code>false</code></td> <td>Case insensitive column map</td> </tr> <tr> <td><code>castLastInsertIdToInt</code></td> <td style="text-align: center;"><code>false</code></td> <td>Casts the <code>lastInsertId</code> to an integer</td> </tr> <tr> <td><code>castOnHydrate</code></td> <td style="text-align: center;"><code>false</code></td> <td>Automatic cast to original types on hydration</td> </tr> <tr> <td><code>columnRenaming</code></td> <td style="text-align: center;"><code>true</code></td> <td>Column renaming</td> </tr> <tr> <td><code>disableAssignSetters</code></td> <td style="text-align: center;"><code>false</code></td> <td>Disable setters</td> </tr> <tr> <td><code>enableImplicitJoins</code></td> <td style="text-align: center;"><code>true</code></td> <td>Enable implicit joins</td> </tr> <tr> <td><code>events</code></td> <td style="text-align: center;"><code>true</code></td> <td>Callbacks, hooks, and event notifications from all the models</td> </tr> <tr> <td><code>exceptionOnFailedMetaDataSave</code></td> <td style="text-align: center;"><code>false</code></td> <td>Throw an exception when there is a failed meta-data save</td> </tr> <tr> <td><code>exceptionOnFailedSave</code></td> <td style="text-align: center;"><code>false</code></td> <td>Throw an exception when there is a failed <code>save()</code></td> </tr> <tr> <td><code>forceCasting</code></td> <td style="text-align: center;"><code>false</code></td> <td>Force casting bound parameters to their native types</td> </tr> <tr> <td><code>ignoreUnknownColumns</code></td> <td style="text-align: center;"><code>false</code></td> <td>Ignore unknown columns on the model</td> </tr> <tr> <td><code>lateStateBinding</code></td> <td style="text-align: center;"><code>false</code></td> <td>Late state binding of the <code>Phalcon\Mvc\Model::cloneResultMap()</code> method</td> </tr> <tr> <td><code>notNullValidations</code></td> <td style="text-align: center;"><code>true</code></td> <td>Automatically validate the not <code>null</code> columns present</td> </tr> <tr> <td><code>phqlLiterals</code></td> <td style="text-align: center;"><code>true</code></td> <td>Literals in the PHQL parser</td> </tr> <tr> <td><code>prefetchRecords</code></td> <td style="text-align: center;"><code>0</code></td> <td>The number of records to prefetch when getting data from the ORM</td> </tr> <tr> <td><code>updateSnapshotOnSave</code></td> <td style="text-align: center;"><code>true</code></td> <td>Update snapshots on <code>save()</code></td> </tr> <tr> <td><code>virtualForeignKeys</code></td> <td style="text-align: center;"><code>true</code></td> <td>Virtual foreign keys</td> </tr> </tbody> </table> <p><code>ini</code> options:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-215-1 name=__codelineno-215-1 href=#__codelineno-215-1></a>; phalcon.orm.cache_level = 3
<a id=__codelineno-215-2 name=__codelineno-215-2 href=#__codelineno-215-2></a>; phalcon.orm.case_insensitive_column_map = false
<a id=__codelineno-215-3 name=__codelineno-215-3 href=#__codelineno-215-3></a>; phalcon.orm.cast_last_insert_id_to_int = false
<a id=__codelineno-215-4 name=__codelineno-215-4 href=#__codelineno-215-4></a>; phalcon.orm.cast_on_hydrate = false
<a id=__codelineno-215-5 name=__codelineno-215-5 href=#__codelineno-215-5></a>; phalcon.orm.column_renaming = true
<a id=__codelineno-215-6 name=__codelineno-215-6 href=#__codelineno-215-6></a>; phalcon.orm.disable_assign_setters = false
<a id=__codelineno-215-7 name=__codelineno-215-7 href=#__codelineno-215-7></a>; phalcon.orm.enable_implicit_joins = true
<a id=__codelineno-215-8 name=__codelineno-215-8 href=#__codelineno-215-8></a>; phalcon.orm.enable_literals = true
<a id=__codelineno-215-9 name=__codelineno-215-9 href=#__codelineno-215-9></a>; phalcon.orm.events = true
<a id=__codelineno-215-10 name=__codelineno-215-10 href=#__codelineno-215-10></a>; phalcon.orm.exception_on_failed_metadata_save = true
<a id=__codelineno-215-11 name=__codelineno-215-11 href=#__codelineno-215-11></a>; phalcon.orm.exception_on_failed_save = false
<a id=__codelineno-215-12 name=__codelineno-215-12 href=#__codelineno-215-12></a>; phalcon.orm.force_casting = false
<a id=__codelineno-215-13 name=__codelineno-215-13 href=#__codelineno-215-13></a>; phalcon.orm.ignore_unknown_columns = false
<a id=__codelineno-215-14 name=__codelineno-215-14 href=#__codelineno-215-14></a>; phalcon.orm.late_state_binding = false
<a id=__codelineno-215-15 name=__codelineno-215-15 href=#__codelineno-215-15></a>; phalcon.orm.not_null_validations = true
<a id=__codelineno-215-16 name=__codelineno-215-16 href=#__codelineno-215-16></a>; phalcon.orm.resultset_prefetch_records = &quot;0&quot;
<a id=__codelineno-215-17 name=__codelineno-215-17 href=#__codelineno-215-17></a>; phalcon.orm.unique_cache_id = 3
<a id=__codelineno-215-18 name=__codelineno-215-18 href=#__codelineno-215-18></a>; phalcon.orm.update_snapshot_on_save = true
<a id=__codelineno-215-19 name=__codelineno-215-19 href=#__codelineno-215-19></a>; phalcon.orm.virtual_foreign_keys = true
<a id=__codelineno-215-20 name=__codelineno-215-20 href=#__codelineno-215-20></a>; phalcon.db.escape_identifiers = On
<a id=__codelineno-215-21 name=__codelineno-215-21 href=#__codelineno-215-21></a>; phalcon.db.force_casting = Off
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>NOTE</p> <p><code>Phalcon\Mvc\Model::assign()</code> (which is used also when creating/updating/saving model) is always using setters if they exist when data arguments are passed, even when it's required or necessary. This will add some additional overhead to your application. You can change this behavior by adding <code>phalcon.orm.disable_assign_setters = 1</code> to your ini file, it will just simply use <code>$this-&gt;property = value</code>.</p> </div> <h2 id=integers-vs-strings>Integers vs. Strings<a class=headerlink href=#integers-vs-strings title="Permanent link">&para;</a></h2> <p>If you want to get integer values back from <code>int</code> related database fields, you will need to do the following: - Make sure that the <code>castOnHydrate</code> (or set <code>ini_set('phalcon.orm.cast_on_hydrate', 'on')</code>) is enabled</p> <div class=highlight><pre><span></span><code><a id=__codelineno-216-1 name=__codelineno-216-1 href=#__codelineno-216-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-216-2 name=__codelineno-216-2 href=#__codelineno-216-2></a>
<a id=__codelineno-216-3 name=__codelineno-216-3 href=#__codelineno-216-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-216-4 name=__codelineno-216-4 href=#__codelineno-216-4></a>
<a id=__codelineno-216-5 name=__codelineno-216-5 href=#__codelineno-216-5></a><span class=nx>Model</span><span class=o>::</span><span class=na>setup</span><span class=p>(</span>
<a id=__codelineno-216-6 name=__codelineno-216-6 href=#__codelineno-216-6></a>    <span class=p>[</span>
<a id=__codelineno-216-7 name=__codelineno-216-7 href=#__codelineno-216-7></a>        <span class=s1>&#39;castOnHydrate&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-216-8 name=__codelineno-216-8 href=#__codelineno-216-8></a>    <span class=p>]</span>
<a id=__codelineno-216-9 name=__codelineno-216-9 href=#__codelineno-216-9></a><span class=p>);</span>
</code></pre></div> <ul> <li>Ensure that you are using the <code>mysqlnd</code> driver on your server. You can check that using <code>phpinfo()</code> (pdo_mysql &gt; Client API version)</li> <li>In your database connection provider you need to pass the following options:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-217-1 name=__codelineno-217-1 href=#__codelineno-217-1></a><span class=p>[</span>
<a id=__codelineno-217-2 name=__codelineno-217-2 href=#__codelineno-217-2></a>    <span class=nx>PDO</span><span class=o>::</span><span class=na>ATTR_EMULATE_PREPARES</span>  <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-217-3 name=__codelineno-217-3 href=#__codelineno-217-3></a>    <span class=nx>PDO</span><span class=o>::</span><span class=na>ATTR_STRINGIFY_FETCHES</span> <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-217-4 name=__codelineno-217-4 href=#__codelineno-217-4></a><span class=p>]</span>
</code></pre></div> <p>Registering the provider should look like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-218-1 name=__codelineno-218-1 href=#__codelineno-218-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-218-2 name=__codelineno-218-2 href=#__codelineno-218-2></a>
<a id=__codelineno-218-3 name=__codelineno-218-3 href=#__codelineno-218-3></a><span class=nv>$parameters</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-218-4 name=__codelineno-218-4 href=#__codelineno-218-4></a>  <span class=c1>// ....</span>
<a id=__codelineno-218-5 name=__codelineno-218-5 href=#__codelineno-218-5></a><span class=p>];</span>
<a id=__codelineno-218-6 name=__codelineno-218-6 href=#__codelineno-218-6></a>
<a id=__codelineno-218-7 name=__codelineno-218-7 href=#__codelineno-218-7></a><span class=sd>/** @var Manager $eventsManager */</span>
<a id=__codelineno-218-8 name=__codelineno-218-8 href=#__codelineno-218-8></a><span class=nv>$eventsManager</span> <span class=o>=</span> <span class=nv>$container</span><span class=o>-&gt;</span><span class=na>getShared</span><span class=p>(</span><span class=s1>&#39;eventsManager&#39;</span><span class=p>);</span>
<a id=__codelineno-218-9 name=__codelineno-218-9 href=#__codelineno-218-9></a>
<a id=__codelineno-218-10 name=__codelineno-218-10 href=#__codelineno-218-10></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span>
<a id=__codelineno-218-11 name=__codelineno-218-11 href=#__codelineno-218-11></a>    <span class=s1>&#39;db&#39;</span><span class=p>,</span>
<a id=__codelineno-218-12 name=__codelineno-218-12 href=#__codelineno-218-12></a>    <span class=k>function</span> <span class=p>()</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$eventsManager</span><span class=p>,</span> <span class=nv>$parameters</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-218-13 name=__codelineno-218-13 href=#__codelineno-218-13></a>        <span class=nv>$options</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-218-14 name=__codelineno-218-14 href=#__codelineno-218-14></a>            <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;host&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-218-15 name=__codelineno-218-15 href=#__codelineno-218-15></a>            <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;dbname&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;phalcon&#39;</span><span class=p>,</span>
<a id=__codelineno-218-16 name=__codelineno-218-16 href=#__codelineno-218-16></a>            <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-218-17 name=__codelineno-218-17 href=#__codelineno-218-17></a>            <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;pass&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-218-18 name=__codelineno-218-18 href=#__codelineno-218-18></a>            <span class=s1>&#39;encoding&#39;</span> <span class=o>=&gt;</span> <span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;encoding&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;utf8&#39;</span><span class=p>,</span>
<a id=__codelineno-218-19 name=__codelineno-218-19 href=#__codelineno-218-19></a>            <span class=s1>&#39;options&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-218-20 name=__codelineno-218-20 href=#__codelineno-218-20></a>                <span class=nx>PDO</span><span class=o>::</span><span class=na>ATTR_EMULATE_PREPARES</span>  <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-218-21 name=__codelineno-218-21 href=#__codelineno-218-21></a>                <span class=nx>PDO</span><span class=o>::</span><span class=na>ATTR_STRINGIFY_FETCHES</span> <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
<a id=__codelineno-218-22 name=__codelineno-218-22 href=#__codelineno-218-22></a>            <span class=p>]</span>
<a id=__codelineno-218-23 name=__codelineno-218-23 href=#__codelineno-218-23></a>        <span class=p>];</span>
<a id=__codelineno-218-24 name=__codelineno-218-24 href=#__codelineno-218-24></a>
<a id=__codelineno-218-25 name=__codelineno-218-25 href=#__codelineno-218-25></a>        <span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Mysql</span><span class=p>(</span><span class=nv>$options</span><span class=p>);</span>
<a id=__codelineno-218-26 name=__codelineno-218-26 href=#__codelineno-218-26></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
<a id=__codelineno-218-27 name=__codelineno-218-27 href=#__codelineno-218-27></a>
<a id=__codelineno-218-28 name=__codelineno-218-28 href=#__codelineno-218-28></a>        <span class=k>return</span> <span class=nv>$connection</span><span class=p>;</span>
<a id=__codelineno-218-29 name=__codelineno-218-29 href=#__codelineno-218-29></a>    <span class=p>);</span>
<a id=__codelineno-218-30 name=__codelineno-218-30 href=#__codelineno-218-30></a><span class=p>}</span>
</code></pre></div> <h2 id=invalid-parameter-number>Invalid parameter number<a class=headerlink href=#invalid-parameter-number title="Permanent link">&para;</a></h2> <p>In v5.6, the parameters used to instantiate PDO have reverted to the default settings. Therefore, <code>PDO::ATTR_EMULATE_PREPARES</code> defaults to <code>true</code>.</p> <p>However, if you encounter the following message in your code, when a bound parameter is used more than once in a query:</p> <div class="admonition warning"> <p class=admonition-title>Error</p> <p>Invalid parameter number</p> </div> <p>You can check the PDO parameters and ensure that <code>PDO::ATTR_EMULATE_PREPARES</code> is set to <code>true</code>, when registering your database provider.</p> <h2 id=stand-alone-component>Stand-Alone Component<a class=headerlink href=#stand-alone-component title="Permanent link">&para;</a></h2> <p>You can use <a href=../api/phalcon_mvc/#mvcmodel-->Phalcon\Mvc\Model</a> on its own, performing the necessary setup on your own if you wish. The example below demonstrates how you can achieve that.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-219-1 name=__codelineno-219-1 href=#__codelineno-219-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-219-2 name=__codelineno-219-2 href=#__codelineno-219-2></a>
<a id=__codelineno-219-3 name=__codelineno-219-3 href=#__codelineno-219-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\Di</span><span class=p>;</span>
<a id=__codelineno-219-4 name=__codelineno-219-4 href=#__codelineno-219-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-219-5 name=__codelineno-219-5 href=#__codelineno-219-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Manager</span><span class=p>;</span>
<a id=__codelineno-219-6 name=__codelineno-219-6 href=#__codelineno-219-6></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Sqlite</span><span class=p>;</span>
<a id=__codelineno-219-7 name=__codelineno-219-7 href=#__codelineno-219-7></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model\Metadata\Memory</span><span class=p>;</span>
<a id=__codelineno-219-8 name=__codelineno-219-8 href=#__codelineno-219-8></a>
<a id=__codelineno-219-9 name=__codelineno-219-9 href=#__codelineno-219-9></a><span class=nv>$container</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Di</span><span class=p>();</span>
<a id=__codelineno-219-10 name=__codelineno-219-10 href=#__codelineno-219-10></a>
<a id=__codelineno-219-11 name=__codelineno-219-11 href=#__codelineno-219-11></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-219-12 name=__codelineno-219-12 href=#__codelineno-219-12></a>    <span class=s1>&#39;db&#39;</span><span class=p>,</span>
<a id=__codelineno-219-13 name=__codelineno-219-13 href=#__codelineno-219-13></a>    <span class=k>new</span> <span class=nx>Sqlite</span><span class=p>(</span>
<a id=__codelineno-219-14 name=__codelineno-219-14 href=#__codelineno-219-14></a>        <span class=p>[</span>
<a id=__codelineno-219-15 name=__codelineno-219-15 href=#__codelineno-219-15></a>            <span class=s1>&#39;dbname&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sample.db&#39;</span><span class=p>,</span>
<a id=__codelineno-219-16 name=__codelineno-219-16 href=#__codelineno-219-16></a>        <span class=p>]</span>
<a id=__codelineno-219-17 name=__codelineno-219-17 href=#__codelineno-219-17></a>    <span class=p>)</span>
<a id=__codelineno-219-18 name=__codelineno-219-18 href=#__codelineno-219-18></a><span class=p>);</span>
<a id=__codelineno-219-19 name=__codelineno-219-19 href=#__codelineno-219-19></a>
<a id=__codelineno-219-20 name=__codelineno-219-20 href=#__codelineno-219-20></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-219-21 name=__codelineno-219-21 href=#__codelineno-219-21></a>    <span class=s1>&#39;modelsManager&#39;</span><span class=p>,</span>
<a id=__codelineno-219-22 name=__codelineno-219-22 href=#__codelineno-219-22></a>    <span class=k>new</span> <span class=nx>Manager</span><span class=p>()</span>
<a id=__codelineno-219-23 name=__codelineno-219-23 href=#__codelineno-219-23></a><span class=p>);</span>
<a id=__codelineno-219-24 name=__codelineno-219-24 href=#__codelineno-219-24></a>
<a id=__codelineno-219-25 name=__codelineno-219-25 href=#__codelineno-219-25></a><span class=nv>$container</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-219-26 name=__codelineno-219-26 href=#__codelineno-219-26></a>    <span class=s1>&#39;modelsMetadata&#39;</span><span class=p>,</span>
<a id=__codelineno-219-27 name=__codelineno-219-27 href=#__codelineno-219-27></a>    <span class=k>new</span> <span class=nx>Memory</span><span class=p>()</span>
<a id=__codelineno-219-28 name=__codelineno-219-28 href=#__codelineno-219-28></a><span class=p>);</span>
<a id=__codelineno-219-29 name=__codelineno-219-29 href=#__codelineno-219-29></a>
<a id=__codelineno-219-30 name=__codelineno-219-30 href=#__codelineno-219-30></a>
<a id=__codelineno-219-31 name=__codelineno-219-31 href=#__codelineno-219-31></a><span class=k>class</span> <span class=nc>Invoices</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-219-32 name=__codelineno-219-32 href=#__codelineno-219-32></a><span class=p>{</span>
<a id=__codelineno-219-33 name=__codelineno-219-33 href=#__codelineno-219-33></a>
<a id=__codelineno-219-34 name=__codelineno-219-34 href=#__codelineno-219-34></a><span class=p>}</span>
<a id=__codelineno-219-35 name=__codelineno-219-35 href=#__codelineno-219-35></a>
<a id=__codelineno-219-36 name=__codelineno-219-36 href=#__codelineno-219-36></a><span class=k>echo</span> <span class=nx>Invoices</span><span class=o>::</span><span class=na>count</span><span class=p>();</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../db-odm/ class="md-footer__link md-footer__link--prev" aria-label="Previous: ODM"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> ODM </div> </div> </a> <a href=../db-models-behaviors/ class="md-footer__link md-footer__link--next" aria-label="Next: Behaviors"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Behaviors </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2012 - present Phalcon Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://phalcon.io/discord target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://phalcon.io/discussions target=_blank rel=noopener title="GitHub Discussions" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29H9Z"/></svg> </a> <a href=https://phalcon.io/github target=_blank rel=noopener title="GitHub Project" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://phalcon.io/telegram target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg> </a> <a href=https://phalcon.io/gab target=_blank rel=noopener title=Gab class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M368 32c41.7 0 75.9 31.8 79.7 72.5l85.6 26.3c25.4 7.8 42.8 31.3 42.8 57.9 0 21.8-11.7 41.9-30.7 52.7l-144.6 82.1 92.5 92.5H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c-8.5 0-16.6-3.4-22.6-9.4L346.9 360.2c11.7-36 3.2-77.1-25.4-105.7-40.6-40.6-106.3-40.6-146.9-.1l-73.6 70c-6.4 6.1-6.7 16.2-.6 22.6s16.2 6.6 22.6.6l73.8-70.2.1-.1.1-.1c3.5-3.5 7.3-6.6 11.3-9.2 27.9-18.5 65.9-15.4 90.5 9.2 24.7 24.7 27.7 62.9 9 90.9-2.6 3.8-5.6 7.5-9 10.9l-37 37H352c17.7 0 32 14.3 32 32s-14.3 32-32 32H64c-35.3 0-64-28.7-64-64C0 249.6 127 112.9 289.3 97.5 296.2 60.2 328.8 32 368 32zm0 104a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"/></svg> </a> <a href=https://phalcon.io/t target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href=https://phalcon.io/fb target=_blank rel=noopener title=Facebook class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg> </a> <a href=https://phalcon.io/linkedin target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://phalcon.io/youtube target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "5.4.0", "provider": "mike"}}</script> <script src=../assets/javascripts/bundle.caa56a14.min.js></script> </body> </html>