<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Phalcon Framework. A full-stack PHP framework delivered as a PHP extension, offering lower resource consumption and high performance."><meta name=author content="Phalcon Team"><link href=https://docs.phalcon.io/3.4/db-layer/ rel=canonical><link href=../api/ rel=prev><link href=../db-phql/ rel=next><link rel=icon href=../assets/images/favicon.ico><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>Layer - Phalcon Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Titillium+Web:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Titillium Web";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../assets/css/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-JR4REKBKH3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-JR4REKBKH3",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-JR4REKBKH3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Fanart --><!--

Phalcon Framework

A full-stack PHP framework delivered as a PHP extension,
offering lower resource consumption and high performance.

<3 Phalcon Team

                         ..
                         ....
   %                  ,   ......
     %%%               ,,  .......
      %%%%%%           ,,,,.........
       %%%%%%%%&        ,,,,,.........,
    /    %%%%%%%%%%      ,,,,,,..........
      //  %%%%%%%%%%%%%    ,,,,,,..........
       //// %%%%%%%%%%%%%%%  ,,,,,,..........,
         ////%%%%%%%%%%%%%%%%%%,,,,,,...........
          ///////%%%%%%%%%%%%%%%%%%,,,,...........
            ////////%%%%%%%%%%%%%%%%%%/,,...........
          %%%%/////////(%%%%%%%%%%%%%%%%%%,..........
            %%%%%//////////%%%%%%%%%%%%%%%%%%........(
               %%%%///////////(%%%%%%%%%%%%%%%%.......(
                 %%%%%////////////%%%%%%%%%%%%%%%.....//
                ....%%%%%////////////#%%%%%%%%%%%%%....//
                   .......(%/////////////%%%%%%%%%%%%..  /
                      ...........///////********/%%%%%..
                     ,,,,.............,/***************.
                         ,,,,,.............************......,/(
                               ,,,,,,..........********.....//////////
                              ((((((((**((((((((((((((*.....///////////
                                  %*********.../(((((((..........///(/#/
                               **********..........#%%%           ..*%%%
                            *********(..........%%%                  %%%
                         *********/..........%%%                     %%
                   %    *******%%.........%%%%
                  %   ******%%%%...../.*((((((   %%%%
                     ****%%%%%%.....///* (((((((%%%%%
                    ***&%%%%%%.....////* ((((((((%%  %
                    *  &%%%%%#..../////*  (((     %
                       &%%%%%....//////*           %
                        %%%% ....//////***   %%%
                     (  %%%   ...*/////*****%%%%
                     (   %     ...  //(*****/%%
                      (  &      ..   // ***  %%
                                 .     /      %
--><!-- Fanart --></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#database-abstraction-layer class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Phalcon Documentation" class="md-header__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Phalcon Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Layer </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../introduction/ class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../application/ class=md-tabs__link> Core </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Database </a> </li> <li class=md-tabs__item> <a href=../assets/ class=md-tabs__link> Front End </a> </li> <li class=md-tabs__item> <a href=../acl/ class=md-tabs__link> Business Logic </a> </li> <li class=md-tabs__item> <a href=../cache/ class=md-tabs__link> Services </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Phalcon Documentation" class="md-nav__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> Phalcon Documentation </label> <div class=md-nav__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0> <span class=md-ellipsis> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/phalcon/cphalcon/tree/master/resources class=md-nav__link> <span class=md-ellipsis> Current Version </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_3> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../contributions/ class=md-nav__link> <span class=md-ellipsis> Contributions </span> </a> </li> <li class=md-nav__item> <a href=https://phalcon.io/discussions class=md-nav__link> <span class=md-ellipsis> Asking a question </span> </a> </li> <li class=md-nav__item> <a href=../new-feature-request/ class=md-nav__link> <span class=md-ellipsis> Requesting a change </span> </a> </li> <li class=md-nav__item> <a href=../new-pull-request/ class=md-nav__link> <span class=md-ellipsis> Issuing a Pull Request </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../generating-backtrace/ class=md-nav__link> <span class=md-ellipsis> Backtrace Generation </span> </a> </li> <li class=md-nav__item> <a href=../reproducible-tests/ class=md-nav__link> <span class=md-ellipsis> Reproducible Tests </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sponsors/ class=md-nav__link> <span class=md-ellipsis> Sponsoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../webserver-setup/ class=md-nav__link> <span class=md-ellipsis> Webserver Setup </span> </a> </li> <li class=md-nav__item> <a href=../webserver-wamp/ class=md-nav__link> <span class=md-ellipsis> WAMP </span> </a> </li> <li class=md-nav__item> <a href=../webserver-xampp/ class=md-nav__link> <span class=md-ellipsis> XAMPP </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> Environments </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Environments </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../environments-nanobox/ class=md-nav__link> <span class=md-ellipsis> Nanobox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> Development Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Development Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../devtools-installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../devtools-usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../debug/ class=md-nav__link> <span class=md-ellipsis> Debug </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorial-basic/ class=md-nav__link> <span class=md-ellipsis> Basic </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-invo/ class=md-nav__link> <span class=md-ellipsis> Invo </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-rest/ class=md-nav__link> <span class=md-ellipsis> REST </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-vokuro/ class=md-nav__link> <span class=md-ellipsis> Vokuro </span> </a> </li> <li class=md-nav__item> <a href=../performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../api/ class="md-nav__link "> <span class=md-ellipsis> Core </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../application/ class=md-nav__link> <span class=md-ellipsis> Application </span> </a> </li> <li class=md-nav__item> <a href=../application-micro/ class=md-nav__link> <span class=md-ellipsis> Micro </span> </a> </li> <li class=md-nav__item> <a href=../application-cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../di/ class=md-nav__link> <span class=md-ellipsis> DI Container </span> </a> </li> <li class=md-nav__item> <a href=../mvc/ class=md-nav__link> <span class=md-ellipsis> MVC </span> </a> </li> <li class=md-nav__item> <a href=../namespaces/ class=md-nav__link> <span class=md-ellipsis> Namespaces </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Layer </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Layer </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#database-adapters class=md-nav__link> <span class=md-ellipsis> Database Adapters </span> </a> <nav class=md-nav aria-label="Database Adapters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#factory class=md-nav__link> <span class=md-ellipsis> Factory </span> </a> </li> <li class=md-nav__item> <a href=#implementing-your-own-adapters class=md-nav__link> <span class=md-ellipsis> Implementing your own adapters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-dialects class=md-nav__link> <span class=md-ellipsis> Database Dialects </span> </a> <nav class=md-nav aria-label="Database Dialects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementing-your-own-dialects class=md-nav__link> <span class=md-ellipsis> Implementing your own dialects </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#connecting-to-databases class=md-nav__link> <span class=md-ellipsis> Connecting to Databases </span> </a> <nav class=md-nav aria-label="Connecting to Databases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mysql-required-elements class=md-nav__link> <span class=md-ellipsis> MySQL Required elements </span> </a> </li> <li class=md-nav__item> <a href=#mysql-optional class=md-nav__link> <span class=md-ellipsis> MySQL Optional </span> </a> </li> <li class=md-nav__item> <a href=#mysql-create-a-connection class=md-nav__link> <span class=md-ellipsis> MySQL Create a connection </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-required-elements class=md-nav__link> <span class=md-ellipsis> PostgreSQL Required elements </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-optional class=md-nav__link> <span class=md-ellipsis> PostgreSQL Optional </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-create-a-connection class=md-nav__link> <span class=md-ellipsis> PostgreSQL Create a connection </span> </a> </li> <li class=md-nav__item> <a href=#sqlite-required-elements class=md-nav__link> <span class=md-ellipsis> SQLite Required elements </span> </a> </li> <li class=md-nav__item> <a href=#sqlite-create-a-connection class=md-nav__link> <span class=md-ellipsis> SQLite Create a connection </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-additional-pdo-options class=md-nav__link> <span class=md-ellipsis> Setting up additional PDO options </span> </a> </li> <li class=md-nav__item> <a href=#connecting-using-factory class=md-nav__link> <span class=md-ellipsis> Connecting using Factory </span> </a> </li> <li class=md-nav__item> <a href=#finding-rows class=md-nav__link> <span class=md-ellipsis> Finding Rows </span> </a> </li> <li class=md-nav__item> <a href=#binding-parameters class=md-nav__link> <span class=md-ellipsis> Binding Parameters </span> </a> </li> <li class=md-nav__item> <a href=#typed-placeholders class=md-nav__link> <span class=md-ellipsis> Typed placeholders </span> </a> </li> <li class=md-nav__item> <a href=#cast-bound-parameters-values class=md-nav__link> <span class=md-ellipsis> Cast bound parameters values </span> </a> </li> <li class=md-nav__item> <a href=#cast-on-hydrate class=md-nav__link> <span class=md-ellipsis> Cast on Hydrate </span> </a> </li> <li class=md-nav__item> <a href=#insertingupdatingdeleting-rows class=md-nav__link> <span class=md-ellipsis> Inserting/Updating/Deleting Rows </span> </a> </li> <li class=md-nav__item> <a href=#transactions-and-nested-transactions class=md-nav__link> <span class=md-ellipsis> Transactions and Nested Transactions </span> </a> </li> <li class=md-nav__item> <a href=#database-events class=md-nav__link> <span class=md-ellipsis> Database Events </span> </a> </li> <li class=md-nav__item> <a href=#profiling-sql-statements class=md-nav__link> <span class=md-ellipsis> Profiling SQL Statements </span> </a> </li> <li class=md-nav__item> <a href=#logging-sql-statements class=md-nav__link> <span class=md-ellipsis> Logging SQL Statements </span> </a> </li> <li class=md-nav__item> <a href=#implementing-your-own-logger class=md-nav__link> <span class=md-ellipsis> Implementing your own Logger </span> </a> </li> <li class=md-nav__item> <a href=#describing-tablesviews class=md-nav__link> <span class=md-ellipsis> Describing Tables/Views </span> </a> </li> <li class=md-nav__item> <a href=#creatingalteringdropping-tables class=md-nav__link> <span class=md-ellipsis> Creating/Altering/Dropping Tables </span> </a> <nav class=md-nav aria-label="Creating/Altering/Dropping Tables"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creating-tables class=md-nav__link> <span class=md-ellipsis> Creating Tables </span> </a> </li> <li class=md-nav__item> <a href=#altering-tables class=md-nav__link> <span class=md-ellipsis> Altering Tables </span> </a> </li> <li class=md-nav__item> <a href=#dropping-tables class=md-nav__link> <span class=md-ellipsis> Dropping Tables </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../db-phql/ class=md-nav__link> <span class=md-ellipsis> PHQL </span> </a> </li> <li class=md-nav__item> <a href=../db-odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class=md-nav__item> <a href=../db-models/ class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=../db-models-behaviors/ class=md-nav__link> <span class=md-ellipsis> Behaviors </span> </a> </li> <li class=md-nav__item> <a href=../db-models-cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../db-models-events/ class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=../db-models-metadata/ class=md-nav__link> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../db-models-relationships/ class=md-nav__link> <span class=md-ellipsis> Relationships </span> </a> </li> <li class=md-nav__item> <a href=../db-models-transactions/ class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=../db-models-validation/ class=md-nav__link> <span class=md-ellipsis> Validators </span> </a> </li> <li class=md-nav__item> <a href=../db-pagination/ class=md-nav__link> <span class=md-ellipsis> Pagination </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Front End </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Front End </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../assets/ class=md-nav__link> <span class=md-ellipsis> Assets </span> </a> </li> <li class=md-nav__item> <a href=../flash/ class=md-nav__link> <span class=md-ellipsis> Flash Messenger </span> </a> </li> <li class=md-nav__item> <a href=../forms/ class=md-nav__link> <span class=md-ellipsis> Forms </span> </a> </li> <li class=md-nav__item> <a href=../image/ class=md-nav__link> <span class=md-ellipsis> Image </span> </a> </li> <li class=md-nav__item> <a href=../tag/ class=md-nav__link> <span class=md-ellipsis> Tag </span> </a> </li> <li class=md-nav__item> <a href=../views/ class=md-nav__link> <span class=md-ellipsis> View </span> </a> </li> <li class=md-nav__item> <a href=../volt/ class=md-nav__link> <span class=md-ellipsis> Volt </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Business Logic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Business Logic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../acl/ class=md-nav__link> <span class=md-ellipsis> Access Control Lists </span> </a> </li> <li class=md-nav__item> <a href=../annotations/ class=md-nav__link> <span class=md-ellipsis> Annotations </span> </a> </li> <li class=md-nav__item> <a href=../controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../dispatcher/ class=md-nav__link> <span class=md-ellipsis> Dispatcher </span> </a> </li> <li class=md-nav__item> <a href=../events/ class=md-nav__link> <span class=md-ellipsis> Event Manager </span> </a> </li> <li class=md-nav__item> <a href=../filter/ class=md-nav__link> <span class=md-ellipsis> Filters </span> </a> </li> <li class=md-nav__item> <a href=../routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../session/ class=md-nav__link> <span class=md-ellipsis> Sessions </span> </a> </li> <li class=md-nav__item> <a href=../url/ class=md-nav__link> <span class=md-ellipsis> Url </span> </a> </li> <li class=md-nav__item> <a href=../validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../config/ class=md-nav__link> <span class=md-ellipsis> Config </span> </a> </li> <li class=md-nav__item> <a href=../escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../loader/ class=md-nav__link> <span class=md-ellipsis> Loader </span> </a> </li> <li class=md-nav__item> <a href=../logging/ class=md-nav__link> <span class=md-ellipsis> Logger </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_6> <label class=md-nav__link for=__nav_7_6 id=__nav_7_6_label tabindex=0> <span class=md-ellipsis> HTTP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_6> <span class="md-nav__icon md-icon"></span> HTTP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cookies/ class=md-nav__link> <span class=md-ellipsis> Cookies </span> </a> </li> <li class=md-nav__item> <a href=../request/ class=md-nav__link> <span class=md-ellipsis> Request </span> </a> </li> <li class=md-nav__item> <a href=../response/ class=md-nav__link> <span class=md-ellipsis> Response </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_7> <label class=md-nav__link for=__nav_7_7 id=__nav_7_7_label tabindex=0> <span class=md-ellipsis> i18n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_7> <span class="md-nav__icon md-icon"></span> i18n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../i18n/ class=md-nav__link> <span class=md-ellipsis> Internationalization </span> </a> </li> <li class=md-nav__item> <a href=../translate/ class=md-nav__link> <span class=md-ellipsis> Translate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../queue/ class=md-nav__link> <span class=md-ellipsis> Queue </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_9> <label class=md-nav__link for=__nav_7_9 id=__nav_7_9_label tabindex=0> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_9> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../crypt/ class=md-nav__link> <span class=md-ellipsis> Cryptography </span> </a> </li> <li class=md-nav__item> <a href=../security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#database-adapters class=md-nav__link> <span class=md-ellipsis> Database Adapters </span> </a> <nav class=md-nav aria-label="Database Adapters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#factory class=md-nav__link> <span class=md-ellipsis> Factory </span> </a> </li> <li class=md-nav__item> <a href=#implementing-your-own-adapters class=md-nav__link> <span class=md-ellipsis> Implementing your own adapters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-dialects class=md-nav__link> <span class=md-ellipsis> Database Dialects </span> </a> <nav class=md-nav aria-label="Database Dialects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementing-your-own-dialects class=md-nav__link> <span class=md-ellipsis> Implementing your own dialects </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#connecting-to-databases class=md-nav__link> <span class=md-ellipsis> Connecting to Databases </span> </a> <nav class=md-nav aria-label="Connecting to Databases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mysql-required-elements class=md-nav__link> <span class=md-ellipsis> MySQL Required elements </span> </a> </li> <li class=md-nav__item> <a href=#mysql-optional class=md-nav__link> <span class=md-ellipsis> MySQL Optional </span> </a> </li> <li class=md-nav__item> <a href=#mysql-create-a-connection class=md-nav__link> <span class=md-ellipsis> MySQL Create a connection </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-required-elements class=md-nav__link> <span class=md-ellipsis> PostgreSQL Required elements </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-optional class=md-nav__link> <span class=md-ellipsis> PostgreSQL Optional </span> </a> </li> <li class=md-nav__item> <a href=#postgresql-create-a-connection class=md-nav__link> <span class=md-ellipsis> PostgreSQL Create a connection </span> </a> </li> <li class=md-nav__item> <a href=#sqlite-required-elements class=md-nav__link> <span class=md-ellipsis> SQLite Required elements </span> </a> </li> <li class=md-nav__item> <a href=#sqlite-create-a-connection class=md-nav__link> <span class=md-ellipsis> SQLite Create a connection </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-additional-pdo-options class=md-nav__link> <span class=md-ellipsis> Setting up additional PDO options </span> </a> </li> <li class=md-nav__item> <a href=#connecting-using-factory class=md-nav__link> <span class=md-ellipsis> Connecting using Factory </span> </a> </li> <li class=md-nav__item> <a href=#finding-rows class=md-nav__link> <span class=md-ellipsis> Finding Rows </span> </a> </li> <li class=md-nav__item> <a href=#binding-parameters class=md-nav__link> <span class=md-ellipsis> Binding Parameters </span> </a> </li> <li class=md-nav__item> <a href=#typed-placeholders class=md-nav__link> <span class=md-ellipsis> Typed placeholders </span> </a> </li> <li class=md-nav__item> <a href=#cast-bound-parameters-values class=md-nav__link> <span class=md-ellipsis> Cast bound parameters values </span> </a> </li> <li class=md-nav__item> <a href=#cast-on-hydrate class=md-nav__link> <span class=md-ellipsis> Cast on Hydrate </span> </a> </li> <li class=md-nav__item> <a href=#insertingupdatingdeleting-rows class=md-nav__link> <span class=md-ellipsis> Inserting/Updating/Deleting Rows </span> </a> </li> <li class=md-nav__item> <a href=#transactions-and-nested-transactions class=md-nav__link> <span class=md-ellipsis> Transactions and Nested Transactions </span> </a> </li> <li class=md-nav__item> <a href=#database-events class=md-nav__link> <span class=md-ellipsis> Database Events </span> </a> </li> <li class=md-nav__item> <a href=#profiling-sql-statements class=md-nav__link> <span class=md-ellipsis> Profiling SQL Statements </span> </a> </li> <li class=md-nav__item> <a href=#logging-sql-statements class=md-nav__link> <span class=md-ellipsis> Logging SQL Statements </span> </a> </li> <li class=md-nav__item> <a href=#implementing-your-own-logger class=md-nav__link> <span class=md-ellipsis> Implementing your own Logger </span> </a> </li> <li class=md-nav__item> <a href=#describing-tablesviews class=md-nav__link> <span class=md-ellipsis> Describing Tables/Views </span> </a> </li> <li class=md-nav__item> <a href=#creatingalteringdropping-tables class=md-nav__link> <span class=md-ellipsis> Creating/Altering/Dropping Tables </span> </a> <nav class=md-nav aria-label="Creating/Altering/Dropping Tables"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creating-tables class=md-nav__link> <span class=md-ellipsis> Creating Tables </span> </a> </li> <li class=md-nav__item> <a href=#altering-tables class=md-nav__link> <span class=md-ellipsis> Altering Tables </span> </a> </li> <li class=md-nav__item> <a href=#dropping-tables class=md-nav__link> <span class=md-ellipsis> Dropping Tables </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/phalcon/documentation/edit/master/docs/db-layer.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/phalcon/documentation/raw/master/docs/db-layer.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=database-abstraction-layer>Database Abstraction Layer<a class=headerlink href=#database-abstraction-layer title="Permanent link">&para;</a></h1> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> is the component behind <a href=../api/Phalcon_Mvc_Model/ >Phalcon\Mvc\Model</a> that powers the model layer in the framework. It consists of an independent high-level abstraction layer for database systems completely written in C.</p> <p>This component allows for a lower level database manipulation than using traditional models.</p> <h2 id=database-adapters>Database Adapters<a class=headerlink href=#database-adapters title="Permanent link">&para;</a></h2> <p>This component makes use of adapters to encapsulate specific database system details. Phalcon uses PDO to connect to databases. The following database engines are supported:</p> <table> <thead> <tr> <th>Class</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Adapter\Pdo\Mysql</a></td> <td>Is the world's most used relational database management system (RDBMS) that runs as a server providing multi-user access to a number of databases</td> </tr> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Adapter\Pdo\Postgresql</a></td> <td>PostgreSQL is a powerful, open source relational database system. It has more than 15 years of active development and a proven architecture that has earned it a strong reputation for reliability, data integrity, and correctness.</td> </tr> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Adapter\Pdo\Sqlite</a></td> <td>SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine</td> </tr> </tbody> </table> <h3 id=factory>Factory<a class=headerlink href=#factory title="Permanent link">&para;</a></h3> <p>Loads PDO Adapter class using <code>adapter</code> option. For example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Factory</span><span class=p>;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=nv>$options</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;blog&#39;</span><span class=p>,</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=s1>&#39;port&#39;</span>     <span class=o>=&gt;</span> <span class=mi>3306</span><span class=p>,</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sigma&#39;</span><span class=p>,</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=s1>&#39;adapter&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;mysql&#39;</span><span class=p>,</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=p>];</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=nv>$db</span> <span class=o>=</span> <span class=nx>Factory</span><span class=o>::</span><span class=na>load</span><span class=p>(</span><span class=nv>$options</span><span class=p>);</span>
</code></pre></div> <h3 id=implementing-your-own-adapters>Implementing your own adapters<a class=headerlink href=#implementing-your-own-adapters title="Permanent link">&para;</a></h3> <p>The <a href=../api/Phalcon_Db/ >Phalcon\Db\AdapterInterface</a> interface must be implemented in order to create your own database adapters or extend the existing ones.</p> <h2 id=database-dialects>Database Dialects<a class=headerlink href=#database-dialects title="Permanent link">&para;</a></h2> <p>Phalcon encapsulates the specific details of each database engine in dialects. Those provide common functions and SQL generator to the adapters.</p> <table> <thead> <tr> <th>Class</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Dialect\Mysql</a></td> <td>SQL specific dialect for MySQL database system</td> </tr> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Dialect\Postgresql</a></td> <td>SQL specific dialect for PostgreSQL database system</td> </tr> <tr> <td><a href=../api/Phalcon_Db/ >Phalcon\Db\Dialect\Sqlite</a></td> <td>SQL specific dialect for SQLite database system</td> </tr> </tbody> </table> <h3 id=implementing-your-own-dialects>Implementing your own dialects<a class=headerlink href=#implementing-your-own-dialects title="Permanent link">&para;</a></h3> <p>The <a href=../api/Phalcon_Db/ >Phalcon\Db\DialectInterface</a> interface must be implemented in order to create your own database dialects or extend the existing ones. You can also enhance your current dialect by adding more commands/methods that PHQL will understand. </p> <p>For instance when using the MySQL adapter, you might want to allow PHQL to recognize the <code>MATCH ... AGAINST ...</code> syntax. We associate that syntax with <code>MATCH_AGAINST</code> </p> <p>We instantiate the dialect. We add the custom function so that PHQL understands what to do when it finds it during the parsing process. In the example below, we register a new custom function called <code>MATCH_AGAINST</code>. After that all we have to do is add the customized dialect object to our connection.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>use</span> <span class=nx>Phalcon\Db\Dialect\MySQL</span> <span class=k>as</span> <span class=nx>SqlDialect</span><span class=p>;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\MySQL</span> <span class=k>as</span> <span class=nx>Connection</span><span class=p>;</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nv>$dialect</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SqlDialect</span><span class=p>();</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nv>$dialect</span><span class=o>-&gt;</span><span class=na>registerCustomFunction</span><span class=p>(</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=s1>&#39;MATCH_AGAINST&#39;</span><span class=p>,</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=k>function</span><span class=p>(</span><span class=nv>$dialect</span><span class=p>,</span> <span class=nv>$expression</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>        <span class=nv>$arguments</span> <span class=o>=</span> <span class=nv>$expression</span><span class=p>[</span><span class=s1>&#39;arguments&#39;</span><span class=p>];</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>        <span class=k>return</span> <span class=nb>sprintf</span><span class=p>(</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>            <span class=s2>&quot; MATCH (%s) AGAINST (%)&quot;</span><span class=p>,</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>            <span class=nv>$dialect</span><span class=o>-&gt;</span><span class=na>getSqlExpression</span><span class=p>(</span><span class=nv>$arguments</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>            <span class=nv>$dialect</span><span class=o>-&gt;</span><span class=na>getSqlExpression</span><span class=p>(</span><span class=nv>$arguments</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>         <span class=p>);</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=p>}</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=p>);</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Connection</span><span class=p>(</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>    <span class=p>[</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>        <span class=s2>&quot;host&quot;</span>          <span class=o>=&gt;</span> <span class=s2>&quot;localhost&quot;</span><span class=p>,</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>        <span class=s2>&quot;username&quot;</span>      <span class=o>=&gt;</span> <span class=s2>&quot;root&quot;</span><span class=p>,</span>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>        <span class=s2>&quot;password&quot;</span>      <span class=o>=&gt;</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>        <span class=s2>&quot;dbname&quot;</span>        <span class=o>=&gt;</span> <span class=s2>&quot;test&quot;</span><span class=p>,</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>        <span class=s2>&quot;dialectClass&quot;</span>  <span class=o>=&gt;</span> <span class=nv>$dialect</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>    <span class=p>]</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=p>);</span>
</code></pre></div> <p>We can now use this new function in PHQL, which in turn will translate it to the proper SQL syntax:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=s2>  SELECT *</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=s2>  FROM   Posts</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=s2>  WHERE  MATCH_AGAINST(title, :pattern:)&quot;</span><span class=p>;</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=nv>$posts</span> <span class=o>=</span> <span class=nv>$modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span><span class=nv>$phql</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;pattern&#39;</span> <span class=o>=&gt;</span> <span class=nv>$pattern</span><span class=p>]);</span>
</code></pre></div> <h2 id=connecting-to-databases>Connecting to Databases<a class=headerlink href=#connecting-to-databases title="Permanent link">&para;</a></h2> <p>To create a connection it's necessary instantiate the adapter class. It only requires an array with the connection parameters. The example below shows how to create a connection passing both required and optional parameters:</p> <h5 id=mysql-required-elements>MySQL Required elements<a class=headerlink href=#mysql-required-elements title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=nv>$config</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;mike&#39;</span><span class=p>,</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>    <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sigma&#39;</span><span class=p>,</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;test_db&#39;</span><span class=p>,</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>];</span>
</code></pre></div> <h5 id=mysql-optional>MySQL Optional<a class=headerlink href=#mysql-optional title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nv>$config</span><span class=p>[</span><span class=s1>&#39;persistent&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=k>false</span><span class=p>;</span>
</code></pre></div> <h5 id=mysql-create-a-connection>MySQL Create a connection<a class=headerlink href=#mysql-create-a-connection title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\Phalcon\Db\Adapter\Pdo\Mysql</span><span class=p>(</span><span class=nv>$config</span><span class=p>);</span>
</code></pre></div> <h5 id=postgresql-required-elements>PostgreSQL Required elements<a class=headerlink href=#postgresql-required-elements title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=nv>$config</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;postgres&#39;</span><span class=p>,</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret1&#39;</span><span class=p>,</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;template&#39;</span><span class=p>,</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=p>];</span>
</code></pre></div> <h5 id=postgresql-optional>PostgreSQL Optional<a class=headerlink href=#postgresql-optional title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nv>$config</span><span class=p>[</span><span class=s1>&#39;schema&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;public&#39;</span><span class=p>;</span>
</code></pre></div> <h5 id=postgresql-create-a-connection>PostgreSQL Create a connection<a class=headerlink href=#postgresql-create-a-connection title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\Phalcon\Db\Adapter\Pdo\Postgresql</span><span class=p>(</span><span class=nv>$config</span><span class=p>);</span>
</code></pre></div> <h5 id=sqlite-required-elements>SQLite Required elements<a class=headerlink href=#sqlite-required-elements title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=nv>$config</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=s1>&#39;dbname&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;/path/to/database.db&#39;</span><span class=p>,</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=p>];</span>
</code></pre></div> <h5 id=sqlite-create-a-connection>SQLite Create a connection<a class=headerlink href=#sqlite-create-a-connection title="Permanent link">&para;</a></h5> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\Phalcon\Db\Adapter\Pdo\Sqlite</span><span class=p>(</span><span class=nv>$config</span><span class=p>);</span>
</code></pre></div> <h2 id=setting-up-additional-pdo-options>Setting up additional PDO options<a class=headerlink href=#setting-up-additional-pdo-options title="Permanent link">&para;</a></h2> <p>You can set PDO options at connection time by passing the parameters <code>options</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>\Phalcon\Db\Adapter\Pdo\Mysql</span><span class=p>(</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=p>[</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>        <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>        <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;sigma&#39;</span><span class=p>,</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>        <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;test_db&#39;</span><span class=p>,</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>        <span class=s1>&#39;options&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>            <span class=nx>PDO</span><span class=o>::</span><span class=na>MYSQL_ATTR_INIT_COMMAND</span> <span class=o>=&gt;</span> <span class=s2>&quot;SET NAMES &#39;UTF8&#39;&quot;</span><span class=p>,</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>            <span class=nx>PDO</span><span class=o>::</span><span class=na>ATTR_CASE</span>               <span class=o>=&gt;</span> <span class=nx>PDO</span><span class=o>::</span><span class=na>CASE_LOWER</span><span class=p>,</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>        <span class=p>]</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>    <span class=p>]</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=p>);</span>
</code></pre></div> <h2 id=connecting-using-factory>Connecting using Factory<a class=headerlink href=#connecting-using-factory title="Permanent link">&para;</a></h2> <p>You can also use a simple <code>ini</code> file to configure/connect your <code>db</code> service to your database. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>[database]</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=na>host</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_HOST</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_USER</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=na>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_PASSWD</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=na>dbname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_NAME</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=na>port</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_PORT</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=na>charset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>TEST_DB_MYSQL_CHARSET</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=na>adapter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>mysql</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=k>use</span> <span class=nx>Phalcon\Config\Adapter\Ini</span><span class=p>;</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=k>use</span> <span class=nx>Phalcon\Di</span><span class=p>;</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Factory</span><span class=p>;</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=nv>$di</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Di</span><span class=p>();</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=nv>$config</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Ini</span><span class=p>(</span><span class=s1>&#39;config.ini&#39;</span><span class=p>);</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;config&#39;</span><span class=p>,</span> <span class=nv>$config</span><span class=p>);</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>    <span class=s1>&#39;db&#39;</span><span class=p>,</span> 
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>        <span class=k>return</span> <span class=nx>Factory</span><span class=o>::</span><span class=na>load</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>config</span><span class=o>-&gt;</span><span class=na>database</span><span class=p>);</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>    <span class=p>}</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=p>);</span>
</code></pre></div> <p>The above will return the correct database instance and also has the advantage that you can change the connection credentials or even the database adapter without changing a single line of code in your application.</p> <h2 id=finding-rows>Finding Rows<a class=headerlink href=#finding-rows title="Permanent link">&para;</a></h2> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> provides several methods to query rows from tables. The specific SQL syntax of the target database engine is required in this case:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=nv>$sql</span> <span class=o>=</span> <span class=s1>&#39;SELECT id, name FROM robots ORDER BY name&#39;</span><span class=p>;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=c1>// Send a SQL statement to the database system</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=c1>// Print each robot name</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=k>while</span> <span class=p>(</span><span class=nv>$robot</span> <span class=o>=</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>fetch</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>   <span class=k>echo</span> <span class=nv>$robot</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>];</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=p>}</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=c1>// Get all rows in an array</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>fetchAll</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$robots</span> <span class=k>as</span> <span class=nv>$robot</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>   <span class=k>echo</span> <span class=nv>$robot</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>];</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=p>}</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=c1>// Get only the first row</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=nv>$robot</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>fetchOne</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
</code></pre></div> <p>By default these calls create arrays with both associative and numeric indexes. You can change this behavior by using <code>Phalcon\Db\Result::setFetchMode()</code>. This method receives a constant, defining which kind of index is required.</p> <table> <thead> <tr> <th>Constant</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Phalcon\Db::FETCH_NUM</code></td> <td>Return an array with numeric indexes</td> </tr> <tr> <td><code>Phalcon\Db::FETCH_ASSOC</code></td> <td>Return an array with associative indexes</td> </tr> <tr> <td><code>Phalcon\Db::FETCH_BOTH</code></td> <td>Return an array with both associative and numeric indexes</td> </tr> <tr> <td><code>Phalcon\Db::FETCH_OBJ</code></td> <td>Return an object instead of an array</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=nv>$sql</span> <span class=o>=</span> <span class=s1>&#39;SELECT id, name FROM robots ORDER BY name&#39;</span><span class=p>;</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=nv>$result</span><span class=o>-&gt;</span><span class=na>setFetchMode</span><span class=p>(</span><span class=nx>Phalcon\Db</span><span class=o>::</span><span class=na>FETCH_NUM</span><span class=p>);</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=k>while</span> <span class=p>(</span><span class=nv>$robot</span> <span class=o>=</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>fetch</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>   <span class=k>echo</span> <span class=nv>$robot</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=p>}</span>
</code></pre></div> <p>The <code>Phalcon\Db::query()</code> returns an instance of <a href=../api/Phalcon_Db/ >Phalcon\Db\Result\Pdo</a>. These objects encapsulate all the functionality related to the returned resultset i.e. traversing, seeking specific records, count etc.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nv>$sql</span> <span class=o>=</span> <span class=s1>&#39;SELECT id, name FROM robots&#39;</span><span class=p>;</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=c1>// Traverse the resultset</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=k>while</span> <span class=p>(</span><span class=nv>$robot</span> <span class=o>=</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>fetch</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>   <span class=k>echo</span> <span class=nv>$robot</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>];</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=p>}</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=c1>// Seek to the third row</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=nv>$result</span><span class=o>-&gt;</span><span class=na>seek</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=nv>$robot</span> <span class=o>=</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>fetch</span><span class=p>();</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=c1>// Count the resultset</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=k>echo</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>numRows</span><span class=p>();</span>
</code></pre></div> <h2 id=binding-parameters>Binding Parameters<a class=headerlink href=#binding-parameters title="Permanent link">&para;</a></h2> <p>Bound parameters is also supported in <a href=../api/Phalcon_Db/ >Phalcon\Db</a>. Although there is a minimal performance impact by using bound parameters, you are encouraged to use this methodology so as to eliminate the possibility of your code being subject to SQL injection attacks. Both string and positional placeholders are supported. Binding parameters can simply be achieved as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=c1>// Binding with numeric placeholders</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=nv>$sql</span>    <span class=o>=</span> <span class=s1>&#39;SELECT * FROM robots WHERE name = ? ORDER BY name&#39;</span><span class=p>;</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=nv>$sql</span><span class=p>,</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=p>[</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>        <span class=s1>&#39;Wall-E&#39;</span><span class=p>,</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>    <span class=p>]</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=p>);</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=c1>// Binding with named placeholders</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;INSERT INTO `robots`(name`, year) VALUES (:name, :year)&#39;</span><span class=p>;</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>    <span class=nv>$sql</span><span class=p>,</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>    <span class=p>[</span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>        <span class=s1>&#39;year&#39;</span> <span class=o>=&gt;</span> <span class=mi>1952</span><span class=p>,</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>    <span class=p>]</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=p>);</span>
</code></pre></div> <p>When using numeric placeholders, you will need to define them as integers i.e. 1 or 2. In this case '1' or '2' are considered strings and not numbers, so the placeholder could not be successfully replaced. With any adapter data are automatically escaped using <a href=https://www.php.net/manual/en/pdo.quote.php>PDO Quote</a>.</p> <p>This function takes into account the connection charset, so its recommended to define the correct charset in the connection parameters or in your database server configuration, as a wrong charset will produce undesired effects when storing or retrieving data.</p> <p>Also, you can pass your parameters directly to the <code>execute</code> or <code>query</code> methods. In this case bound parameters are directly passed to PDO:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=c1>// Binding with PDO placeholders</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=nv>$sql</span>    <span class=o>=</span> <span class=s1>&#39;SELECT * FROM robots WHERE name = ? ORDER BY name&#39;</span><span class=p>;</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=nv>$sql</span><span class=p>,</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>    <span class=p>[</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>        <span class=mi>1</span> <span class=o>=&gt;</span> <span class=s1>&#39;Wall-E&#39;</span><span class=p>,</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>    <span class=p>]</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=p>);</span>
</code></pre></div> <h2 id=typed-placeholders>Typed placeholders<a class=headerlink href=#typed-placeholders title="Permanent link">&para;</a></h2> <p>Placeholders allowed you to bind parameters to avoid SQL injections:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots WHERE id &gt; :id:&quot;</span><span class=p>;</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span><span class=nv>$phql</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;id&#39;</span> <span class=o>=&gt;</span> <span class=mi>100</span><span class=p>]);</span>
</code></pre></div> <p>However, some database systems require additional actions when using placeholders such as specifying the type of the bound parameter:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>use</span> <span class=nx>Phalcon\Db\Column</span><span class=p>;</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=c1>// ...</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots LIMIT :number:&quot;</span><span class=p>;</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a>    <span class=nv>$phql</span><span class=p>,</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>    <span class=p>[</span><span class=s1>&#39;number&#39;</span> <span class=o>=&gt;</span> <span class=mi>10</span><span class=p>],</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>    <span class=nx>Column</span><span class=o>::</span><span class=na>BIND_PARAM_INT</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=p>);</span>
</code></pre></div> <p>You can use typed placeholders in your parameters, instead of specifying the bind type in <code>executeQuery()</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots LIMIT {number:int}&quot;</span><span class=p>;</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=nv>$phql</span><span class=p>,</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=p>[</span><span class=s1>&#39;number&#39;</span> <span class=o>=&gt;</span> <span class=mi>10</span><span class=p>]</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=p>);</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots WHERE name &lt;&gt; {name:str}&quot;</span><span class=p>;</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>    <span class=nv>$phql</span><span class=p>,</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>    <span class=p>[</span><span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$name</span><span class=p>]</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=p>);</span>
</code></pre></div> <p>You can also omit the type if you don't need to specify it:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots WHERE name &lt;&gt; {name}&quot;</span><span class=p>;</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=nv>$phql</span><span class=p>,</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=p>[</span><span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$name</span><span class=p>]</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=p>);</span>
</code></pre></div> <p>Typed placeholders are also more powerful, since we can now bind a static array without having to pass each element independently as a placeholder:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=nv>$phql</span> <span class=o>=</span> <span class=s2>&quot;SELECT * FROM Store</span><span class=se>\R</span><span class=s2>obots WHERE id IN ({ids:array})&quot;</span><span class=p>;</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>    <span class=nv>$phql</span><span class=p>,</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>    <span class=p>[</span><span class=s1>&#39;ids&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]]</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=p>);</span>
</code></pre></div> <p>The following types are available:</p> <table> <thead> <tr> <th>Bind Type</th> <th>Bind Type Constant</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td>str</td> <td><code>Column::BIND_PARAM_STR</code></td> <td><code>{name:str}</code></td> </tr> <tr> <td>int</td> <td><code>Column::BIND_PARAM_INT</code></td> <td><code>{number:int}</code></td> </tr> <tr> <td>double</td> <td><code>Column::BIND_PARAM_DECIMAL</code></td> <td><code>{price:double}</code></td> </tr> <tr> <td>bool</td> <td><code>Column::BIND_PARAM_BOOL</code></td> <td><code>{enabled:bool}</code></td> </tr> <tr> <td>blob</td> <td><code>Column::BIND_PARAM_BLOB</code></td> <td><code>{image:blob}</code></td> </tr> <tr> <td>null</td> <td><code>Column::BIND_PARAM_NULL</code></td> <td><code>{exists:null}</code></td> </tr> <tr> <td>array</td> <td>Array of <code>Column::BIND_PARAM_STR</code></td> <td><code>{codes:array}</code></td> </tr> <tr> <td>array-str</td> <td>Array of <code>Column::BIND_PARAM_STR</code></td> <td><code>{names:array-str}</code></td> </tr> <tr> <td>array-int</td> <td>Array of <code>Column::BIND_PARAM_INT</code></td> <td><code>{flags:array-int}</code></td> </tr> </tbody> </table> <h2 id=cast-bound-parameters-values>Cast bound parameters values<a class=headerlink href=#cast-bound-parameters-values title="Permanent link">&para;</a></h2> <p>By default, bound parameters aren't casted in the PHP userland to the specified bind types, this option allows you to make Phalcon cast values before bind them with PDO. A classic situation when this problem raises is passing a string in a <code>LIMIT</code>/<code>OFFSET</code> placeholder:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=nv>$number</span> <span class=o>=</span> <span class=s1>&#39;100&#39;</span><span class=p>;</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>    <span class=s1>&#39;SELECT * FROM Some\Robots LIMIT {number:int}&#39;</span><span class=p>,</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>    <span class=p>[</span><span class=s1>&#39;number&#39;</span> <span class=o>=&gt;</span> <span class=nv>$number</span><span class=p>]</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=p>);</span>
</code></pre></div> <p>This causes the following exception:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>Fatal error: Uncaught exception &#39;PDOException&#39; with message &#39;SQLSTATE[42000]:
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>Syntax error or access violation: 1064 You have an error in your SQL syntax;
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>check the manual that corresponds to your MySQL server version for the right
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>syntax to use near &#39;&#39;100&#39;&#39; at line 1&#39; in /Users/scott/demo.php:78
</code></pre></div> <p>This happens because 100 is a string variable. It is easily fixable by casting the value to integer first:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nv>$number</span> <span class=o>=</span> <span class=s1>&#39;100&#39;</span><span class=p>;</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=nv>$robots</span> <span class=o>=</span> <span class=nv>$modelsManager</span><span class=o>-&gt;</span><span class=na>executeQuery</span><span class=p>(</span>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>    <span class=s1>&#39;SELECT * FROM Some\Robots LIMIT {number:int}&#39;</span><span class=p>,</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>    <span class=p>[</span><span class=s1>&#39;number&#39;</span> <span class=o>=&gt;</span> <span class=p>(</span><span class=nx>int</span><span class=p>)</span> <span class=nv>$number</span><span class=p>]</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=p>);</span>
</code></pre></div> <p>However this solution requires that the developer pays special attention about how bound parameters are passed and their types. To make this task easier and avoid unexpected exceptions you can instruct Phalcon to do this casting for you:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=nx>\Phalcon\Db</span><span class=o>::</span><span class=na>setup</span><span class=p>([</span><span class=s1>&#39;forceCasting&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>]);</span>
</code></pre></div> <p>The following actions are performed according to the bind type specified:</p> <table> <thead> <tr> <th>Bind Type</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td>Column::BIND_PARAM_STR</td> <td>Cast the value as a native PHP string</td> </tr> <tr> <td>Column::BIND_PARAM_INT</td> <td>Cast the value as a native PHP integer</td> </tr> <tr> <td>Column::BIND_PARAM_BOOL</td> <td>Cast the value as a native PHP boolean</td> </tr> <tr> <td>Column::BIND_PARAM_DECIMAL</td> <td>Cast the value as a native PHP double</td> </tr> </tbody> </table> <h2 id=cast-on-hydrate>Cast on Hydrate<a class=headerlink href=#cast-on-hydrate title="Permanent link">&para;</a></h2> <p>Values returned from the database system are always represented as string values by PDO, no matter if the value belongs to a numerical or boolean type column. This happens because some column types cannot be represented with its corresponding PHP native types due to their size limitations. For instance, a <code>BIGINT</code> in MySQL can store large integer numbers that cannot be represented as a 32bit integer in PHP. Because of that, PDO and the ORM by default, make the safe decision of leaving all values as strings.</p> <p>You can set up the ORM to automatically cast those types considered safe to their corresponding PHP native types:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=nx>\Phalcon\Mvc\Model</span><span class=o>::</span><span class=na>setup</span><span class=p>([</span><span class=s1>&#39;castOnHydrate&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>]);</span>
</code></pre></div> <p>This way you can use strict operators or make assumptions about the type of variables:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=nv>$robot</span> <span class=o>=</span> <span class=nx>Robots</span><span class=o>::</span><span class=na>findFirst</span><span class=p>();</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=k>if</span> <span class=p>(</span><span class=mi>11</span> <span class=o>===</span> <span class=nv>$robot</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>    <span class=k>echo</span> <span class=nv>$robot</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>;</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=p>}</span>
</code></pre></div> <h2 id=insertingupdatingdeleting-rows>Inserting/Updating/Deleting Rows<a class=headerlink href=#insertingupdatingdeleting-rows title="Permanent link">&para;</a></h2> <p>To insert, update or delete rows, you can use raw SQL or use the preset functions provided by the class:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=c1>// Inserting data with a raw SQL statement</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;INSERT INTO `robots`(`name`, `year`) VALUES (&#39;</span><span class=nx>Astro</span> <span class=nx>Boy</span><span class=s1>&#39;, 1952)&#39;</span><span class=p>;</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=c1>// With placeholders</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;INSERT INTO `robots`(`name`, `year`) VALUES (?, ?)&#39;</span><span class=p>;</span>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>    <span class=nv>$sql</span><span class=p>,</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=p>[</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>        <span class=s1>&#39;Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>        <span class=mi>1952</span><span class=p>,</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>    <span class=p>]</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=p>);</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=c1>// Generating dynamically the necessary SQL</span>
<a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>insert</span><span class=p>(</span>
<a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a>    <span class=p>[</span>
<a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a>        <span class=s1>&#39;Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a>        <span class=mi>1952</span><span class=p>,</span>
<a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a>    <span class=p>],</span>
<a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a>    <span class=p>[</span>
<a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a>        <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a>        <span class=s1>&#39;year&#39;</span><span class=p>,</span>
<a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a>    <span class=p>],</span>
<a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a><span class=p>);</span>
<a id=__codelineno-30-29 name=__codelineno-30-29 href=#__codelineno-30-29></a>
<a id=__codelineno-30-30 name=__codelineno-30-30 href=#__codelineno-30-30></a><span class=c1>// Generating dynamically the necessary SQL (another syntax)</span>
<a id=__codelineno-30-31 name=__codelineno-30-31 href=#__codelineno-30-31></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>insertAsDict</span><span class=p>(</span>
<a id=__codelineno-30-32 name=__codelineno-30-32 href=#__codelineno-30-32></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-33 name=__codelineno-30-33 href=#__codelineno-30-33></a>    <span class=p>[</span>
<a id=__codelineno-30-34 name=__codelineno-30-34 href=#__codelineno-30-34></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-35 name=__codelineno-30-35 href=#__codelineno-30-35></a>        <span class=s1>&#39;year&#39;</span> <span class=o>=&gt;</span> <span class=mi>1952</span><span class=p>,</span>
<a id=__codelineno-30-36 name=__codelineno-30-36 href=#__codelineno-30-36></a>    <span class=p>]</span>
<a id=__codelineno-30-37 name=__codelineno-30-37 href=#__codelineno-30-37></a><span class=p>);</span>
<a id=__codelineno-30-38 name=__codelineno-30-38 href=#__codelineno-30-38></a>
<a id=__codelineno-30-39 name=__codelineno-30-39 href=#__codelineno-30-39></a><span class=c1>// Updating data with a raw SQL statement</span>
<a id=__codelineno-30-40 name=__codelineno-30-40 href=#__codelineno-30-40></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;UPDATE `robots` SET `name` = &#39;</span><span class=nx>Astro</span> <span class=nx>boy</span><span class=s1>&#39; WHERE `id` = 101&#39;</span><span class=p>;</span>
<a id=__codelineno-30-41 name=__codelineno-30-41 href=#__codelineno-30-41></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-30-42 name=__codelineno-30-42 href=#__codelineno-30-42></a>
<a id=__codelineno-30-43 name=__codelineno-30-43 href=#__codelineno-30-43></a><span class=c1>// With placeholders</span>
<a id=__codelineno-30-44 name=__codelineno-30-44 href=#__codelineno-30-44></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;UPDATE `robots` SET `name` = ? WHERE `id` = ?&#39;</span><span class=p>;</span>
<a id=__codelineno-30-45 name=__codelineno-30-45 href=#__codelineno-30-45></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span>
<a id=__codelineno-30-46 name=__codelineno-30-46 href=#__codelineno-30-46></a>    <span class=nv>$sql</span><span class=p>,</span>
<a id=__codelineno-30-47 name=__codelineno-30-47 href=#__codelineno-30-47></a>    <span class=p>[</span>
<a id=__codelineno-30-48 name=__codelineno-30-48 href=#__codelineno-30-48></a>        <span class=s1>&#39;Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-49 name=__codelineno-30-49 href=#__codelineno-30-49></a>        <span class=mi>101</span><span class=p>,</span>
<a id=__codelineno-30-50 name=__codelineno-30-50 href=#__codelineno-30-50></a>    <span class=p>]</span>
<a id=__codelineno-30-51 name=__codelineno-30-51 href=#__codelineno-30-51></a><span class=p>);</span>
<a id=__codelineno-30-52 name=__codelineno-30-52 href=#__codelineno-30-52></a>
<a id=__codelineno-30-53 name=__codelineno-30-53 href=#__codelineno-30-53></a><span class=c1>// Generating dynamically the necessary SQL</span>
<a id=__codelineno-30-54 name=__codelineno-30-54 href=#__codelineno-30-54></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>(</span>
<a id=__codelineno-30-55 name=__codelineno-30-55 href=#__codelineno-30-55></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-56 name=__codelineno-30-56 href=#__codelineno-30-56></a>    <span class=p>[</span>
<a id=__codelineno-30-57 name=__codelineno-30-57 href=#__codelineno-30-57></a>        <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-30-58 name=__codelineno-30-58 href=#__codelineno-30-58></a>    <span class=p>],</span>
<a id=__codelineno-30-59 name=__codelineno-30-59 href=#__codelineno-30-59></a>    <span class=p>[</span>
<a id=__codelineno-30-60 name=__codelineno-30-60 href=#__codelineno-30-60></a>        <span class=s1>&#39;New Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-61 name=__codelineno-30-61 href=#__codelineno-30-61></a>    <span class=p>],</span>
<a id=__codelineno-30-62 name=__codelineno-30-62 href=#__codelineno-30-62></a>    <span class=s1>&#39;id = 101&#39;</span> <span class=c1>// Warning! In this case values are not escaped</span>
<a id=__codelineno-30-63 name=__codelineno-30-63 href=#__codelineno-30-63></a><span class=p>);</span>
<a id=__codelineno-30-64 name=__codelineno-30-64 href=#__codelineno-30-64></a>
<a id=__codelineno-30-65 name=__codelineno-30-65 href=#__codelineno-30-65></a><span class=c1>// Generating dynamically the necessary SQL (another syntax)</span>
<a id=__codelineno-30-66 name=__codelineno-30-66 href=#__codelineno-30-66></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>updateAsDict</span><span class=p>(</span>
<a id=__codelineno-30-67 name=__codelineno-30-67 href=#__codelineno-30-67></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-68 name=__codelineno-30-68 href=#__codelineno-30-68></a>    <span class=p>[</span>
<a id=__codelineno-30-69 name=__codelineno-30-69 href=#__codelineno-30-69></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;New Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-70 name=__codelineno-30-70 href=#__codelineno-30-70></a>    <span class=p>],</span>
<a id=__codelineno-30-71 name=__codelineno-30-71 href=#__codelineno-30-71></a>    <span class=s1>&#39;id = 101&#39;</span> <span class=c1>// Warning! In this case values are not escaped</span>
<a id=__codelineno-30-72 name=__codelineno-30-72 href=#__codelineno-30-72></a><span class=p>);</span>
<a id=__codelineno-30-73 name=__codelineno-30-73 href=#__codelineno-30-73></a>
<a id=__codelineno-30-74 name=__codelineno-30-74 href=#__codelineno-30-74></a><span class=c1>// With escaping conditions</span>
<a id=__codelineno-30-75 name=__codelineno-30-75 href=#__codelineno-30-75></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>(</span>
<a id=__codelineno-30-76 name=__codelineno-30-76 href=#__codelineno-30-76></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-77 name=__codelineno-30-77 href=#__codelineno-30-77></a>    <span class=p>[</span>
<a id=__codelineno-30-78 name=__codelineno-30-78 href=#__codelineno-30-78></a>        <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-30-79 name=__codelineno-30-79 href=#__codelineno-30-79></a>    <span class=p>],</span>
<a id=__codelineno-30-80 name=__codelineno-30-80 href=#__codelineno-30-80></a>    <span class=p>[</span>
<a id=__codelineno-30-81 name=__codelineno-30-81 href=#__codelineno-30-81></a>        <span class=s1>&#39;New Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-82 name=__codelineno-30-82 href=#__codelineno-30-82></a>    <span class=p>],</span>
<a id=__codelineno-30-83 name=__codelineno-30-83 href=#__codelineno-30-83></a>    <span class=p>[</span>
<a id=__codelineno-30-84 name=__codelineno-30-84 href=#__codelineno-30-84></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;id = ?&#39;</span><span class=p>,</span>
<a id=__codelineno-30-85 name=__codelineno-30-85 href=#__codelineno-30-85></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span><span class=mi>101</span><span class=p>],</span>
<a id=__codelineno-30-86 name=__codelineno-30-86 href=#__codelineno-30-86></a>        <span class=s1>&#39;bindTypes&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>PDO</span><span class=o>::</span><span class=na>PARAM_INT</span><span class=p>],</span> <span class=c1>// Optional parameter</span>
<a id=__codelineno-30-87 name=__codelineno-30-87 href=#__codelineno-30-87></a>    <span class=p>]</span>
<a id=__codelineno-30-88 name=__codelineno-30-88 href=#__codelineno-30-88></a><span class=p>);</span>
<a id=__codelineno-30-89 name=__codelineno-30-89 href=#__codelineno-30-89></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>updateAsDict</span><span class=p>(</span>
<a id=__codelineno-30-90 name=__codelineno-30-90 href=#__codelineno-30-90></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-91 name=__codelineno-30-91 href=#__codelineno-30-91></a>    <span class=p>[</span>
<a id=__codelineno-30-92 name=__codelineno-30-92 href=#__codelineno-30-92></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;New Astro Boy&#39;</span><span class=p>,</span>
<a id=__codelineno-30-93 name=__codelineno-30-93 href=#__codelineno-30-93></a>    <span class=p>],</span>
<a id=__codelineno-30-94 name=__codelineno-30-94 href=#__codelineno-30-94></a>    <span class=p>[</span>
<a id=__codelineno-30-95 name=__codelineno-30-95 href=#__codelineno-30-95></a>        <span class=s1>&#39;conditions&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;id = ?&#39;</span><span class=p>,</span>
<a id=__codelineno-30-96 name=__codelineno-30-96 href=#__codelineno-30-96></a>        <span class=s1>&#39;bind&#39;</span>       <span class=o>=&gt;</span> <span class=p>[</span><span class=mi>101</span><span class=p>],</span>
<a id=__codelineno-30-97 name=__codelineno-30-97 href=#__codelineno-30-97></a>        <span class=s1>&#39;bindTypes&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span><span class=nx>PDO</span><span class=o>::</span><span class=na>PARAM_INT</span><span class=p>],</span> <span class=c1>// Optional parameter</span>
<a id=__codelineno-30-98 name=__codelineno-30-98 href=#__codelineno-30-98></a>    <span class=p>]</span>
<a id=__codelineno-30-99 name=__codelineno-30-99 href=#__codelineno-30-99></a><span class=p>);</span>
<a id=__codelineno-30-100 name=__codelineno-30-100 href=#__codelineno-30-100></a>
<a id=__codelineno-30-101 name=__codelineno-30-101 href=#__codelineno-30-101></a><span class=c1>// Deleting data with a raw SQL statement</span>
<a id=__codelineno-30-102 name=__codelineno-30-102 href=#__codelineno-30-102></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;DELETE `robots` WHERE `id` = 101&#39;</span><span class=p>;</span>
<a id=__codelineno-30-103 name=__codelineno-30-103 href=#__codelineno-30-103></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-30-104 name=__codelineno-30-104 href=#__codelineno-30-104></a>
<a id=__codelineno-30-105 name=__codelineno-30-105 href=#__codelineno-30-105></a><span class=c1>// With placeholders</span>
<a id=__codelineno-30-106 name=__codelineno-30-106 href=#__codelineno-30-106></a><span class=nv>$sql</span>     <span class=o>=</span> <span class=s1>&#39;DELETE `robots` WHERE `id` = ?&#39;</span><span class=p>;</span>
<a id=__codelineno-30-107 name=__codelineno-30-107 href=#__codelineno-30-107></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=nv>$sql</span><span class=p>,</span> <span class=p>[</span><span class=mi>101</span><span class=p>]);</span>
<a id=__codelineno-30-108 name=__codelineno-30-108 href=#__codelineno-30-108></a>
<a id=__codelineno-30-109 name=__codelineno-30-109 href=#__codelineno-30-109></a><span class=c1>// Generating dynamically the necessary SQL</span>
<a id=__codelineno-30-110 name=__codelineno-30-110 href=#__codelineno-30-110></a><span class=nv>$success</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>delete</span><span class=p>(</span>
<a id=__codelineno-30-111 name=__codelineno-30-111 href=#__codelineno-30-111></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-30-112 name=__codelineno-30-112 href=#__codelineno-30-112></a>    <span class=s1>&#39;id = ?&#39;</span><span class=p>,</span>
<a id=__codelineno-30-113 name=__codelineno-30-113 href=#__codelineno-30-113></a>    <span class=p>[</span>
<a id=__codelineno-30-114 name=__codelineno-30-114 href=#__codelineno-30-114></a>        <span class=mi>101</span><span class=p>,</span>
<a id=__codelineno-30-115 name=__codelineno-30-115 href=#__codelineno-30-115></a>    <span class=p>]</span>
<a id=__codelineno-30-116 name=__codelineno-30-116 href=#__codelineno-30-116></a><span class=p>);</span>
</code></pre></div> <h2 id=transactions-and-nested-transactions>Transactions and Nested Transactions<a class=headerlink href=#transactions-and-nested-transactions title="Permanent link">&para;</a></h2> <p>Working with transactions is supported as it is with PDO. Perform data manipulation inside transactions often increase the performance on most database systems:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>    <span class=c1>// Start a transaction</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>begin</span><span class=p>();</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a>    <span class=c1>// Execute some SQL statements</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 101&#39;</span><span class=p>);</span>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 102&#39;</span><span class=p>);</span>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 103&#39;</span><span class=p>);</span>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a>    <span class=c1>// Commit if everything goes well</span>
<a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a>    <span class=c1>// An exception has occurred rollback the transaction</span>
<a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>();</span>
<a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a><span class=p>}</span>
</code></pre></div> <p>In addition to standard transactions, <a href=../api/Phalcon_Db/ >Phalcon\Db</a> provides built-in support for <a href=https://en.wikipedia.org/wiki/Nested_transaction>nested transactions</a> (if the database system used supports them). When you call begin() for a second time a nested transaction is created:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>    <span class=c1>// Start a transaction</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>begin</span><span class=p>();</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>    <span class=c1>// Execute some SQL statements</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 101&#39;</span><span class=p>);</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=k>try</span> <span class=p>{</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>        <span class=c1>// Start a nested transaction</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>begin</span><span class=p>();</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>        <span class=c1>// Execute these SQL statements into the nested transaction</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 102&#39;</span><span class=p>);</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 103&#39;</span><span class=p>);</span>
<a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a>
<a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a>        <span class=c1>// Create a save point</span>
<a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a>        <span class=c1>// An error has occurred, release the nested transaction</span>
<a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a>        <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>();</span>
<a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a>    <span class=p>}</span>
<a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a>
<a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a>    <span class=c1>// Continue, executing more SQL statements</span>
<a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>execute</span><span class=p>(</span><span class=s1>&#39;DELETE `robots` WHERE `id` = 104&#39;</span><span class=p>);</span>
<a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a>
<a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a>    <span class=c1>// Commit if everything goes well</span>
<a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>commit</span><span class=p>();</span>
<a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a>    <span class=c1>// An exception has occurred rollback the transaction</span>
<a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a>    <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>rollback</span><span class=p>();</span>
<a id=__codelineno-32-33 name=__codelineno-32-33 href=#__codelineno-32-33></a><span class=p>}</span>
</code></pre></div> <h2 id=database-events>Database Events<a class=headerlink href=#database-events title="Permanent link">&para;</a></h2> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> is able to send events to a <a href=../events/ >EventsManager</a> if it's present. Some events when returning boolean false could stop the active operation. The following events are supported:</p> <table> <thead> <tr> <th>Event Name</th> <th>Triggered</th> <th style="text-align: center;">Can stop operation?</th> </tr> </thead> <tbody> <tr> <td><code>afterConnect</code></td> <td>After a successfully connection to a database system</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>beforeQuery</code></td> <td>Before send a SQL statement to the database system</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>afterQuery</code></td> <td>After send a SQL statement to database system</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>beforeDisconnect</code></td> <td>Before close a temporal database connection</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>beginTransaction</code></td> <td>Before a transaction is going to be started</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>rollbackTransaction</code></td> <td>Before a transaction is rollbacked</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>commitTransaction</code></td> <td>Before a transaction is committed</td> <td style="text-align: center;">No</td> </tr> </tbody> </table> <p>Bind an EventsManager to a connection is simple, <a href=../api/Phalcon_Db/ >Phalcon\Db</a> will trigger the events with the type <code>db</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Mysql</span> <span class=k>as</span> <span class=nx>Connection</span><span class=p>;</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=c1>// Listen all the database events</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span><span class=s1>&#39;db&#39;</span><span class=p>,</span> <span class=nv>$dbListener</span><span class=p>);</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=nv>$connection</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Connection</span><span class=p>(</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>    <span class=p>[</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>        <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>        <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;root&#39;</span><span class=p>,</span>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>        <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;invo&#39;</span><span class=p>,</span>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>    <span class=p>]</span>
<a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=p>);</span>
<a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a>
<a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a><span class=c1>// Assign the eventsManager to the db adapter instance</span>
<a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
</code></pre></div> <p>Stop SQL operations are very useful if for example you want to implement some last-resource SQL injector checker:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>    <span class=s1>&#39;db:beforeQuery&#39;</span><span class=p>,</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>    <span class=k>function</span> <span class=p>(</span><span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> <span class=nv>$connection</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>        <span class=nv>$sql</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>getSQLStatement</span><span class=p>();</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>        <span class=c1>// Check for malicious words in SQL statements</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>        <span class=k>if</span> <span class=p>(</span><span class=nb>preg_match</span><span class=p>(</span><span class=s1>&#39;/DROP|ALTER/i&#39;</span><span class=p>,</span> <span class=nv>$sql</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>            <span class=c1>// DROP/ALTER operations aren&#39;t allowed in the application,</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>            <span class=c1>// this must be a SQL injection!</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>        <span class=p>}</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>
<a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a>        <span class=c1>// It&#39;s OK</span>
<a id=__codelineno-34-18 name=__codelineno-34-18 href=#__codelineno-34-18></a>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
<a id=__codelineno-34-19 name=__codelineno-34-19 href=#__codelineno-34-19></a>    <span class=p>}</span>
<a id=__codelineno-34-20 name=__codelineno-34-20 href=#__codelineno-34-20></a><span class=p>);</span>
</code></pre></div> <h2 id=profiling-sql-statements>Profiling SQL Statements<a class=headerlink href=#profiling-sql-statements title="Permanent link">&para;</a></h2> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> includes a profiling component called <a href=../api/Phalcon_Db/ >Phalcon\Db\Profiler</a>, that is used to analyze the performance of database operations so as to diagnose performance problems and discover bottlenecks.</p> <p>Database profiling is really easy With <a href=../api/Phalcon_Db/ >Phalcon\Db\Profiler</a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=k>use</span> <span class=nx>Phalcon\Db\Profiler</span> <span class=k>as</span> <span class=nx>DbProfiler</span><span class=p>;</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a>
<a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=nv>$profiler</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DbProfiler</span><span class=p>();</span>
<a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a>
<a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=c1>// Listen all the database events</span>
<a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a>    <span class=s1>&#39;db&#39;</span><span class=p>,</span>
<a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a>    <span class=k>function</span> <span class=p>(</span><span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> <span class=nv>$connection</span><span class=p>)</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$profiler</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a>        <span class=k>if</span> <span class=p>(</span><span class=nv>$event</span><span class=o>-&gt;</span><span class=na>getType</span><span class=p>()</span> <span class=o>===</span> <span class=s1>&#39;beforeQuery&#39;</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a>            <span class=nv>$sql</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>getSQLStatement</span><span class=p>();</span>
<a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a>
<a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a>            <span class=c1>// Start a profile with the active connection</span>
<a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a>            <span class=nv>$profiler</span><span class=o>-&gt;</span><span class=na>startProfile</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a>        <span class=p>}</span>
<a id=__codelineno-35-21 name=__codelineno-35-21 href=#__codelineno-35-21></a>
<a id=__codelineno-35-22 name=__codelineno-35-22 href=#__codelineno-35-22></a>        <span class=k>if</span> <span class=p>(</span><span class=nv>$event</span><span class=o>-&gt;</span><span class=na>getType</span><span class=p>()</span> <span class=o>===</span> <span class=s1>&#39;afterQuery&#39;</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-35-23 name=__codelineno-35-23 href=#__codelineno-35-23></a>            <span class=c1>// Stop the active profile</span>
<a id=__codelineno-35-24 name=__codelineno-35-24 href=#__codelineno-35-24></a>            <span class=nv>$profiler</span><span class=o>-&gt;</span><span class=na>stopProfile</span><span class=p>();</span>
<a id=__codelineno-35-25 name=__codelineno-35-25 href=#__codelineno-35-25></a>        <span class=p>}</span>
<a id=__codelineno-35-26 name=__codelineno-35-26 href=#__codelineno-35-26></a>    <span class=p>}</span>
<a id=__codelineno-35-27 name=__codelineno-35-27 href=#__codelineno-35-27></a><span class=p>);</span>
<a id=__codelineno-35-28 name=__codelineno-35-28 href=#__codelineno-35-28></a>
<a id=__codelineno-35-29 name=__codelineno-35-29 href=#__codelineno-35-29></a><span class=c1>// Assign the events manager to the connection</span>
<a id=__codelineno-35-30 name=__codelineno-35-30 href=#__codelineno-35-30></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
<a id=__codelineno-35-31 name=__codelineno-35-31 href=#__codelineno-35-31></a>
<a id=__codelineno-35-32 name=__codelineno-35-32 href=#__codelineno-35-32></a><span class=nv>$sql</span> <span class=o>=</span> <span class=s1>&#39;SELECT buyer_name, quantity, product_name &#39;</span>
<a id=__codelineno-35-33 name=__codelineno-35-33 href=#__codelineno-35-33></a>     <span class=o>.</span> <span class=s1>&#39;FROM buyers &#39;</span>
<a id=__codelineno-35-34 name=__codelineno-35-34 href=#__codelineno-35-34></a>     <span class=o>.</span> <span class=s1>&#39;LEFT JOIN products ON buyers.pid = products.id&#39;</span><span class=p>;</span>
<a id=__codelineno-35-35 name=__codelineno-35-35 href=#__codelineno-35-35></a>
<a id=__codelineno-35-36 name=__codelineno-35-36 href=#__codelineno-35-36></a><span class=c1>// Execute a SQL statement</span>
<a id=__codelineno-35-37 name=__codelineno-35-37 href=#__codelineno-35-37></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$sql</span><span class=p>);</span>
<a id=__codelineno-35-38 name=__codelineno-35-38 href=#__codelineno-35-38></a>
<a id=__codelineno-35-39 name=__codelineno-35-39 href=#__codelineno-35-39></a><span class=c1>// Get the last profile in the profiler</span>
<a id=__codelineno-35-40 name=__codelineno-35-40 href=#__codelineno-35-40></a><span class=nv>$profile</span> <span class=o>=</span> <span class=nv>$profiler</span><span class=o>-&gt;</span><span class=na>getLastProfile</span><span class=p>();</span>
<a id=__codelineno-35-41 name=__codelineno-35-41 href=#__codelineno-35-41></a>
<a id=__codelineno-35-42 name=__codelineno-35-42 href=#__codelineno-35-42></a><span class=k>echo</span> <span class=s1>&#39;SQL Statement: &#39;</span><span class=p>,</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getSQLStatement</span><span class=p>(),</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
<a id=__codelineno-35-43 name=__codelineno-35-43 href=#__codelineno-35-43></a><span class=k>echo</span> <span class=s1>&#39;Start Time: &#39;</span><span class=p>,</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getInitialTime</span><span class=p>(),</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
<a id=__codelineno-35-44 name=__codelineno-35-44 href=#__codelineno-35-44></a><span class=k>echo</span> <span class=s1>&#39;Final Time: &#39;</span><span class=p>,</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getFinalTime</span><span class=p>(),</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
<a id=__codelineno-35-45 name=__codelineno-35-45 href=#__codelineno-35-45></a><span class=k>echo</span> <span class=s1>&#39;Total Elapsed Time: &#39;</span><span class=p>,</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getTotalElapsedSeconds</span><span class=p>(),</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>;</span>
</code></pre></div> <p>You can also create your own profile class based on <a href=../api/Phalcon_Db/ >Phalcon\Db\Profiler</a> to record real time statistics of the statements sent to the database system:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=k>use</span> <span class=nx>Phalcon\Db\Profiler</span> <span class=k>as</span> <span class=nx>Profiler</span><span class=p>;</span>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=k>use</span> <span class=nx>Phalcon\Db\Profiler\Item</span> <span class=k>as</span> <span class=nx>Item</span><span class=p>;</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=k>class</span> <span class=nc>DbProfiler</span> <span class=k>extends</span> <span class=nx>Profiler</span>
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=p>{</span>
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>    <span class=sd>/**</span>
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=sd>     * Executed before the SQL statement will sent to the db server</span>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=sd>     */</span>
<a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeStartProfile</span><span class=p>(</span><span class=nx>Item</span> <span class=nv>$profile</span><span class=p>)</span>
<a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a>    <span class=p>{</span>
<a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a>        <span class=k>echo</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getSQLStatement</span><span class=p>();</span>
<a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a>    <span class=p>}</span>
<a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a>
<a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a>    <span class=sd>/**</span>
<a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a><span class=sd>     * Executed after the SQL statement was sent to the db server</span>
<a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a><span class=sd>     */</span>
<a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>afterEndProfile</span><span class=p>(</span><span class=nx>Item</span> <span class=nv>$profile</span><span class=p>)</span>
<a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a>    <span class=p>{</span>
<a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a>        <span class=k>echo</span> <span class=nv>$profile</span><span class=o>-&gt;</span><span class=na>getTotalElapsedSeconds</span><span class=p>();</span>
<a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a>    <span class=p>}</span>
<a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a><span class=p>}</span>
<a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a>
<a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a><span class=c1>// Create an Events Manager</span>
<a id=__codelineno-36-27 name=__codelineno-36-27 href=#__codelineno-36-27></a><span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-36-28 name=__codelineno-36-28 href=#__codelineno-36-28></a>
<a id=__codelineno-36-29 name=__codelineno-36-29 href=#__codelineno-36-29></a><span class=c1>// Create a listener</span>
<a id=__codelineno-36-30 name=__codelineno-36-30 href=#__codelineno-36-30></a><span class=nv>$dbProfiler</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DbProfiler</span><span class=p>();</span>
<a id=__codelineno-36-31 name=__codelineno-36-31 href=#__codelineno-36-31></a>
<a id=__codelineno-36-32 name=__codelineno-36-32 href=#__codelineno-36-32></a><span class=c1>// Attach the listener listening for all database events</span>
<a id=__codelineno-36-33 name=__codelineno-36-33 href=#__codelineno-36-33></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span><span class=s1>&#39;db&#39;</span><span class=p>,</span> <span class=nv>$dbProfiler</span><span class=p>);</span>
</code></pre></div> <h2 id=logging-sql-statements>Logging SQL Statements<a class=headerlink href=#logging-sql-statements title="Permanent link">&para;</a></h2> <p>Using high-level abstraction components such as <a href=../api/Phalcon_Db/ >Phalcon\Db</a> to access a database, it is difficult to understand which statements are sent to the database system. <a href=../api/Phalcon_Logger/ >Phalcon\Logger</a> interacts with <a href=../api/Phalcon_Db/ >Phalcon\Db</a>, providing logging capabilities on the database abstraction layer.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=k>use</span> <span class=nx>Phalcon\Logger</span><span class=p>;</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=k>use</span> <span class=nx>Phalcon\Logger\Adapter\File</span> <span class=k>as</span> <span class=nx>FileLogger</span><span class=p>;</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=nv>$logger</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FileLogger</span><span class=p>(</span><span class=s1>&#39;app/logs/db.log&#39;</span><span class=p>);</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>    <span class=s1>&#39;db:beforeQuery&#39;</span><span class=p>,</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>    <span class=k>function</span> <span class=p>(</span><span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> <span class=nv>$connection</span><span class=p>)</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$logger</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>        <span class=nv>$sql</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>getSQLStatement</span><span class=p>();</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>        <span class=nv>$logger</span><span class=o>-&gt;</span><span class=na>log</span><span class=p>(</span><span class=nv>$sql</span><span class=p>,</span> <span class=nx>Logger</span><span class=o>::</span><span class=na>INFO</span><span class=p>);</span>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>    <span class=p>}</span>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=p>);</span>
<a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>
<a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a><span class=c1>// Assign the eventsManager to the db adapter instance</span>
<a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
<a id=__codelineno-37-23 name=__codelineno-37-23 href=#__codelineno-37-23></a>
<a id=__codelineno-37-24 name=__codelineno-37-24 href=#__codelineno-37-24></a><span class=c1>// Execute some SQL statement</span>
<a id=__codelineno-37-25 name=__codelineno-37-25 href=#__codelineno-37-25></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>insert</span><span class=p>(</span>
<a id=__codelineno-37-26 name=__codelineno-37-26 href=#__codelineno-37-26></a>    <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-37-27 name=__codelineno-37-27 href=#__codelineno-37-27></a>    <span class=p>[</span>
<a id=__codelineno-37-28 name=__codelineno-37-28 href=#__codelineno-37-28></a>        <span class=s1>&#39;Hot pepper&#39;</span><span class=p>,</span>
<a id=__codelineno-37-29 name=__codelineno-37-29 href=#__codelineno-37-29></a>        <span class=mf>3.50</span><span class=p>,</span>
<a id=__codelineno-37-30 name=__codelineno-37-30 href=#__codelineno-37-30></a>    <span class=p>],</span>
<a id=__codelineno-37-31 name=__codelineno-37-31 href=#__codelineno-37-31></a>    <span class=p>[</span>
<a id=__codelineno-37-32 name=__codelineno-37-32 href=#__codelineno-37-32></a>        <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-37-33 name=__codelineno-37-33 href=#__codelineno-37-33></a>        <span class=s1>&#39;price&#39;</span><span class=p>,</span>
<a id=__codelineno-37-34 name=__codelineno-37-34 href=#__codelineno-37-34></a>    <span class=p>]</span>
<a id=__codelineno-37-35 name=__codelineno-37-35 href=#__codelineno-37-35></a><span class=p>);</span>
</code></pre></div> <p>As above, the file <code>app/logs/db.log</code> will contain something like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=o>[</span>Sun,<span class=w> </span><span class=m>29</span><span class=w> </span>Apr<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>22</span>:35:26<span class=w> </span>-0500<span class=o>][</span>DEBUG<span class=o>][</span>Resource<span class=w> </span>Id<span class=w> </span><span class=c1>#77] INSERT INTO products</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=o>(</span>name,<span class=w> </span>price<span class=o>)</span><span class=w> </span>VALUES<span class=w> </span><span class=o>(</span><span class=s1>&#39;Hot pepper&#39;</span>,<span class=w> </span><span class=m>3</span>.50<span class=o>)</span>
</code></pre></div> <h2 id=implementing-your-own-logger>Implementing your own Logger<a class=headerlink href=#implementing-your-own-logger title="Permanent link">&para;</a></h2> <p>You can implement your own logger class for database queries, by creating a class that implements a single method called <code>log</code>. The method needs to accept a string as the first argument. You can then pass your logging object to <code>Phalcon\Db::setLogger()</code>, and from then on any SQL statement executed will call that method to log the results.</p> <h2 id=describing-tablesviews>Describing Tables/Views<a class=headerlink href=#describing-tablesviews title="Permanent link">&para;</a></h2> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> also provides methods to retrieve detailed information about tables and views:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=c1>// Get tables on the test_db database</span>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=nv>$tables</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>listTables</span><span class=p>(</span><span class=s1>&#39;test_db&#39;</span><span class=p>);</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=c1>// Is there a table &#39;robots&#39; in the database?</span>
<a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=nv>$exists</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>tableExists</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
<a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a>
<a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=c1>// Get name, data types and special features of &#39;robots&#39; fields</span>
<a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a><span class=nv>$fields</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>describeColumns</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
<a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$fields</span> <span class=k>as</span> <span class=nv>$field</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a>    <span class=k>echo</span> <span class=s1>&#39;Column Type: &#39;</span><span class=p>,</span> <span class=nv>$field</span><span class=p>[</span><span class=s1>&#39;Type&#39;</span><span class=p>];</span>
<a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a><span class=p>}</span>
<a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a>
<a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a><span class=c1>// Get indexes on the &#39;robots&#39; table</span>
<a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a><span class=nv>$indexes</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>describeIndexes</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
<a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$indexes</span> <span class=k>as</span> <span class=nv>$index</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a>    <span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a>        <span class=nv>$index</span><span class=o>-&gt;</span><span class=na>getColumns</span><span class=p>()</span>
<a id=__codelineno-39-20 name=__codelineno-39-20 href=#__codelineno-39-20></a>    <span class=p>);</span>
<a id=__codelineno-39-21 name=__codelineno-39-21 href=#__codelineno-39-21></a><span class=p>}</span>
<a id=__codelineno-39-22 name=__codelineno-39-22 href=#__codelineno-39-22></a>
<a id=__codelineno-39-23 name=__codelineno-39-23 href=#__codelineno-39-23></a><span class=c1>// Get foreign keys on the &#39;robots&#39; table</span>
<a id=__codelineno-39-24 name=__codelineno-39-24 href=#__codelineno-39-24></a><span class=nv>$references</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>describeReferences</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
<a id=__codelineno-39-25 name=__codelineno-39-25 href=#__codelineno-39-25></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$references</span> <span class=k>as</span> <span class=nv>$reference</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-39-26 name=__codelineno-39-26 href=#__codelineno-39-26></a>    <span class=c1>// Print referenced columns</span>
<a id=__codelineno-39-27 name=__codelineno-39-27 href=#__codelineno-39-27></a>    <span class=nb>print_r</span><span class=p>(</span>
<a id=__codelineno-39-28 name=__codelineno-39-28 href=#__codelineno-39-28></a>        <span class=nv>$reference</span><span class=o>-&gt;</span><span class=na>getReferencedColumns</span><span class=p>()</span>
<a id=__codelineno-39-29 name=__codelineno-39-29 href=#__codelineno-39-29></a>    <span class=p>);</span>
<a id=__codelineno-39-30 name=__codelineno-39-30 href=#__codelineno-39-30></a><span class=p>}</span>
</code></pre></div> <p>A table description is very similar to the MySQL <code>DESCRIBE</code> command, it contains the following information:</p> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Key</th> <th>Null</th> </tr> </thead> <tbody> <tr> <td>Field's name</td> <td>Column Type</td> <td>Is the column part of the primary key or an index?</td> <td>Does the column allow null values?</td> </tr> </tbody> </table> <p>Methods to get information about views are also implemented for every supported database system:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=c1>// Get views on the test_db database</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=nv>$tables</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>listViews</span><span class=p>(</span><span class=s1>&#39;test_db&#39;</span><span class=p>);</span>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=c1>// Is there a view &#39;robots&#39; in the database?</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=nv>$exists</span> <span class=o>=</span> <span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>viewExists</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
</code></pre></div> <h2 id=creatingalteringdropping-tables>Creating/Altering/Dropping Tables<a class=headerlink href=#creatingalteringdropping-tables title="Permanent link">&para;</a></h2> <p>Different database systems (MySQL, Postgresql etc.) offer the ability to create, alter or drop tables with the use of commands such as <code>CREATE</code>, <code>ALTER</code> or <code>DROP</code>. The SQL syntax differs based on which database system is used. <code>Phalcon\Db</code> offers a unified interface to alter tables, without the need to differentiate the SQL syntax based on the target storage system.</p> <h3 id=creating-tables>Creating Tables<a class=headerlink href=#creating-tables title="Permanent link">&para;</a></h3> <p>The following example shows how to create a table:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=k>use</span> <span class=nx>\Phalcon\Db\Column</span> <span class=k>as</span> <span class=nx>Column</span><span class=p>;</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>createTable</span><span class=p>(</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a>    <span class=p>[</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>       <span class=s1>&#39;columns&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>            <span class=k>new</span> <span class=nx>Column</span><span class=p>(</span>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a>                <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a>                <span class=p>[</span>
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a>                    <span class=s1>&#39;type&#39;</span>          <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>TYPE_INTEGER</span><span class=p>,</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a>                    <span class=s1>&#39;size&#39;</span>          <span class=o>=&gt;</span> <span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a>                    <span class=s1>&#39;notNull&#39;</span>       <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a>                    <span class=s1>&#39;autoIncrement&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-41-17 name=__codelineno-41-17 href=#__codelineno-41-17></a>                    <span class=s1>&#39;primary&#39;</span>       <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-41-18 name=__codelineno-41-18 href=#__codelineno-41-18></a>                <span class=p>]</span>
<a id=__codelineno-41-19 name=__codelineno-41-19 href=#__codelineno-41-19></a>            <span class=p>),</span>
<a id=__codelineno-41-20 name=__codelineno-41-20 href=#__codelineno-41-20></a>            <span class=k>new</span> <span class=nx>Column</span><span class=p>(</span>
<a id=__codelineno-41-21 name=__codelineno-41-21 href=#__codelineno-41-21></a>                <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-41-22 name=__codelineno-41-22 href=#__codelineno-41-22></a>                <span class=p>[</span>
<a id=__codelineno-41-23 name=__codelineno-41-23 href=#__codelineno-41-23></a>                    <span class=s1>&#39;type&#39;</span>    <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>TYPE_VARCHAR</span><span class=p>,</span>
<a id=__codelineno-41-24 name=__codelineno-41-24 href=#__codelineno-41-24></a>                    <span class=s1>&#39;size&#39;</span>    <span class=o>=&gt;</span> <span class=mi>70</span><span class=p>,</span>
<a id=__codelineno-41-25 name=__codelineno-41-25 href=#__codelineno-41-25></a>                    <span class=s1>&#39;notNull&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-41-26 name=__codelineno-41-26 href=#__codelineno-41-26></a>                <span class=p>]</span>
<a id=__codelineno-41-27 name=__codelineno-41-27 href=#__codelineno-41-27></a>            <span class=p>),</span>
<a id=__codelineno-41-28 name=__codelineno-41-28 href=#__codelineno-41-28></a>            <span class=k>new</span> <span class=nx>Column</span><span class=p>(</span>
<a id=__codelineno-41-29 name=__codelineno-41-29 href=#__codelineno-41-29></a>                <span class=s1>&#39;year&#39;</span><span class=p>,</span>
<a id=__codelineno-41-30 name=__codelineno-41-30 href=#__codelineno-41-30></a>                <span class=p>[</span>
<a id=__codelineno-41-31 name=__codelineno-41-31 href=#__codelineno-41-31></a>                    <span class=s1>&#39;type&#39;</span>    <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>TYPE_INTEGER</span><span class=p>,</span>
<a id=__codelineno-41-32 name=__codelineno-41-32 href=#__codelineno-41-32></a>                    <span class=s1>&#39;size&#39;</span>    <span class=o>=&gt;</span> <span class=mi>11</span><span class=p>,</span>
<a id=__codelineno-41-33 name=__codelineno-41-33 href=#__codelineno-41-33></a>                    <span class=s1>&#39;notNull&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-41-34 name=__codelineno-41-34 href=#__codelineno-41-34></a>                <span class=p>]</span>
<a id=__codelineno-41-35 name=__codelineno-41-35 href=#__codelineno-41-35></a>            <span class=p>),</span>
<a id=__codelineno-41-36 name=__codelineno-41-36 href=#__codelineno-41-36></a>        <span class=p>]</span>
<a id=__codelineno-41-37 name=__codelineno-41-37 href=#__codelineno-41-37></a>    <span class=p>]</span>
<a id=__codelineno-41-38 name=__codelineno-41-38 href=#__codelineno-41-38></a><span class=p>);</span>
</code></pre></div> <p><code>Phalcon\Db::createTable()</code> accepts an associative array describing the table. Columns are defined with the class <a href=../api/Phalcon_Db/ >Phalcon\Db\Column</a>. The table below shows the options available to define a column:</p> <table> <thead> <tr> <th>Option</th> <th>Description</th> <th style="text-align: center;">Optional</th> </tr> </thead> <tbody> <tr> <td><code>type</code></td> <td>Column type. Must be a <a href=../api/Phalcon_Db/ >Phalcon\Db\Column</a> constant (see below for a list)</td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>primary</code></td> <td>True if the column is part of the table's primary key</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>size</code></td> <td>Some type of columns like <code>VARCHAR</code> or <code>INTEGER</code> may have a specific size</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>scale</code></td> <td><code>DECIMAL</code> or <code>NUMBER</code> columns may be have a scale to specify how many decimals should be stored</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>unsigned</code></td> <td><code>INTEGER</code> columns may be signed or unsigned. This option does not apply to other types of columns</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>notNull</code></td> <td>Column can store null values?</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>default</code></td> <td>Default value (when used with <code>'notNull' =&gt; true</code>).</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>autoIncrement</code></td> <td>With this attribute column will filled automatically with an auto-increment integer. Only one column in the table can have this attribute.</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>bind</code></td> <td>One of the <code>BIND_TYPE_*</code> constants telling how the column must be bound before save it</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>first</code></td> <td>Column must be placed at first position in the column order</td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>after</code></td> <td>Column must be placed after indicated column</td> <td style="text-align: center;">Yes</td> </tr> </tbody> </table> <p><a href=../api/Phalcon_Db/ >Phalcon\Db</a> supports the following database column types:</p> <ul> <li><code>Phalcon\Db\Column::TYPE_INTEGER</code></li> <li><code>Phalcon\Db\Column::TYPE_DATE</code></li> <li><code>Phalcon\Db\Column::TYPE_VARCHAR</code></li> <li><code>Phalcon\Db\Column::TYPE_DECIMAL</code></li> <li><code>Phalcon\Db\Column::TYPE_DATETIME</code></li> <li><code>Phalcon\Db\Column::TYPE_CHAR</code></li> <li><code>Phalcon\Db\Column::TYPE_TEXT</code></li> </ul> <p>The associative array passed in <code>Phalcon\Db::createTable()</code> can have the possible keys:</p> <table> <thead> <tr> <th>Index</th> <th>Description</th> <th style="text-align: center;">Optional</th> </tr> </thead> <tbody> <tr> <td><code>columns</code></td> <td>An array with a set of table columns defined with <a href=../api/Phalcon_Db/ >Phalcon\Db\Column</a></td> <td style="text-align: center;">No</td> </tr> <tr> <td><code>indexes</code></td> <td>An array with a set of table indexes defined with <a href=../api/Phalcon_Db/ >Phalcon\Db\Index</a></td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>references</code></td> <td>An array with a set of table references (foreign keys) defined with <a href=../api/Phalcon_Db/ >Phalcon\Db\Reference</a></td> <td style="text-align: center;">Yes</td> </tr> <tr> <td><code>options</code></td> <td>An array with a set of table creation options. These options often relate to the database system in which the migration was generated.</td> <td style="text-align: center;">Yes</td> </tr> </tbody> </table> <h3 id=altering-tables>Altering Tables<a class=headerlink href=#altering-tables title="Permanent link">&para;</a></h3> <p>As your application grows, you might need to alter your database, as part of a refactoring or adding new features. Not all database systems allow to modify existing columns or add columns between two existing ones. <a href=../api/Phalcon_Db/ >Phalcon\Db</a> is limited by these constraints.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=k>use</span> <span class=nx>Phalcon\Db\Column</span> <span class=k>as</span> <span class=nx>Column</span><span class=p>;</span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=c1>// Adding a new column</span>
<a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>addColumn</span><span class=p>(</span>
<a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a>    <span class=k>new</span> <span class=nx>Column</span><span class=p>(</span>
<a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a>        <span class=s1>&#39;robot_type&#39;</span><span class=p>,</span>
<a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a>        <span class=p>[</span>
<a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a>            <span class=s1>&#39;type&#39;</span>    <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>TYPE_VARCHAR</span><span class=p>,</span>
<a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a>            <span class=s1>&#39;size&#39;</span>    <span class=o>=&gt;</span> <span class=mi>32</span><span class=p>,</span>
<a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a>            <span class=s1>&#39;notNull&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-42-15 name=__codelineno-42-15 href=#__codelineno-42-15></a>            <span class=s1>&#39;after&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-42-16 name=__codelineno-42-16 href=#__codelineno-42-16></a>        <span class=p>]</span>
<a id=__codelineno-42-17 name=__codelineno-42-17 href=#__codelineno-42-17></a>    <span class=p>)</span>
<a id=__codelineno-42-18 name=__codelineno-42-18 href=#__codelineno-42-18></a><span class=p>);</span>
<a id=__codelineno-42-19 name=__codelineno-42-19 href=#__codelineno-42-19></a>
<a id=__codelineno-42-20 name=__codelineno-42-20 href=#__codelineno-42-20></a><span class=c1>// Modifying an existing column</span>
<a id=__codelineno-42-21 name=__codelineno-42-21 href=#__codelineno-42-21></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>modifyColumn</span><span class=p>(</span>
<a id=__codelineno-42-22 name=__codelineno-42-22 href=#__codelineno-42-22></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-42-23 name=__codelineno-42-23 href=#__codelineno-42-23></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-42-24 name=__codelineno-42-24 href=#__codelineno-42-24></a>    <span class=k>new</span> <span class=nx>Column</span><span class=p>(</span>
<a id=__codelineno-42-25 name=__codelineno-42-25 href=#__codelineno-42-25></a>        <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-42-26 name=__codelineno-42-26 href=#__codelineno-42-26></a>        <span class=p>[</span>
<a id=__codelineno-42-27 name=__codelineno-42-27 href=#__codelineno-42-27></a>            <span class=s1>&#39;type&#39;</span>    <span class=o>=&gt;</span> <span class=nx>Column</span><span class=o>::</span><span class=na>TYPE_VARCHAR</span><span class=p>,</span>
<a id=__codelineno-42-28 name=__codelineno-42-28 href=#__codelineno-42-28></a>            <span class=s1>&#39;size&#39;</span>    <span class=o>=&gt;</span> <span class=mi>40</span><span class=p>,</span>
<a id=__codelineno-42-29 name=__codelineno-42-29 href=#__codelineno-42-29></a>            <span class=s1>&#39;notNull&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-42-30 name=__codelineno-42-30 href=#__codelineno-42-30></a>        <span class=p>]</span>
<a id=__codelineno-42-31 name=__codelineno-42-31 href=#__codelineno-42-31></a>    <span class=p>)</span>
<a id=__codelineno-42-32 name=__codelineno-42-32 href=#__codelineno-42-32></a><span class=p>);</span>
<a id=__codelineno-42-33 name=__codelineno-42-33 href=#__codelineno-42-33></a>
<a id=__codelineno-42-34 name=__codelineno-42-34 href=#__codelineno-42-34></a><span class=c1>// Deleting the column &#39;name&#39;</span>
<a id=__codelineno-42-35 name=__codelineno-42-35 href=#__codelineno-42-35></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>dropColumn</span><span class=p>(</span>
<a id=__codelineno-42-36 name=__codelineno-42-36 href=#__codelineno-42-36></a>    <span class=s1>&#39;robots&#39;</span><span class=p>,</span>
<a id=__codelineno-42-37 name=__codelineno-42-37 href=#__codelineno-42-37></a>    <span class=k>null</span><span class=p>,</span>
<a id=__codelineno-42-38 name=__codelineno-42-38 href=#__codelineno-42-38></a>    <span class=s1>&#39;name&#39;</span>
<a id=__codelineno-42-39 name=__codelineno-42-39 href=#__codelineno-42-39></a><span class=p>);</span>
</code></pre></div> <h3 id=dropping-tables>Dropping Tables<a class=headerlink href=#dropping-tables title="Permanent link">&para;</a></h3> <p>To drop an existing table from the current database, use the <code>dropTable</code> method. To drop an table from custom database, use second parameter describes database name. Examples on dropping tables:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=c1>// Drop table &#39;robots&#39; from active database</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>dropTable</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>);</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=c1>// Drop table &#39;robots&#39; from database &#39;machines&#39;</span>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=nv>$connection</span><span class=o>-&gt;</span><span class=na>dropTable</span><span class=p>(</span><span class=s1>&#39;robots&#39;</span><span class=p>,</span> <span class=s1>&#39;machines&#39;</span><span class=p>);</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../api/ class="md-footer__link md-footer__link--prev" aria-label="Previous: API Index"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> API Index </div> </div> </a> <a href=../db-phql/ class="md-footer__link md-footer__link--next" aria-label="Next: PHQL"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> PHQL </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2012 - present Phalcon Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://phalcon.io/discord target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://phalcon.io/discussions target=_blank rel=noopener title="GitHub Discussions" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29H9Z"/></svg> </a> <a href=https://phalcon.io/github target=_blank rel=noopener title="GitHub Project" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://phalcon.io/telegram target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg> </a> <a href=https://phalcon.io/gab target=_blank rel=noopener title=Gab class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M368 32c41.7 0 75.9 31.8 79.7 72.5l85.6 26.3c25.4 7.8 42.8 31.3 42.8 57.9 0 21.8-11.7 41.9-30.7 52.7l-144.6 82.1 92.5 92.5H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c-8.5 0-16.6-3.4-22.6-9.4L346.9 360.2c11.7-36 3.2-77.1-25.4-105.7-40.6-40.6-106.3-40.6-146.9-.1l-73.6 70c-6.4 6.1-6.7 16.2-.6 22.6s16.2 6.6 22.6.6l73.8-70.2.1-.1.1-.1c3.5-3.5 7.3-6.6 11.3-9.2 27.9-18.5 65.9-15.4 90.5 9.2 24.7 24.7 27.7 62.9 9 90.9-2.6 3.8-5.6 7.5-9 10.9l-37 37H352c17.7 0 32 14.3 32 32s-14.3 32-32 32H64c-35.3 0-64-28.7-64-64C0 249.6 127 112.9 289.3 97.5 296.2 60.2 328.8 32 368 32zm0 104a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"/></svg> </a> <a href=https://phalcon.io/t target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href=https://phalcon.io/fb target=_blank rel=noopener title=Facebook class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg> </a> <a href=https://phalcon.io/linkedin target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://phalcon.io/youtube target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "5.4.0", "provider": "mike"}}</script> <script src=../assets/javascripts/bundle.1e8ae164.min.js></script> </body> </html>